(()=>{"use strict";var t={11:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-level-progress-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-level-progress-bar {\n  background-color: #e0e0e0;\n  border-radius: 10px;\n  width: 100%;\n  height: 20px;\n  position: relative;\n  overflow: hidden;\n}\n\n.ptnpnh-level-progress-fill {\n  background-color: #c8e3ef;\n  height: 100%;\n  transition: width 0.3s;\n}\n\n.ptnpnh-level-progress-text {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #000;\n  font-size: 12px;\n}",""]);const r=o},16:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-feature-row {\n  width: 100%;\n  min-height: 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 5px 0;\n  border-bottom: 1px solid #eee;\n}\n\n.ptnpnh-feature-title {\n  font-weight: bold;\n}\n\n.ptnpnh-toggle-container {\n  position: relative;\n  display: inline-block;\n}\n\n.ptnpnh-toggle-input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n  position: absolute;\n}\n\n.ptnpnh-toggle-label {\n  position: relative;\n  display: inline-block;\n  width: 40px;\n  height: 20px;\n  background-color: #ccc;\n  border-radius: 20px;\n  transition: background-color 0.3s;\n  cursor: pointer;\n}\n\n.ptnpnh-toggle-label-active {\n  background-color: #4896C6;\n}\n\n.ptnpnh-toggle-slider {\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 16px;\n  height: 16px;\n  background-color: white;\n  border-radius: 50%;\n  transition: left 0.3s;\n}\n\n.ptnpnh-toggle-slider-active {\n  left: 22px;\n}\n\n/* Expandable row styles */\n.ptnpnh-feature-row-expandable {\n  cursor: pointer;\n  position: relative;\n}\n\n.ptnpnh-feature-row-expandable:hover {\n  background-color: #f9f9f9;\n}\n\n.ptnpnh-feature-row-expanded {\n  border-bottom: none;\n}\n\n/* Configuration section styles */\n.ptnpnh-config-section {\n  width: 100%;\n  padding: 0 5px;\n  background-color: #f5f5f5;\n  border-bottom: 1px solid #eee;\n  box-sizing: border-box;\n  display: none;\n}\n\n.ptnpnh-config-container {\n  margin: 5px 0;\n  width: 100%;\n}\n\n/* Horizontal layout (label to the left of input) */\n.ptnpnh-config-container-horizontal {\n  display: flex;\n  align-items: center;\n}\n\n.ptnpnh-config-container-horizontal .ptnpnh-config-label {\n  margin-right: 10px;\n}\n\n/* Vertical layout (label above input/textarea) */\n.ptnpnh-config-container-vertical {\n  display: flex;\n  flex-direction: column;\n}\n\n.ptnpnh-config-container-vertical .ptnpnh-config-label {\n  margin-bottom: 5px;\n}\n\n.ptnpnh-config-label {\n  font-size: 14px;\n}\n\n.ptnpnh-config-input {\n  padding: 5px;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  width: 80px;\n}\n",""]);const r=o},35:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-placeholder {\n  color: #666;\n}\n\n.ptnpnh-rows-container {\n  width: 100%;\n}",""]);const r=o},54:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-hidden-post {\n  display: none !important;\n}\n\n.ptnpnh-config-textarea {\n  padding: 5px;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  background-color: #fff;\n  color: #333;\n  font-family: inherit;\n  resize: vertical;\n}\n\n.ptnpnh-config-textarea:focus {\n  border-color: #c8e3ef;\n  outline: none;\n  box-shadow: 0 0 3px rgba(200, 227, 239, 0.5);\n}\n",""]);const r=o},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},o=[],r=0;r<t.length;r++){var l=t[r],d=i.base?l[0]+i.base:l[0],c=s[d]||0,h="".concat(d," ").concat(c);s[d]=c+1;var p=n(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var g=a(u,i);i.byIndex=r,e.splice(r,0,{identifier:h,updater:g,references:1})}o.push(h)}return o}function a(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var s=i(t=t||[],a=a||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var r=n(s[o]);e[r].references--}for(var l=i(t,a),d=0;d<s.length;d++){var c=n(s[d]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},98:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-active-battles-dialog {\n  position: fixed;\n  min-width: 200px;\n  background-color: #fff;\n  border: 1px solid #c8e3ef;\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  z-index: 1000;\n  top: 100px;\n  left: 100px;\n  user-select: none;\n}\n\n.ptnpnh-active-battles-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.ptnpnh-active-battles-header {\n  background-color: #c8e3ef;\n  padding: 4px 5px;\n  font-weight: bold;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  cursor: move;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.ptnpnh-active-battles-refresh {\n  display: inline-block;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.ptnpnh-active-battles-body {\n  padding: 5px;\n  flex-grow: 1;\n  min-height: 60px;\n  overflow-y: auto;\n  cursor: default;\n  max-height: 600px;\n}\n\n.ptnpnh-active-battles-body a {\n  display: block;\n  text-decoration: none;\n  cursor: pointer;\n  color: #000;\n  margin: 5px;\n  text-align: center;\n}\n\n.ptnpnh-active-battles-body a:hover {\n  background-color: #f0f0f0;\n  border-radius: 3px;\n  font-weight: bold;\n}\n\n.ptnpnh-active-battles-last-update {\n  font-size: 12px;\n  color: #555;\n  margin-left: 5px;\n  font-weight: normal;\n}\n",""]);const r=o},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},208:(t,e,n)=>{n.d(e,{A:()=>f});var i=n(601),a=n.n(i),s=n(314),o=n.n(s),r=n(353),l=n(16),d=n(934),c=n(594),h=n(998),p=n(35),u=n(562),g=o()(a());g.i(r.A),g.i(l.A),g.i(d.A),g.i(c.A),g.i(h.A),g.i(p.A),g.i(u.A),g.push([t.id,"/* Import all CSS files */\n",""]);const f=g},230:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-profile-switcher-arrows {\n  display: inline-block;\n  margin-left: 10px;\n  vertical-align: middle;\n}\n\n.ptnpnh-profile-switcher-arrow {\n  display: inline-block;\n  cursor: pointer;\n  color: #c8e3ef;\n  margin: 0 5px;\n  transition: color 0.2s ease;\n}\n\n.ptnpnh-profile-switcher-arrow:hover {\n  color: #ffffff;\n}\n\n.ptnpnh-profile-switcher-left {\n  margin-right: 2px;\n}\n\n.ptnpnh-profile-switcher-right {\n  margin-left: 2px;\n}",""]);const r=o},247:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-daily-tasks-container {\n  background-color: #fff;\n  border: 1px solid #c8e3ef;\n  border-radius: 10px;\n  overflow: hidden;\n}\n\n.ptnpnh-daily-tasks-header {\n  background-color: #c8e3ef;\n  color: #333;\n  font-weight: bold;\n  padding: 4px 10px;\n  text-align: center;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.ptnpnh-daily-tasks-toggle-icon {\n  font-size: 12px;\n  margin-left: 5px;\n  transition: transform 0.3s ease;\n}\n\n.ptnpnh-daily-tasks-container.collapsed .ptnpnh-daily-tasks-toggle-icon {\n  transform: rotate(-90deg);\n}\n\n.ptnpnh-daily-tasks-content {\n  padding: 10px;\n  max-height: 500px;\n  overflow: hidden;\n  transition: max-height 0.3s ease-out;\n}\n\n.ptnpnh-daily-tasks-container.collapsed .ptnpnh-daily-tasks-content {\n  max-height: 0;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n\n.ptnpnh-daily-tasks-status {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  margin-bottom: 10px;\n}\n\n.ptnpnh-daily-tasks-item {\n  display: flex;\n  align-items: center;\n  padding: 0;\n  border-radius: 3px;\n  background-color: #f5f5f5;\n}\n\n.ptnpnh-daily-tasks-icon {\n  margin-right: 8px;\n  font-size: 14px;\n}\n\n.ptnpnh-daily-tasks-label {\n  flex-grow: 1;\n  font-size: 12px;\n}\n\n.ptnpnh-daily-tasks-status-icon {\n  margin-left: 5px;\n  font-size: 14px;\n}\n\n.ptnpnh-daily-tasks-selection {\n  margin-top: 10px;\n  border-top: 1px solid #e5e5e5;\n  padding-top: 10px;\n}\n\n.ptnpnh-daily-tasks-selection-header {\n  font-size: 12px;\n  font-weight: bold;\n  margin-bottom: 5px;\n  color: #333;\n}\n\n.ptnpnh-daily-tasks-selection-items {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 5px;\n}\n\n.ptnpnh-daily-tasks-selection-item {\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n}\n\n.ptnpnh-daily-tasks-checkbox {\n  margin-right: 5px;\n  cursor: pointer;\n}\n\n.ptnpnh-daily-tasks-actions {\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n}\n\n.ptnpnh-daily-tasks-button {\n  background-color: #c8e3ef;\n  border: none;\n  border-radius: 3px;\n  color: #333;\n  cursor: pointer;\n  font-weight: bold;\n  padding: 5px 15px;\n  transition: background-color 0.2s;\n}\n\n.ptnpnh-daily-tasks-button:hover {\n  background-color: #a5d1e5;\n}\n\n.ptnpnh-daily-tasks-success {\n  color: #28a745;\n}\n\n.ptnpnh-daily-tasks-error {\n  color: #dc3545;\n}\n\n.ptnpnh-daily-tasks-pending {\n  color: #ffc107;\n}\n\n/* Notification styles */\n/* Container for all notifications - fixed at bottom right */\n/* Uses column-reverse to display newest notifications at the bottom */\n/* and automatically push older ones upward */\n#ptnpnh-notification-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  display: flex;\n  flex-direction: column-reverse; /* Newest at bottom, oldest at top */\n  gap: 10px; /* Space between notifications */\n  z-index: 9999;\n  max-height: 80vh; /* Limit height to 80% of viewport */\n  overflow-y: auto; /* Add scrollbar if too many notifications */\n  padding-right: 5px;\n}\n\n.ptnpnh-notification {\n  padding: 10px 15px;\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  font-size: 14px;\n  max-width: 300px;\n  animation: ptnpnh-notification-slide-in 0.3s ease-out;\n}\n\n.ptnpnh-notification-success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n.ptnpnh-notification-error {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.ptnpnh-notification-info {\n  background-color: #d1ecf1;\n  color: #0c5460;\n  border: 1px solid #bee5eb;\n}\n\n.ptnpnh-notification-warning {\n  background-color: #fff3cd;\n  color: #856404;\n  border: 1px solid #ffeeba;\n}\n\n@keyframes ptnpnh-notification-slide-in {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n",""]);const r=o},308:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-auto-farmer {\n  position: absolute;\n  bottom: 100px;\n  right: 5px;\n  background-color: rgba(255, 255, 255, 0.95);\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  padding: 4px;\n  z-index: 1000;\n  min-width: 200px;\n}\n\n.ptnpnh-auto-farmer-container {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.ptnpnh-auto-farmer-controls {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.ptnpnh-auto-farmer-weapon-select {\n  flex: 1;\n  padding: 8px 12px;\n  border: 2px solid #c8e3ef;\n  border-radius: 6px;\n  background-color: #fff;\n  font-size: 14px;\n  font-weight: 500;\n  color: #333;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.ptnpnh-auto-farmer-weapon-select:hover {\n  border-color: #a5d1e5;\n}\n\n.ptnpnh-auto-farmer-weapon-select:focus {\n  outline: none;\n  border-color: #4896C6;\n  box-shadow: 0 0 0 3px rgba(72, 150, 198, 0.1);\n}\n\n.ptnpnh-auto-farmer-button {\n  padding: 8px 16px;\n  background-color: #4896C6;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: bold;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n}\n\n.ptnpnh-auto-farmer-button:hover {\n  background-color: #3a7aa0;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(72, 150, 198, 0.3);\n}\n\n.ptnpnh-auto-farmer-button:active {\n  transform: translateY(0);\n}\n\n.ptnpnh-auto-farmer-button:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.ptnpnh-auto-farmer-status {\n  font-size: 12px;\n  color: #666;\n  min-height: 18px;\n  line-height: 18px;\n}\n\n.ptnpnh-auto-farmer-status.success {\n  color: #28a745;\n  font-weight: 500;\n}\n\n.ptnpnh-auto-farmer-status.error {\n  color: #dc3545;\n  font-weight: 500;\n}\n\n.ptnpnh-auto-farmer-status.info {\n  color: #17a2b8;\n}\n",""]);const r=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,a,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(o[l]=!0)}for(var d=0;d<t.length;d++){var c=[].concat(t[d]);i&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),e.push(c))}},e}},353:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#erepa_container {\n  max-height: 350px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  display: block;\n  padding: 5px;\n}\n",""]);const r=o},457:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"/* styles for container max height feature configuration use common classes */\n",""]);const r=o},506:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,":root {\n  --background-color: rgba(255, 255, 255, 40%);\n  --border-radius: 5px;\n  --box-shadow-color: rgba(0, 0, 0, 0.2);\n}\n\n#ptnpnh-travel-distance {\n  position: absolute;\n  min-width: max-content;\n  min-height: max-content;\n  background-color: var(--background-color);\n  -webkit-border-radius: var(--border-radius);\n  -moz-border-radius: var(--border-radius);\n  border-radius: var(--border-radius);\n  -webkit-box-shadow: 0 2px 10px var(--box-shadow-color);\n  -moz-box-shadow: 0 2px 10px var(--box-shadow-color);\n  box-shadow: 0 2px 10px var(--box-shadow-color);\n  z-index: 1000;\n  top: -20px;\n  right: 0;\n  user-select: none;\n}\n\n.ptnpnh-travel-distance-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.ptnpnh-travel-distance-body {\n  padding: 2px;\n  flex-grow: 1;\n  max-height: 100%;\n  overflow-y: auto;\n  cursor: default;\n}\n\n.ptnpnh-travel-distance-content {\n  display: flex;\n  flex-direction: column;\n  gap: 1px;\n}\n\n.ptnpnh-travel-option {\n  padding: 2px 4px;\n  border-radius: 3px;\n  background-color: #fdfcfc;\n  font-size: 11px;\n  cursor: pointer;\n}\n\n.ptnpnh-travel-option:hover {\n  background-color: #c8e3ef;\n}\n",""]);const r=o},517:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-collect-rewards-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-collect-rewards-button {\n  background-color: #c8e3ef;\n  border: none;\n  border-radius: 10px;\n  color: #333;\n  cursor: pointer;\n  font-weight: bold;\n  padding: 4px 15px;\n  transition: background-color 0.2s;\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n}\n\n.ptnpnh-collect-rewards-button:hover {\n  background-color: #a5d1e5;\n}\n\n.ptnpnh-collect-rewards-button:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n",""]);const r=o},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},562:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-about-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 5px 0;\n  border-bottom: 1px solid #ccc;\n}\n\n.ptnpnh-author-info {\n  display: flex;\n  align-items: center;\n}\n\n.ptnpnh-author-info span {\n  margin-right: 15px;\n  font-weight: bold;\n}\n\n.ptnpnh-author-avatar {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n\n.ptnpnh-author-name {\n  font-weight: bold;\n  color: #4896C6;\n  text-decoration: none;\n}\n\n.ptnpnh-author-name:hover {\n  text-decoration: underline;\n}\n\n.ptnpnh-author-buttons {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.ptnpnh-pm-button, .ptnpnh-donate-button {\n  background-color: #4896C6;\n  color: white;\n  border: none;\n  border-radius: 3px;\n  padding: 5px 10px;\n  cursor: pointer;\n  text-decoration: none;\n}\n\n.ptnpnh-pm-button:hover, .ptnpnh-donate-button:hover {\n  background-color: #3a7aa0;\n}\n\n.ptnpnh-telegram-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.ptnpnh-telegram-button svg {\n  width: 24px;\n  height: 24px;\n}\n",""]);const r=o},577:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-ip-location-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-ip-location-info {\n  display: flex;\n  gap: 10px;\n  filter: blur(4px);\n  transition: filter 0.3s ease;\n  min-height: 16px;\n}\n\n.ptnpnh-ip-location-info:hover {\n  filter: blur(0);\n}\n",""]);const r=o},594:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 2001;\n}\n\n.ptnpnh-dialog {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 500px;\n  height: 400px;\n  background-color: #ffffff;\n  border-radius: 10px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  display: flex;\n  flex-direction: column;\n  z-index: 2002;\n  overflow: hidden;\n}\n\n.ptnpnh-dialog-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 5px 16px;\n  height: 40px;\n  box-sizing: border-box;\n  border-bottom: 1px solid #e8e8e8;\n  background-color: #f5f5f5;\n}\n\n.ptnpnh-dialog-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  border-bottom: none;\n  padding-bottom: 0;\n}\n\n.ptnpnh-dialog-close-button {\n  background: none;\n  border: none;\n  font-size: 20px;\n  cursor: pointer;\n  padding: 0;\n  line-height: 1;\n  color: #999;\n  font-weight: bold;\n}\n\n.ptnpnh-dialog-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}",""]);const r=o},601:t=>{t.exports=function(t){return t[1]}},655:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-energy-countdown-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-energy-countdown-container {\n  display: flex;\n  /*align-items: center;*/\n  /*justify-content: center;*/\n}\n\n.ptnpnh-energy-countdown-text {\n  color: #000;\n  font-size: 12px;\n}\n\n.ptnpnh-energy-countdown-time {\n  color: #4a90e2;\n}",""]);const r=o},659:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},688:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,":root {\n  --background-color: rgba(255, 255, 255, 40%);\n  --border-radius: 5px;\n  --box-shadow-color: rgba(0, 0, 0, 0.2);\n}\n\n#ptnpnh-campaign-start-date {\n  position: relative;\n  width: fit-content;\n  margin-bottom: 23px;\n  margin-left: auto;\n  margin-right: auto;\n  background-color: var(--background-color);\n  -webkit-border-radius: var(--border-radius);\n  -moz-border-radius: var(--border-radius);\n  border-radius: var(--border-radius);\n  -webkit-box-shadow: 0 2px 10px var(--box-shadow-color);\n  -moz-box-shadow: 0 2px 10px var(--box-shadow-color);\n  box-shadow: 0 2px 10px var(--box-shadow-color);\n  user-select: none;\n}\n\n.ptnpnh-campaign-start-date-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.ptnpnh-campaign-start-date-body {\n  flex-grow: 1;\n  max-height: 100%;\n  overflow-y: auto;\n  cursor: default;\n}\n\n.ptnpnh-campaign-start-date-content {\n  font-size: 12px;\n  text-align: center;\n  margin: 0;\n  padding: 2px;\n  color: #333;\n}",""]);const r=o},823:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,'#ptnpnh-return-home-btn {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 6px;\n  background-color: #c8e3ef;\n  border-radius: 4px;\n  position: relative;\n  text-decoration: none;\n}\n\n#ptnpnh-return-home-btn::before {\n  content: "";\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 8px;\n  height: 8px;\n  transform: translate(-50%, -50%) rotate(45deg);\n  border-left: 2px solid #2b2b2b;\n  border-bottom: 2px solid #2b2b2b;\n}\n',""]);const r=o},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,a&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},934:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-tabs-container {\n  display: flex;\n  border-bottom: 1px solid #e8e8e8;\n  background-color: #fafafa;\n}\n\n.ptnpnh-tab-content-container {\n  flex: 1;\n  overflow: auto;\n  padding: 10px;\n}\n\n.ptnpnh-tab-button {\n  padding: 8px 16px;\n  cursor: pointer;\n  border-bottom: 2px solid transparent;\n  transition: all 0.3s;\n}\n\n.ptnpnh-tab-button-active {\n  border-bottom: 2px solid #1890ff;\n  background-color: #f0f0f0;\n}\n\n.ptnpnh-tab-content {\n  display: none;\n}\n\n.ptnpnh-tab-content-active {\n  display: block;\n}",""]);const r=o},970:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,"#ptnpnh-division-switcher {\n  position: absolute;\n  width: fit-content;\n  bottom: 0;\n  right: 0;\n  min-height: max-content;\n  background-color: rgba(255, 255, 255, 40%);\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  z-index: 1000;\n  user-select: none;\n}\n\n.ptnpnh-division-switcher-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.ptnpnh-division-switcher-body {\n  padding: 4px;\n  flex-grow: 1;\n  max-height: 100%;\n  overflow: visible;\n  cursor: default;\n}\n\n.ptnpnh-division-switcher-buttons {\n  display: flex;\n  gap: 4px;\n}\n\n.ptnpnh-division-switcher-button {\n  padding: 2px 6px;\n  min-width: 30px;\n  border-radius: 3px;\n  background-color: #fdfcfc;\n  font-size: 15px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  color: #333;\n  cursor: pointer;\n  transition: background-color 0.2s ease;\n}\n\n.ptnpnh-division-switcher-button:hover {\n  background-color: #f3f2f2;\n}\n\n.ptnpnh-division-switcher-button-current {\n  background-color: #888888;\n  color: white;\n}\n",""]);const r=o},986:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-add-friend-btn {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 5px;\n  border-radius: 50%;\n  background-color: #4CAF50;\n  position: relative;\n  cursor: pointer;\n  vertical-align: middle;\n}\n\n.ptnpnh-add-friend-btn:hover {\n  background-color: #45a049;\n  box-shadow: 0 0 3px rgba(76, 175, 80, 0.5);\n}\n\n.ptnpnh-add-friend-btn::before,\n.ptnpnh-add-friend-btn::after {\n  content: '';\n  position: absolute;\n  background-color: white;\n}\n\n.ptnpnh-add-friend-btn::before {\n  width: 8px;\n  height: 2px;\n  top: 7px;\n  left: 4px;\n}\n\n.ptnpnh-add-friend-btn::after {\n  width: 2px;\n  height: 8px;\n  top: 4px;\n  left: 7px;\n}\n\n.ptnpnh-friend-pending-btn {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 5px;\n  border-radius: 50%;\n  background-color: #999;\n  position: relative;\n  vertical-align: middle;\n}\n\n.ptnpnh-friend-pending-btn::before {\n  content: '';\n  position: absolute;\n  width: 6px;\n  height: 6px;\n  border: 2px solid white;\n  border-radius: 50%;\n  top: 3px;\n  left: 3px;\n}\n\n.ptnpnh-friend-pending-btn::after {\n  content: '';\n  position: absolute;\n  width: 1px;\n  height: 4px;\n  background-color: white;\n  top: 5px;\n  right: 5px;\n  transform: rotate(-45deg);\n}\n\n.nameholder {\n  display: flex;\n  align-items: center;\n}\n\n/* Notification styles */\n#ptnpnh-notification-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  display: flex;\n  flex-direction: column-reverse;\n  gap: 10px;\n  z-index: 9999;\n  max-height: 80vh;\n  overflow-y: auto;\n  padding-right: 5px;\n}\n\n.ptnpnh-notification {\n  padding: 10px 15px;\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  font-size: 14px;\n  max-width: 300px;\n  animation: ptnpnh-notification-slide-in 0.3s ease-out;\n}\n\n.ptnpnh-notification-success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n.ptnpnh-notification-error {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.ptnpnh-notification-info {\n  background-color: #d1ecf1;\n  color: #0c5460;\n  border: 1px solid #bee5eb;\n}\n\n.ptnpnh-notification-warning {\n  background-color: #fff3cd;\n  color: #856404;\n  border: 1px solid #ffeeba;\n}\n\n@keyframes ptnpnh-notification-slide-in {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}",""]);const r=o},998:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),a=n.n(i),s=n(314),o=n.n(s)()(a());o.push([t.id,".ptnpnh-settings-button {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  border: none;\n  background-color: #ffffff;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n  cursor: pointer;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0;\n  z-index: 2001;\n}\n\n.ptnpnh-settings-button-grabbing {\n  cursor: grabbing;\n}",""]);const r=o}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var i=n(72),a=n.n(i),s=n(825),o=n.n(s),r=n(659),l=n.n(r),d=n(56),c=n.n(d),h=n(540),p=n.n(h),u=n(113),g=n.n(u),f=n(208),m={};m.styleTagTransform=g(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=p();a()(f.A,m);f.A&&f.A.locals&&f.A.locals;class b{static initialize(t,e){const n=t.configFor(this.STORAGE_KEY);if(n)this.PREFIX=n.prefix,this.debugEnabled=n.debugEnabled;else{this.PREFIX=e,this.debugEnabled=!1;const n={prefix:this.PREFIX,debugEnabled:this.debugEnabled};t.save(this.STORAGE_KEY,n)}}static setDebugEnabled(t){this.debugEnabled=t}static isDebugEnabled(){return this.debugEnabled}static logInfo(t,...e){}static logDebug(t,...e){this.debugEnabled}static logWarn(t,...e){}static logError(t,...e){}}b.PREFIX="[placeholder]",b.debugEnabled=!1,b.STORAGE_KEY="logger";const y=b.logDebug.bind(b),v=b.logInfo.bind(b),w=(b.logWarn.bind(b),b.logError.bind(b));class x{constructor(t="erepaSettings"){this.settings={},this.storageKey=t,this.loadFromLocalStorage()}loadFromLocalStorage(){try{const t=localStorage.getItem(this.storageKey);t&&(this.settings=JSON.parse(t))}catch(t){w("Failed to load settings from localStorage:",t),this.settings={}}}saveToLocalStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.settings))}catch(t){w("Failed to save settings to localStorage:",t)}}configFor(t){return this.settings[t]}save(t,e){this.hasConfig(t)?this.settings[t]={...this.settings[t],...e}:this.settings[t]=e,this.saveToLocalStorage()}hasConfig(t){return t in this.settings}exportToJson(){return JSON.stringify(this.settings,null,2)}importFromJson(t){try{const e=JSON.parse(t);return this.settings=e,this.saveToLocalStorage(),!0}catch(t){return w("Failed to import settings from JSON:",t),!1}}clear(){this.settings={},this.saveToLocalStorage()}}function E(){return SERVER_DATA||{}}function C(){try{return SERVER_DATA.csrfToken||""}catch(t){return w("Failed to get CSRF token",t),""}}class k{constructor(){}getDefaultHeaders(){return{accept:"application/json, text/plain, */*","x-requested-with":"XMLHttpRequest","user-agent":navigator.userAgent,"accept-language":navigator.language}}getDefaultPostHeaders(){return{...this.getDefaultHeaders(),"content-type":"application/x-www-form-urlencoded",origin:"https://www.erepublik.com"}}async get(t,e){const n=k.HOST+t;try{const t={...this.getDefaultHeaders(),...e},i=await fetch(n,{headers:t,credentials:"include"});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return await i.json()}catch(t){throw w(`Failed to GET from ${n}`,t),t}}async getText(t,e){const n=k.HOST+t;try{const t={...this.getDefaultHeaders(),...e},i=await fetch(n,{headers:t,credentials:"include"});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return await i.text()}catch(t){throw w(`Failed to GET text from ${n}`,t),t}}async post(t,e,n){const i=k.HOST+t;try{const t={...this.getDefaultPostHeaders(),...n},a=await fetch(i,{method:"POST",headers:t,body:e,credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(t){throw w(`Failed to POST to ${i}`,t),t}}async fetchJobData(){try{return await this.get("/main/job-data",{referer:`${k.HOST}/economy/myCompanies`})}catch(t){return w("Failed to fetch job data",t),{}}}async performWork(){try{const t=new URLSearchParams;return t.append("_token",C()),t.append("action_type","work"),await this.post("/economy/work",t,{referer:`${k.HOST}/economy/myCompanies`})}catch(t){return w("Failed to perform work",t),{}}}async performWorkOvertime(){try{const t=new URLSearchParams;return t.append("_token",C()),t.append("action_type","workOvertime"),await this.post("/economy/workOvertime",t,{referer:`${k.HOST}/economy/myCompanies`})}catch(t){return w("Failed to perform work overtime",t),{}}}async fetchTrainingData(){try{return await this.get("/main/training-grounds-json",{referer:`${k.HOST}/economy/training-grounds`})}catch(t){return w("Failed to fetch training data",t),{}}}async performTraining(t){try{const e=new URLSearchParams;return t.forEach(((t,n)=>{e.append(`grounds[${n}][id]`,t.toString()),e.append(`grounds[${n}][train]`,"1")})),e.append("_token",C()),await this.post("/economy/train",e,{referer:`${k.HOST}/economy/training-grounds`})}catch(t){return w("Failed to perform training",t),{}}}async fetchFoodOffers(t){try{const e=new URLSearchParams;return e.append("countryId",t.toString()),e.append("industryId","1"),e.append("quality","1"),e.append("orderBy","price_asc"),e.append("currentPage","1"),e.append("ajaxMarket","1"),e.append("_token",C()),await this.post("/economy/marketplaceAjax",e,{referer:`${k.HOST}/economy/marketplace`})}catch(t){return w("Failed to fetch food offers",t),{offers:[],currency:"",can_buy:!1,pages:0}}}async buyFoodItem(t){try{const e=new URLSearchParams;return e.append("offerId",t.toString()),e.append("amount","1"),e.append("orderBy","price_asc"),e.append("currentPage","1"),e.append("buyAction","1"),e.append("_token",C()),await this.post("/economy/marketplaceActions",e,{referer:`${k.HOST}/economy/marketplace`})}catch(t){return w("Failed to buy food item",t),{}}}async fetchGoldOffersHtml(){try{return await this.getText("/economy/exchange-market/",{referer:`${k.HOST}/economy/marketplace`})}catch(t){return w("Failed to fetch gold offers HTML",t),""}}async buyGoldOffer(t){try{const e=new URLSearchParams;return e.append("_token",C()),e.append("offerId",t),e.append("amount","10"),e.append("page","0"),e.append("currencyId","62"),await this.post("/economy/exchange/purchase/",e,{referer:`${k.HOST}/economy/exchange-market/`})}catch(t){return w("Failed to buy gold offer",t),{}}}async claimVIP(){try{const t=new URLSearchParams;return t.append("_token",C()),await this.post("/main/vip-claim",t,{accept:"*/*",referer:`${k.HOST}/main/vip-shop`})}catch(t){return w("Failed to claim VIP",t),{}}}async fetchDailyMissionsData(){try{const t=new URLSearchParams;return t.append("_token",C()),await this.post("/main/daily-missions-data",t)}catch(t){return w("Failed to fetch daily missions data",t),{missions:[]}}}async solveMission(t){try{const e=new URLSearchParams;e.append("_token",C()),e.append("missionId",t.toString());await this.post("/main/mission-solve",e);return!0}catch(e){return w(`Failed to solve mission ${t}`,e),!1}}async fetchObjectiveStatus(){try{const t=new URLSearchParams;return t.append("_token",C()),await this.post("/main/objective-status",t)}catch(t){return w("Failed to fetch objective status",t),{status:{progress:0,claimedObjectives:{},endDate:"",timeLeft:0},data:{}}}}async claimObjectiveReward(t){try{const e=new URLSearchParams;e.append("_token",C()),e.append("objectiveCost",t.toString());await this.post("/main/objective-claim-reward",e);return!0}catch(e){return w(`Failed to claim objective reward ${t}`,e),!1}}async fetchWeeklyChallengeData(){try{return await this.get("/main/weekly-challenge-data")}catch(t){return w("Failed to fetch weekly challenge data",t),{error:!0,rewards:{normal:[],extra:[]}}}}async collectWeeklyRewards(t){try{const e=new URLSearchParams;e.append("_token",C()),e.append("maxRewardId",t.toString());return!(await this.post("/main/weekly-challenge-collect-all",e)).error}catch(e){return w(`Failed to collect weekly rewards with maxRewardId ${t}`,e),!1}}async fetchActiveBattles(){try{return await this.get("/military/campaignsJson/citizen",{referer:`${k.HOST}/military/campaigns`})}catch(t){return w("Failed to fetch active battles",t),{battles:{},contributions:void 0,deployment:void 0,time:0}}}async fetchBattlesDetails(){try{return await this.get("/military/campaignsJson/list")}catch(t){return w("Failed to fetch battles details",t),{battles:{},countries:{},last_updated:0,time:0}}}async deployGroundWeapon(t,e,n,i,a=33,s=33){try{const o=new URLSearchParams;return o.append("_token",C()),o.append("battleId",t.toString()),o.append("battleZoneId",e.toString()),o.append("sideCountryId",n.toString()),o.append("weaponQuality",i.toString()),o.append("totalEnergy",a.toString()),o.append("skinId",s.toString()),await this.post("/military/fightDeploy-startDeploy",o)}catch(t){throw w("Failed to deploy ground weapon",t),t}}async deployBomb(t,e,n,i,a){try{const s=new URLSearchParams;return s.append("battleId",t.toString()),s.append("battleZoneId",e.toString()),s.append("sideId",n.toString()),s.append("sideCountryId",i.toString()),s.append("_token",C()),s.append("bombId",a.toString()),await this.post("/military/deploy-bomb",s)}catch(t){throw w("Failed to deploy bomb",t),t}}}k.HOST="https://www.erepublik.com/en";class S{static isPageReady(){return!!document.querySelector(this.SELECTORS.USER_MENU)&&!!document.querySelector(this.SELECTORS.CONTENT)}static getCurrentPage(){const t=window.location.pathname;return t.includes("/military/campaigns")?"campaigns":t.includes("/military/battlefield")?"battlefield":t.includes("/military/")?"military":t.includes("/economy/marketplace")?"marketplace":t.includes("/economy/training-grounds")?"training":t.includes("/economy/myCompanies")?"companies":t.includes("/economy/")?"economy":t.includes("/citizen/profile/")?"profile":t.includes("/citizen/")?"citizen":t.includes("/main/")?"main":t.includes("/newspaper/")?"newspaper":t.includes("/party/")?"party":t.includes("/military/unit-")?"military-unit":"unknown"}static waitForElement(t,e=5e3){return new Promise(((n,i)=>{const a=document.querySelector(t);if(a)return void n(a);const s=new MutationObserver((()=>{const e=document.querySelector(t);e&&(s.disconnect(),n(e))}));s.observe(document.body,{childList:!0,subtree:!0}),setTimeout((()=>{s.disconnect(),i(new Error(`Element ${t} not found within ${e}ms`))}),e)}))}static waitForElements(t,e=5e3){const n=t.map((t=>this.waitForElement(t,e)));return Promise.all(n)}static hasPageElements(t){switch(t){case"battlefield":return!!document.querySelector(this.SELECTORS.BATTLE_FIELD);case"marketplace":return!!document.querySelector(this.SELECTORS.MARKETPLACE);case"training":return!!document.querySelector(this.SELECTORS.TRAINING_GROUNDS);case"companies":return!!document.querySelector(this.SELECTORS.COMPANY_LIST);case"profile":return!!document.querySelector(this.SELECTORS.CITIZEN_PROFILE);default:return this.isPageReady()}}static getServerData(){try{return window.SERVER_DATA||{}}catch(t){return w("Failed to get server data",t),{}}}static isLoggedIn(){return!!document.querySelector(this.SELECTORS.USER_MENU)}static getCitizenId(){const t=document.querySelector('.user_menu a[href*="/citizen/profile/"]');if(t){const e=t.getAttribute("href"),n=e?.match(/\/citizen\/profile\/(\d+)/);return n?parseInt(n[1]):null}return null}static createContentObserver(t){const e=new MutationObserver(t);return e.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),e}static whenReady(t){if(this.isPageReady())t();else{const e=()=>{this.isPageReady()?t():setTimeout(e,100)};e()}}static whenPageReady(t,e,n=1e4){if(this.hasPageElements(t))return void e();const i=Date.now(),a=()=>{this.hasPageElements(t)?e():Date.now()-i>n?(w(`Page ${t} elements not ready within timeout`),e()):setTimeout(a,100)};a()}static debounce(t,e){let n;return(...i)=>{clearTimeout(n),n=setTimeout((()=>t(...i)),e)}}static throttle(t,e){let n;return(...i)=>{n||(t(...i),n=!0,setTimeout((()=>n=!1),e))}}}S.SELECTORS={USER_MENU:".user_menu",SIDE_BAR:"#side_bar",CONTENT:"#content",BATTLE_FIELD:"#battlefield",MARKETPLACE:".marketplace",MAIN_CONTAINER:".main_container",CITIZEN_PROFILE:".citizen_profile",COMPANY_LIST:".company_list",TRAINING_GROUNDS:".training_grounds"};class T{constructor(t,e,n,i=!1){this.id=t,this.title=e,this.settingsStorage=n,this.enabled=this.loadState(i)}getId(){return this.id}getTitle(){return this.title}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t,this.saveState(),this.onStateChanged()}loadState(t){const e=this.settingsStorage.configFor(this.id);return e?e.enabled:t}saveState(){this.settingsStorage.save(this.id,{enabled:this.enabled})}hasConfigurationUI(){return!1}createConfigurationUI(t){return!1}canRunImmediately(){return!1}requiresDom(){return!0}requiresFullLoad(){return!1}execute(){}handleNewContent(t){}getPriority(){return 100}getActivePages(){return[]}shouldExecuteOnCurrentPage(){const t=this.getActivePages();if(0===t.length)return!0;const e=this.getCurrentPage();return t.includes(e)}getCurrentPage(){return S.getCurrentPage()}beforeExecute(){}afterExecute(){}cleanup(){}}class I extends T{constructor(t){if(super("auto-page-refresh","Auto Page Refresh",t,!0),this.refreshIntervalId=null,t.hasConfig(this.getId())||this.saveState(),this.refreshInterval=this.loadRefreshInterval(),this.isEnabled()){const t=this.settingsStorage.configFor(this.getId());t&&t.autoRefreshActive&&this.settingsStorage.save(this.getId(),{autoRefreshActive:!1}),this.startRefreshTimer()}}getRefreshInterval(){return this.refreshInterval/1e3}setRefreshInterval(t){this.refreshInterval=1e3*t,this.settingsStorage.save(this.getId(),{refreshInterval:this.refreshInterval}),this.isEnabled()&&this.startRefreshTimer()}loadRefreshInterval(){const t=this.settingsStorage.configFor(this.getId());return t&&t.refreshInterval?t.refreshInterval:I.DEFAULT_INTERVAL}onStateChanged(){this.isEnabled()?this.startRefreshTimer():this.stopRefreshTimer()}startRefreshTimer(){this.stopRefreshTimer(),this.refreshIntervalId=window.setInterval((()=>{this.checkCurrentEnabledStatus()?(this.settingsStorage.save(this.getId(),{autoRefreshActive:!0}),window.location.reload()):this.stopRefreshTimer()}),this.refreshInterval)}checkCurrentEnabledStatus(){return this.loadState(!1)}stopRefreshTimer(){null!==this.refreshIntervalId&&(window.clearInterval(this.refreshIntervalId),this.refreshIntervalId=null)}hasConfigurationUI(){return!0}createConfigurationUI(t){const e=document.createElement("div");e.className="ptnpnh-config-container ptnpnh-config-container-horizontal";const n=document.createElement("label");n.textContent="Refresh interval in seconds:",n.htmlFor=`interval-${this.getId()}`,n.className="ptnpnh-config-label";const i=document.createElement("input");return i.type="number",i.id=`interval-${this.getId()}`,i.className="ptnpnh-config-input",i.min="1",i.value=this.getRefreshInterval().toString(),i.addEventListener("change",(()=>{const t=parseInt(i.value,10);t>0&&this.setRefreshInterval(t)})),e.appendChild(n),e.appendChild(i),t.appendChild(e),!0}}I.DEFAULT_INTERVAL=3e5;class A extends T{constructor(t){super("debug-logging","Enable Debug Logging",t,!1),t.hasConfig(this.getId())||this.saveState()}canRunImmediately(){return!0}getPriority(){return 10}execute(){b.setDebugEnabled(this.isEnabled())}onStateChanged(){b.setDebugEnabled(this.isEnabled())}}class L extends T{constructor(t){super("hide-finances","Hide Finances",t,!1),this.isEnabled()&&this.hideFinances()}onStateChanged(){this.isEnabled()?this.hideFinances():this.showFinances()}hideFinances(){const t=document.getElementById("side_bar_gold_account_value"),e=document.getElementById("side_bar_currency_account_value");t&&(t.textContent="0"),e&&(e.textContent="0")}showFinances(){const t=document.getElementById("side_bar_gold_account_value"),e=document.getElementById("side_bar_currency_account_value");if(t){const e=t.getAttribute("data-amount")||window.erepublik?.citizen?.gold?.toString()||"0";t.textContent=this.formatNumber(e)}if(e){const t=e.getAttribute("data-amount")||window.erepublik?.citizen?.currencyAmount?.toString()||"0";e.textContent=this.formatNumber(t)}}formatNumber(t){return parseInt(t,10).toLocaleString()}}var F=n(11),R={};R.styleTagTransform=g(),R.setAttributes=c(),R.insert=l().bind(null,"head"),R.domAPI=o(),R.insertStyleElement=p();a()(F.A,R);F.A&&F.A.locals&&F.A.locals;function D(){let t=document.getElementById("erepa_container");if(!t){const e=document.getElementById("large_sidebar");if(!e)return;t=document.createElement("div"),t.id="erepa_container",e.appendChild(t)}return t}class P extends T{constructor(t){super("level-progress","Level Progress",t,!0),this.progressBarContainer=null,this.isEnabled()&&this.showLevelProgress()}onStateChanged(){this.isEnabled()?this.showLevelProgress():this.hideLevelProgress()}showLevelProgress(){try{const t=D();if(!t)return;this.progressBarContainer||(this.progressBarContainer=document.createElement("div"),this.progressBarContainer.id="ptnpnh-level-progress-container",this.progressBarContainer.innerHTML='<div class="ptnpnh-level-progress-bar">\n  <div class="ptnpnh-level-progress-fill"></div>\n  <div class="ptnpnh-level-progress-text"></div>\n</div>'),this.updateProgressBar(),document.getElementById("ptnpnh-level-progress-container")||t.appendChild(this.progressBarContainer)}catch(t){return void w("Error showing level progress",t)}}updateProgressBar(){if(!this.progressBarContainer)return;const t=document.querySelector(".actualXp"),e=document.getElementById("experienceTooltip");if(!t||!e)return void w("Experience elements not found");const n=t.getAttribute("style"),i=n?n.match(/width:(\d+\.\d+)%/):null,a=i?parseFloat(i[1]):0,s=e.textContent||"",o=s.match(/Experience points: .*?(\d+(?:,\d+)*)/),r=s.match(/Next level at: .*?(\d+(?:,\d+)*)/);if(!o||!r)return void w("Could not extract experience points information");const l=parseInt(o[1].replace(/,/g,""),10),d=parseInt(r[1].replace(/,/g,""),10)-l,c=this.progressBarContainer.querySelector(".ptnpnh-level-progress-fill");c&&(c.style.width=`${a}%`);const h=this.progressBarContainer.querySelector(".ptnpnh-level-progress-text");h&&(h.textContent=`${d.toLocaleString()} XP to next level`)}hideLevelProgress(){this.progressBarContainer&&(this.progressBarContainer.remove(),this.progressBarContainer=null)}}var $=n(655),B={};B.styleTagTransform=g(),B.setAttributes=c(),B.insert=l().bind(null,"head"),B.domAPI=o(),B.insertStyleElement=p();a()($.A,B);$.A&&$.A.locals&&$.A.locals;class N extends T{constructor(t){super("energy-countdown","Energy Countdown",t,!0),this.countdownContainer=null,this.updateInterval=null,this.isEnabled()&&this.showEnergyCountdown()}onStateChanged(){this.isEnabled()?this.showEnergyCountdown():this.hideEnergyCountdown()}showEnergyCountdown(){try{const t=D();if(!t)return;this.countdownContainer||(this.countdownContainer=document.createElement("div"),this.countdownContainer.id="ptnpnh-energy-countdown-container",this.countdownContainer.innerHTML='<div class="ptnpnh-energy-countdown-container">\n  <div class="ptnpnh-energy-countdown-text">Full energy in: <span class="ptnpnh-energy-countdown-time"></span></div>\n</div>'),this.updateCountdown(),this.updateInterval||(this.updateInterval=window.setInterval((()=>this.updateCountdown()),1e3)),document.getElementById("ptnpnh-energy-countdown-container")||t.appendChild(this.countdownContainer)}catch(t){return void w("Error showing energy countdown",t)}}updateCountdown(){if(!this.countdownContainer)return;const t=document.getElementById("secondsToFullEnergy");if(!t)return;if(!t.getAttribute("data-seconds"))return void w("Seconds to full energy data attribute not found");const e=t.querySelector(".countdown_amount")?.textContent||"",n=this.countdownContainer.querySelector(".ptnpnh-energy-countdown-time");n&&(n.textContent=e)}hideEnergyCountdown(){this.countdownContainer&&(this.countdownContainer.remove(),this.countdownContainer=null),this.updateInterval&&(window.clearInterval(this.updateInterval),this.updateInterval=null)}}var O=n(577),M={};M.styleTagTransform=g(),M.setAttributes=c(),M.insert=l().bind(null,"head"),M.domAPI=o(),M.insertStyleElement=p();a()(O.A,M);O.A&&O.A.locals&&O.A.locals;class _{constructor(t,e,n,i,a){this.id=t,this.name=e,this.code2=n,this.code3=i,this.emoji=a}}const z={1:new _(1,"Romania","RO","ROU","🇷🇴"),9:new _(9,"Brazil","BR","BRA","🇧🇷"),10:new _(10,"Italy","IT","ITA","🇮🇹"),11:new _(11,"France","FR","FRA","🇫🇷"),12:new _(12,"Germany","DE","DEU","🇩🇪"),13:new _(13,"Hungary","HU","HUN","🇭🇺"),14:new _(14,"China","CN","CHN","🇨🇳"),15:new _(15,"Spain","ES","ESP","🇪🇸"),23:new _(23,"Canada","CA","CAN","🇨🇦"),24:new _(24,"USA","US","USA","🇺🇸"),26:new _(26,"Mexico","MX","MEX","🇲🇽"),27:new _(27,"Argentina","AR","ARG","🇦🇷"),28:new _(28,"Venezuela","VE","VEN","🇻🇪"),29:new _(29,"United Kingdom","GB","GBR","🇬🇧"),30:new _(30,"Switzerland","CH","CHE","🇨🇭"),31:new _(31,"Netherlands","NL","NLD","🇳🇱"),32:new _(32,"Belgium","BE","BEL","🇧🇪"),33:new _(33,"Austria","AT","AUT","🇦🇹"),34:new _(34,"Czech Republic","CZ","CZE","🇨🇿"),35:new _(35,"Poland","PL","POL","🇵🇱"),36:new _(36,"Slovakia","SK","SVK","🇸🇰"),37:new _(37,"Norway","NO","NOR","🇳🇴"),38:new _(38,"Sweden","SE","SWE","🇸🇪"),39:new _(39,"Finland","FI","FIN","🇫🇮"),40:new _(40,"Ukraine","UA","UKR","🇺🇦"),41:new _(41,"Russia","RU","RUS","🇷🇺"),42:new _(42,"Bulgaria","BG","BGR","🇧🇬"),43:new _(43,"Turkey","TR","TUR","🇹🇷"),44:new _(44,"Greece","GR","GRC","🇬🇷"),45:new _(45,"Japan","JP","JPN","🇯🇵"),47:new _(47,"South Korea","KR","KOR","🇰🇷"),48:new _(48,"India","IN","IND","🇮🇳"),49:new _(49,"Indonesia","ID","IDN","🇮🇩"),50:new _(50,"Australia","AU","AUS","🇦🇺"),51:new _(51,"South Africa","ZA","ZAF","🇿🇦"),52:new _(52,"Republic of Moldova","MD","MDA","🇲🇩"),53:new _(53,"Portugal","PT","PRT","🇵🇹"),54:new _(54,"Ireland","IE","IRL","🇮🇪"),55:new _(55,"Denmark","DK","DNK","🇩🇰"),56:new _(56,"Iran","IR","IRN","🇮🇷"),57:new _(57,"Pakistan","PK","PAK","🇵🇰"),58:new _(58,"Israel","IL","ISR","🇮🇱"),59:new _(59,"Thailand","TH","THA","🇹🇭"),61:new _(61,"Slovenia","SI","SVN","🇸🇮"),63:new _(63,"Croatia","HR","HRV","🇭🇷"),64:new _(64,"Chile","CL","CHL","🇨🇱"),65:new _(65,"Serbia","RS","SRB","🇷🇸"),66:new _(66,"Malaysia","MY","MYS","🇲🇾"),67:new _(67,"Philippines","PH","PHL","🇵🇭"),68:new _(68,"Singapore","SG","SGP","🇸🇬"),69:new _(69,"Bosnia and Herzegovina","BA","BIH","🇧🇦"),70:new _(70,"Estonia","EE","EST","🇪🇪"),71:new _(71,"Latvia","LV","LVA","🇱🇻"),72:new _(72,"Lithuania","LT","LTU","🇱🇹"),73:new _(73,"North Korea","KP","PRK","🇰🇵"),74:new _(74,"Uruguay","UY","URY","🇺🇾"),75:new _(75,"Paraguay","PY","PRY","🇵🇾"),76:new _(76,"Bolivia","BO","BOL","🇧🇴"),77:new _(77,"Peru","PE","PER","🇵🇪"),78:new _(78,"Colombia","CO","COL","🇨🇴"),79:new _(79,"North Macedonia","MK","MKD","🇲🇰"),80:new _(80,"Montenegro","ME","MNE","🇲🇪"),81:new _(81,"Republic of China (Taiwan)","TW","TWN","🇹🇼"),82:new _(82,"Cyprus","CY","CYP","🇨🇾"),83:new _(83,"Belarus","BY","BLR","🇧🇾"),84:new _(84,"New Zealand","NZ","NZL","🇳🇿"),164:new _(164,"Saudi Arabia","SA","SAU","🇸🇦"),165:new _(165,"Egypt","EG","EGY","🇪🇬"),166:new _(166,"United Arab Emirates","AE","ARE","🇦🇪"),167:new _(167,"Albania","AL","ALB","🇦🇱"),168:new _(168,"Georgia","GE","GEO","🇬🇪"),169:new _(169,"Armenia","AM","ARM","🇦🇲"),170:new _(170,"Nigeria","NG","NGA","🇳🇬"),171:new _(171,"Cuba","CU","CUB","🇨🇺")};class H extends T{constructor(t){super("ip-location","IP Location",t,!0),this.ipLocationContainer=null,this.isEnabled()&&this.showIpLocation()}onStateChanged(){this.isEnabled()?this.showIpLocation():this.hideIpLocation()}async showIpLocation(){try{const t=D();if(!t)return;this.ipLocationContainer||(this.ipLocationContainer=document.createElement("div"),this.ipLocationContainer.id="ptnpnh-ip-location-container",this.ipLocationContainer.innerHTML='<div class="ptnpnh-ip-location-container">\n  <span class="ptnpnh-ip-location-info"></span>\n</div>'),document.getElementById("ptnpnh-ip-location-container")||t.appendChild(this.ipLocationContainer)}catch(t){return void w("Error showing IP location",t)}try{const t=await this.fetchIpInfo();this.updateIpLocationInfo(t)}catch(t){w("Failed to fetch IP info",t)}}async fetchIpInfo(){const t=await fetch("https://ipinfo.io/json");if(!t.ok)throw new Error(`Failed to fetch IP info: ${t.statusText}`);return await t.json()}updateIpLocationInfo(t){if(!this.ipLocationContainer||!t)return;const e=this.ipLocationContainer.querySelector(".ptnpnh-ip-location-info");if(e){const n=function(t){const e=t.toUpperCase();return Object.values(z).find((t=>t.code2===e))}(t.country);e.textContent=`${t.ip} ${n?.emoji||"🌍"}`}}hideIpLocation(){this.ipLocationContainer&&(this.ipLocationContainer.remove(),this.ipLocationContainer=null)}}class U extends T{constructor(t){super("remove-annoying-popups","Remove Annoying Popups",t,!0),this.annoyingElements=[{type:"id",value:"ErpkPopupPromosControllerPopup"},{type:"selector",value:".lb_overlay.js_lb_overlay"},{type:"selector",value:"div[class='blockUI blockOverlay']"},{type:"selector",value:"div[class='blockUI blockMsg blockElement']"}],this.observer=null,this.isEnabled()&&this.removeAnnoyingPopups()}onStateChanged(){this.isEnabled()?this.removeAnnoyingPopups():this.disconnectObserver()}removeAnnoyingPopups(){const t=()=>{for(const t of this.annoyingElements){let e=[];if("id"===t.type){const n=document.getElementById(t.value);n&&e.push(n)}else if("class"===t.type){const n=document.getElementsByClassName(t.value);e=Array.from(n)}else if("selector"===t.type){const n=document.querySelectorAll(t.value);e=Array.from(n)}for(const t of e)t.remove()}};t(),this.disconnectObserver(),this.observer=new MutationObserver((e=>{for(const n of e)if("childList"===n.type&&n.addedNodes.length>0){let e=!1;for(const t of this.annoyingElements){if("id"===t.type&&document.getElementById(t.value)){e=!0;break}if("class"===t.type&&document.getElementsByClassName(t.value).length>0){e=!0;break}if("selector"===t.type&&document.querySelectorAll(t.value).length>0){e=!0;break}}if(e){t();break}}}));try{this.observer.observe(document.body,{childList:!0,subtree:!0})}catch(t){w("Failed to set up observer for annoying elements removal",t)}}disconnectObserver(){this.observer&&(this.observer.disconnect(),this.observer=null)}}var q=n(54),j={};j.styleTagTransform=g(),j.setAttributes=c(),j.insert=l().bind(null,"head"),j.domAPI=o(),j.insertStyleElement=p();a()(q.A,j);q.A&&q.A.locals&&q.A.locals;class G extends T{constructor(t){super("filter-posts","Filter Posts",t,!0),this.keywords=[],this.observer=null,t.hasConfig(this.getId())||this.saveState(),this.keywords=this.loadKeywords(),this.isEnabled()&&this.applyFilters()}loadKeywords(){const t=this.settingsStorage.configFor(this.getId());return t&&t.keywords?t.keywords:[]}getKeywords(){return this.keywords.join("\n")}setKeywords(t){this.keywords=t.split("\n").filter((t=>""!==t.trim())),this.settingsStorage.save(this.getId(),{keywords:this.keywords}),this.isEnabled()&&this.applyFilters()}onStateChanged(){this.isEnabled()?this.applyFilters():this.removeFilters()}applyFilters(){this.filterPosts(),this.setupObserver()}removeFilters(){this.observer&&(this.observer.disconnect(),this.observer=null);document.querySelectorAll(".postContainer.ptnpnh-hidden-post").forEach((t=>{t.classList.remove("ptnpnh-hidden-post")}))}filterPosts(){if(0===this.keywords.length)return;document.querySelectorAll(".postContainer").forEach((t=>{this.checkAndFilterPost(t)}))}checkAndFilterPost(t){const e=t.querySelector("h6"),n=t.querySelector("p.contentMessage");if(!e||!n)return;const i=e.textContent||"",a=n.textContent||"";this.keywords.some((t=>i.toLowerCase().includes(t.toLowerCase())||a.toLowerCase().includes(t.toLowerCase())))?t.classList.add("ptnpnh-hidden-post"):t.classList.remove("ptnpnh-hidden-post")}setupObserver(){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver((t=>{let e=!1;t.forEach((t=>{"childList"===t.type&&t.addedNodes.length>0&&(e=!0)})),e&&this.filterPosts()}));const t=document.querySelector(".postsWrapper");t?(v("FilterPostsFeature: Observing postsWrapper for changes"),this.observer.observe(t,{childList:!0,subtree:!0})):v("FilterPostsFeature: No postsWrapper found to observe")}hasConfigurationUI(){return!0}createConfigurationUI(t){const e=document.createElement("div");e.innerHTML='<div class="ptnpnh-config-container ptnpnh-config-container-vertical">\n  <label for="keywords-filter-posts" class="ptnpnh-config-label">Enter keywords to filter posts (one per line):</label>\n  <textarea id="keywords-filter-posts" class="ptnpnh-config-textarea" rows="5"></textarea>\n</div>\n';const n=e.firstChild,i=n.querySelector("textarea");return i&&(i.value=this.getKeywords(),i.addEventListener("change",(()=>{this.setKeywords(i.value)}))),t.appendChild(n),!0}}var Y=n(230),W={};W.styleTagTransform=g(),W.setAttributes=c(),W.insert=l().bind(null,"head"),W.domAPI=o(),W.insertStyleElement=p();a()(Y.A,W);Y.A&&Y.A.locals&&Y.A.locals;class V extends T{constructor(t){super("profile-switcher","Profile Switcher",t,!0),this.observer=null,this.leftArrow=null,this.rightArrow=null,this.isEnabled()&&this.initProfileSwitcher()}onStateChanged(){this.isEnabled()?this.initProfileSwitcher():this.removeProfileSwitcher()}initProfileSwitcher(){this.isProfilePage()?this.addArrows():this.setupObserver()}isProfilePage(){return window.location.href.includes("/citizen/profile/")}setupObserver(){this.observer&&(this.observer.disconnect(),this.observer=null),this.observer=new MutationObserver((()=>{this.isProfilePage()?this.addArrows():this.removeArrows()})),this.observer.observe(document.body,{childList:!0,subtree:!0})}addArrows(t=0,e=5){this.removeArrows();const n=document.querySelector(".citizen_name");if(!n)return w(`Profile Switcher: Could not find citizen name element (attempt ${t+1}/${e+1})`),this.isProfilePage()&&t<e?void setTimeout((()=>{this.addArrows(t+1,e)}),150):void 0;const i=document.createElement("div");i.className="ptnpnh-profile-switcher-arrows",this.leftArrow=document.createElement("span"),this.leftArrow.className="ptnpnh-profile-switcher-arrow ptnpnh-profile-switcher-left",this.leftArrow.innerHTML="👈",this.leftArrow.title="Previous profile",this.leftArrow.addEventListener("click",(()=>this.switchProfile(-1))),this.rightArrow=document.createElement("span"),this.rightArrow.className="ptnpnh-profile-switcher-arrow ptnpnh-profile-switcher-right",this.rightArrow.innerHTML="👉",this.rightArrow.title="Next profile",this.rightArrow.addEventListener("click",(()=>this.switchProfile(1))),i.appendChild(this.leftArrow),i.appendChild(this.rightArrow),n.insertAdjacentElement("afterend",i),v("Profile Switcher: Arrows added")}removeArrows(){const t=document.querySelector(".ptnpnh-profile-switcher-arrows");t&&t.remove(),this.leftArrow=null,this.rightArrow=null}switchProfile(t){const e=window.location.href.split("/"),n=e.indexOf("profile")+1;if(n<e.length){const i=parseInt(e[n],10);if(!isNaN(i)){const a=i+t;e[n]=a.toString();const s=e.join("/");window.location.href=s}}}removeProfileSwitcher(){this.observer&&(this.observer.disconnect(),this.observer=null),this.removeArrows()}}var K=n(986),Z={};Z.styleTagTransform=g(),Z.setAttributes=c(),Z.insert=l().bind(null,"head"),Z.domAPI=o(),Z.insertStyleElement=p();a()(K.A,Z);K.A&&K.A.locals&&K.A.locals;class X extends T{constructor(t){super("add-to-friendlist","Add to Friendlist",t,!0),this.observer=null,this.urlPattern=/\/main\/online-users\/([^\/]+)\/([^\/]+)\/(\d+)/}getActivePages(){return["main"]}getPriority(){return 60}execute(){this.initialize()}handleNewContent(t){if(this.isEnabled()){const e=t.querySelectorAll(".citizen");e.length>0&&e.forEach((t=>this.processOneCitizen(t)))}}onStateChanged(){this.isEnabled()?this.initialize():this.cleanup()}initialize(){this.isOnlineUsersPage()&&(this.processCitizens(),this.setupObserver())}isOnlineUsersPage(){const{pathname:t}=window.location;return this.urlPattern.test(t)}cleanup(){this.observer&&(this.observer.disconnect(),this.observer=null);document.querySelectorAll(".ptnpnh-add-friend-btn").forEach((t=>t.remove())),super.cleanup()}processCitizens(){document.querySelectorAll(".citizen").forEach((t=>{this.processOneCitizen(t)}))}async processOneCitizen(t){if(t.querySelector(".ptnpnh-add-friend-btn"))return;const e=t.querySelector('a[hovercard="1"]');if(!e)return;const n=e.getAttribute("href");if(!n)return;const i=n.match(/\/citizen\/profile\/(\d+)/);if(!i)return;const a=i[1];try{const e=await this.fetchCitizenData(a);e.isFriend||this.addFriendButton(t,a,e.name)}catch(t){w(`Failed to fetch data for citizen ${a}:`,t)}}async fetchCitizenData(t){const e=`https://www.erepublik.com/en/main/citizen-hovercard/${t}`,n=await fetch(e,{headers:{accept:"application/json, text/plain, */*","x-requested-with":"XMLHttpRequest"},credentials:"include"});if(!n.ok)throw new Error(`Failed to fetch citizen data: ${n.status} ${n.statusText}`);return await n.json()}addFriendButton(t,e,n){const i=t.querySelector(".nameholder");if(!i)return;const a=document.createElement("a");a.classList.add("ptnpnh-add-friend-btn"),a.title=`Add ${n} to friendlist`,a.setAttribute("data-citizen-id",e),a.setAttribute("data-citizen-name",n),a.addEventListener("click",(t=>{t.preventDefault(),this.sendFriendRequest(a)})),i.appendChild(a)}async sendFriendRequest(t){const e=t.getAttribute("data-citizen-id"),n=t.getAttribute("data-citizen-name");if(e&&n)try{const i=C();if(!i)throw new Error("CSRF token not found");const a=await fetch("https://www.erepublik.com/en/main/citizen-addRemoveFriend",{headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"},referrer:window.location.href,body:`action=addFriend&citizenId=${e}&url=%2F%2Fwww.erepublik.com%2Fen%2Fmain%2Fcitizen-addRemoveFriend&_token=${i}`,method:"POST",mode:"cors",credentials:"include"});if(!a.ok)throw new Error(`Failed to send friend request: ${a.status} ${a.statusText}`);const s=await a.json();if(!s.status)throw new Error(s.message||"Unknown error");t.classList.remove("ptnpnh-add-friend-btn"),t.classList.add("ptnpnh-friend-pending-btn"),t.title=`Friend request sent to ${n}`,v(`Friend request sent to ${n}`)}catch(t){w(`Failed to add ${n} to friendlist:`,t),this.showNotification(`${t}`,"error")}}setupObserver(){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver((t=>{t.forEach((t=>{"childList"===t.type&&t.addedNodes.length>0&&t.addedNodes.forEach((t=>{if(t instanceof HTMLElement)if(t.classList.contains("citizen"))this.processOneCitizen(t);else{t.querySelectorAll(".citizen").forEach((t=>this.processOneCitizen(t)))}}))}))}));const t=document.querySelector(".online-citizenList, .citizensList");t?(v("AddToFriendlistFeature: Observing citizen list for changes"),this.observer.observe(t,{childList:!0,subtree:!0})):v("AddToFriendlistFeature: No citizen list found to observe")}showNotification(t,e="info"){let n=document.getElementById("ptnpnh-notification-container");n||(n=document.createElement("div"),n.id="ptnpnh-notification-container",document.body.appendChild(n));const i=document.createElement("div");i.className=`ptnpnh-notification ptnpnh-notification-${e}`,i.textContent=t,n.appendChild(i),setTimeout((()=>{i.remove(),n&&0===n.children.length&&n.remove()}),15e3),"error"===e?w(t):v("warning"===e?`WARNING: ${t}`:t)}}var J=n(98),Q={};Q.styleTagTransform=g(),Q.setAttributes=c(),Q.insert=l().bind(null,"head"),Q.domAPI=o(),Q.insertStyleElement=p();a()(J.A,Q);J.A&&J.A.locals&&J.A.locals;class tt extends T{constructor(t,e){super("active-battles","Active Battles",t,!0),this.dialogContainer=null,this.isDragging=!1,this.dragOffsetX=0,this.dragOffsetY=0,this.lastUpdateTime=0,this.updateTimer=null,this.isManualRefresh=!1,this.activeBattles={},this.battleListData=null,this.boundOnDragMove=null,this.boundOnDragEnd=null,this.boundOnTouchMove=null,this.eClient=e}requiresDom(){return!0}getActivePages(){return[]}getPriority(){return 50}execute(){this.isEnabled()&&this.showActiveBattles()}onStateChanged(){this.isEnabled()?this.showActiveBattles():this.hideActiveBattles()}cleanup(){this.hideActiveBattles(),super.cleanup()}startUpdateTimer(){this.clearUpdateTimer(),this.updateTimer=window.setInterval((()=>{this.updateElapsedTimeDisplay()}),6e4),this.updateElapsedTimeDisplay()}clearUpdateTimer(){null!==this.updateTimer&&(clearInterval(this.updateTimer),this.updateTimer=null)}updateElapsedTimeDisplay(){if(!this.dialogContainer||0===this.lastUpdateTime)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-last-update");if(!t)return;const e=Math.floor(Date.now()/1e3),n=e-this.lastUpdateTime;if(this.isManualRefresh)t.textContent=" (now)",n>=60&&(this.isManualRefresh=!1);else if(n>=60){const e=Math.floor(n/60);t.textContent=` (${e}m ago)`}else t.textContent=" (now)";if(this.activeBattles&&this.battleListData&&Object.keys(this.activeBattles).length>0&&this.battleListData){const t=this.battleListData.time;this.battleListData.time=e;const n=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(n),this.battleListData.time=t}}showActiveBattles(){if(!this.dialogContainer){this.dialogContainer=document.createElement("div"),this.dialogContainer.id="ptnpnh-active-battles-dialog",this.dialogContainer.innerHTML='<div class="ptnpnh-active-battles-container">\n  <div class="ptnpnh-active-battles-header">\n    <div>\n      Active battles\n      <span class="ptnpnh-active-battles-last-update"></span>\n    </div>\n    <span class="ptnpnh-active-battles-refresh"></span>\n  </div>\n  <div class="ptnpnh-active-battles-body"></div>\n</div>\n',this.setupRefreshIcon(),this.setupDraggable();const t=this.settingsStorage.configFor("active-battles-position");t&&(this.dialogContainer.style.left=`${t.left}px`,this.dialogContainer.style.top=`${t.top}px`,v("Restored active battles position:",t))}if(!document.getElementById("ptnpnh-active-battles-dialog")){try{document.body.appendChild(this.dialogContainer)}catch(t){return void w("Error showing active battles dialog",t)}this.loadBattlesFromStorage(),this.startUpdateTimer()}}setupRefreshIcon(){if(!this.dialogContainer)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-refresh");if(!t)return void w("Refresh icon element not found");t.innerHTML='\n<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 32 32">\n<path d="M 15 3 C 12.053086 3 9.3294211 4.0897803 7.2558594 5.8359375 A 1.0001 1.0001 0 1 0 8.5449219 7.3652344 C 10.27136 5.9113916 12.546914 5 15 5 C 20.226608 5 24.456683 8.9136179 24.951172 14 L 22 14 L 26 20 L 30 14 L 26.949219 14 C 26.441216 7.8348596 21.297943 3 15 3 z M 4.3007812 9 L 0.30078125 15 L 3 15 C 3 21.635519 8.3644809 27 15 27 C 17.946914 27 20.670579 25.91022 22.744141 24.164062 A 1.0001 1.0001 0 1 0 21.455078 22.634766 C 19.72864 24.088608 17.453086 25 15 25 C 9.4355191 25 5 20.564481 5 15 L 8.3007812 15 L 4.3007812 9 z"></path>\n</svg>\n';const e=t=>{t.stopPropagation(),t.preventDefault(),v("Refresh icon activated"),this.isManualRefresh=!0,this.fetchActiveBattles()};t.addEventListener("click",e),t.addEventListener("touchstart",e)}hideActiveBattles(){this.clearUpdateTimer(),this.cleanupEventListeners(),this.dialogContainer&&(this.dialogContainer.remove(),this.dialogContainer=null)}cleanupEventListeners(){this.boundOnDragMove&&(document.removeEventListener("mousemove",this.boundOnDragMove),this.boundOnDragMove=null),this.boundOnDragEnd&&(document.removeEventListener("mouseup",this.boundOnDragEnd),document.removeEventListener("touchend",this.boundOnDragEnd),this.boundOnDragEnd=null),this.boundOnTouchMove&&(document.removeEventListener("touchmove",this.boundOnTouchMove),this.boundOnTouchMove=null)}setupDraggable(){if(!this.dialogContainer)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-header");t?(this.cleanupEventListeners(),this.boundOnDragMove=this.onDragMove.bind(this),this.boundOnDragEnd=this.onDragEnd.bind(this),this.boundOnTouchMove=this.onTouchMove.bind(this),t.addEventListener("mousedown",this.onDragStart.bind(this)),document.addEventListener("mousemove",this.boundOnDragMove),document.addEventListener("mouseup",this.boundOnDragEnd),t.addEventListener("touchstart",this.onTouchStart.bind(this)),document.addEventListener("touchmove",this.boundOnTouchMove),document.addEventListener("touchend",this.boundOnDragEnd)):w("Active battles header not found")}onDragStart(t){this.dialogContainer&&(this.isDragging=!0,this.dragOffsetX=t.clientX-this.dialogContainer.offsetLeft,this.dragOffsetY=t.clientY-this.dialogContainer.offsetTop,t.preventDefault())}onTouchStart(t){this.dialogContainer&&0!==t.touches.length&&(this.isDragging=!0,this.dragOffsetX=t.touches[0].clientX-this.dialogContainer.offsetLeft,this.dragOffsetY=t.touches[0].clientY-this.dialogContainer.offsetTop,t.preventDefault())}onDragMove(t){if(!this.isDragging||!this.dialogContainer)return;const e=t.clientX-this.dragOffsetX,n=t.clientY-this.dragOffsetY;this.updatePosition(e,n)}onTouchMove(t){if(!this.isDragging||!this.dialogContainer||0===t.touches.length)return;const e=t.touches[0].clientX-this.dragOffsetX,n=t.touches[0].clientY-this.dragOffsetY;this.updatePosition(e,n),t.preventDefault()}onDragEnd(){if(this.isDragging=!1,this.dialogContainer){const t=parseInt(this.dialogContainer.style.left)||100,e=parseInt(this.dialogContainer.style.top)||100;this.settingsStorage.save("active-battles-position",{left:t,top:e}),v("Saved active battles position:",{left:t,top:e})}}updatePosition(t,e){if(!this.dialogContainer)return;const n=window.innerWidth-this.dialogContainer.offsetWidth,i=window.innerHeight-this.dialogContainer.offsetHeight,a=Math.max(0,Math.min(t,n)),s=Math.max(0,Math.min(e,i));this.dialogContainer.style.left=`${a}px`,this.dialogContainer.style.top=`${s}px`}loadBattlesFromStorage(){const t=this.settingsStorage.configFor("active-battles-data");if(!t)return void this.fetchActiveBattles();this.lastUpdateTime=t.lastUpdateTime,this.activeBattles=t.activeBattles,this.battleListData=t.battleListData;const e=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(e),this.updateElapsedTimeDisplay(),v("Loaded battles from storage, last updated at:",new Date(1e3*this.lastUpdateTime).toLocaleString())}async fetchActiveBattles(){try{this.isManualRefresh=!0,this.updateBattlesList("Loading...");const t=await this.eClient.fetchActiveBattles();if(v("Citizen battles data:",t),this.activeBattles=this.filterActiveBattles(t),v("Active battles:",this.activeBattles),0===Object.keys(this.activeBattles).length)return this.lastUpdateTime=Math.floor(Date.now()/1e3),this.settingsStorage.save("active-battles-data",{activeBattles:{},battleListData:this.battleListData||null,lastUpdateTime:this.lastUpdateTime}),this.updateBattlesList("No active battles found"),this.updateElapsedTimeDisplay(),void this.startUpdateTimer();this.battleListData=await this.eClient.fetchBattlesDetails(),v("Battle list data:",this.battleListData),this.lastUpdateTime=Math.floor(Date.now()/1e3),this.settingsStorage.save("active-battles-data",{activeBattles:this.activeBattles,battleListData:this.battleListData,lastUpdateTime:this.lastUpdateTime}),v("Saved battles to storage at:",new Date(1e3*this.lastUpdateTime).toLocaleString());const e=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(e),this.updateElapsedTimeDisplay(),this.startUpdateTimer()}catch(t){w("Error fetching active battles:",t),this.updateBattlesList("Error loading battles. Please try again.")}}filterActiveBattles(t){const e={};for(const n in t.battles){const i=t.battles[n];for(const t in i.citizenStats){const a=i.citizenStats[t];a.activeZones&&a.activeZones.length>0&&(e[n]||(e[n]={}),e[n][t]=a.activeZones)}}return e}generateBattleLinks(t,e){const n=[];for(const i in t){const a=e.battles[i];if(!a)continue;const s=a.start,o=e.time-s,r=Math.floor(o/60);if(r>120){v(`Skipping battle ${i} as it's ${r} minutes old (max: 120)`);continue}const l=a.region.name,d=`${r}m`;for(const e in t[i]){const o=parseInt(e,10),r=z[o],c=r?r.emoji:"",h=t[i][e];for(const t of h){const e=t.toString(),o=a.div[e];if(o&&!o.division_end){const e=o.div;n.push({battleId:i,zoneId:t,regionName:l,countryEmoji:c,divisionNumber:e,startTime:s,elapsedTimeText:d})}}}}n.sort(((t,e)=>e.startTime!==t.startTime?t.startTime-e.startTime:t.divisionNumber-e.divisionNumber));let i="";for(const t of n)i+=`<a href="https://www.erepublik.com/en/military/battlefield/${t.battleId}/${t.zoneId}" target="_blank">${t.regionName} (${t.countryEmoji} D${t.divisionNumber}, ${t.elapsedTimeText})</a>`;return i||"No active battles found"}updateBattlesList(t){if(!this.dialogContainer)return;const e=this.dialogContainer.querySelector(".ptnpnh-active-battles-body");e&&(e.innerHTML=t)}}var et=n(506),nt={};nt.styleTagTransform=g(),nt.setAttributes=c(),nt.insert=l().bind(null,"head"),nt.domAPI=o(),nt.insertStyleElement=p();a()(et.A,nt);et.A&&et.A.locals&&et.A.locals;class it extends T{constructor(t){super("display-travel-distance","Display Travel Distance",t,!0),this.container=null,this.isEnabled()&&this.showTravelDistance()}isBattlefieldPage(){return null!==window.location.href.match(/\/military\/battlefield\/\d+/i)}onStateChanged(){this.isEnabled()?this.showTravelDistance():this.hideTravelDistance()}showTravelDistance(){try{if(!this.isBattlefieldPage())return void v(`[${this.getTitle()}] Not on a battlefield page, skipping`);if(this.container)return;this.container=document.createElement("div"),this.container.id="ptnpnh-travel-distance",this.container.innerHTML='<div class="ptnpnh-travel-distance-container">\n  <div class="ptnpnh-travel-distance-body">\n    <p class="ptnpnh-travel-distance-content"></p>\n  </div>\n</div>\n';const t=document.getElementsByClassName("battle_sidebar")[0];t?(t.appendChild(this.container),this.displayNearestOpponentRegion(),v(`[${this.getTitle()}] Travel distance display initialized`)):w(`[${this.getTitle()}] Failed to find battle sidebar`)}catch(t){w(`[${this.getTitle()}] Error showing travel distance: ${t}`)}}displayNearestOpponentRegion(){try{const t=E();if(!t)return void w(`[${this.getTitle()}] SERVER_DATA not found on window object`);const e=t.mySideCountryId;if(!e)return void w(`[${this.getTitle()}] mySideCountryId not found in SERVER_DATA`);const n=t.travel?.travelData;if(!n||!n.allDestinations)return void w(`[${this.getTitle()}] Travel data not found in SERVER_DATA`);if(!n.allDestinations.countries)return void w(`[${this.getTitle()}] Countries data not found in travel data`);const i=this.container?.querySelector(".ptnpnh-travel-distance-content");if(!i)return void w(`[${this.getTitle()}] Content element not found in container`);i.textContent="";if(n.travelRequired){const t=n.invader?.id,e=n.defender?.id;if(!t||!e)return void w(`[${this.getTitle()}] Invader or defender ID not found in travel data`);const a=this.findNearestRegion(t,n.allDestinations.regions),s=this.findNearestRegion(e,n.allDestinations.regions);if(!a&&!s)return void w(`[${this.getTitle()}] No regions found for either side`);const o=(t,e)=>{const n=document.createElement("div");return n.classList.add("ptnpnh-travel-option"),n.textContent=`${e}: ${t.name}, ${t.distanceInKm}km, ${t.cost}cc`,n.addEventListener("click",(()=>{this.travelTo(t.countryId,t.id)})),n};if(a){const e=n.allDestinations.countries[t.toString()]?.name||"Invader";i.appendChild(o(a,e)),v(`[${this.getTitle()}] Displayed nearest invader region: ${a.name}`)}if(s){const t=n.allDestinations.countries[e.toString()]?.name||"Defender";i.appendChild(o(s,t)),v(`[${this.getTitle()}] Displayed nearest defender region: ${s.name}`)}}else{const t=n.sideCountryId||e,a=this.getOpponentCountryId(t,n);if(!a)return void w(`[${this.getTitle()}] Could not determine opponent country ID`);const s=this.findNearestRegion(a,n.allDestinations.regions);if(!s)return void w(`[${this.getTitle()}] No opponent regions found`);const o=`${n.allDestinations.countries[a.toString()]?.name||"Opponent"}: ${s.name}, ${s.distanceInKm}km, ${s.cost}cc`,r=document.createElement("div");r.classList.add("ptnpnh-travel-option"),r.textContent=o,r.addEventListener("click",(()=>{this.travelTo(s.countryId,s.id)})),i.appendChild(r),v(`[${this.getTitle()}] Displayed nearest region: ${o}`)}}catch(t){w(`[${this.getTitle()}] Error displaying nearest region: ${t}`)}}getOpponentCountryId(t,e){if(e.invader&&e.defender){const n=e.defender.id??null,i=e.invader.id??null;return null===n||null===i?null:i===t?n:i}const n=e.allDestinations?.countries;if(!n)return null;return Object.keys(n).map((t=>parseInt(t))).find((e=>e!==t))||null}findNearestRegion(t,e){if(!e)return null;let n=null,i=Number.MAX_VALUE;return Object.values(e).forEach((e=>{e.countryId===t&&e.distanceInKm<i&&(i=e.distanceInKm,n=e)})),n}getUrlInfo(){const t=window.location.pathname.match(/\/([a-z]{2})\/military\/battlefield\/(\d{1,7})(?:\/(\d+))?(?:\/|$)/i);if(!t)return null;const e=t[3]||void 0;return{lang:t[1],battleId:t[2],battleZoneId:e}}async travelTo(t,e){try{const n=this.getUrlInfo();if(!n)return void w(`[${this.getTitle()}] Failed to parse language and battle ID from URL`);const i=C();if(!i)return void w(`[${this.getTitle()}] CSRF token not found`);const a=E(),s=n.battleZoneId||String(a?.selectedBattleZoneId||""),o=new URLSearchParams;o.append("_token",i),o.append("battleId",n.battleId),s&&o.append("battleZoneId",s),o.append("sideCountryId",String(t)),o.append("toCountryId",String(t)),o.append("inRegionId",String(e));const r=`https://www.erepublik.com/${n.lang}/main/battlefieldTravel`,l=await fetch(r,{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"},body:o.toString(),credentials:"include",mode:"cors"});if(!l.ok)return void w(`[${this.getTitle()}] Travel request failed with status ${l.status}`);let d=null;try{d=await l.json()}catch{}v(`[${this.getTitle()}] Travel request completed${d?`: ${JSON.stringify(d)}`:""}`),window.location.reload()}catch(t){w(`[${this.getTitle()}] Error executing travel: ${t}`)}}hideTravelDistance(){this.container&&(this.container.remove(),this.container=null,v(`[${this.getTitle()}] Travel distance display removed`))}}var at=n(688),st={};st.styleTagTransform=g(),st.setAttributes=c(),st.insert=l().bind(null,"head"),st.domAPI=o(),st.insertStyleElement=p();a()(at.A,st);at.A&&at.A.locals&&at.A.locals;class ot extends T{constructor(t){super("display-campaign-start-date","Display Campaign Start Date",t,!0),this.container=null,this.isEnabled()&&this.showCampaignStartDate()}isBattlefieldPage(){return null!==window.location.href.match(/\/military\/battlefield\/\d+/i)}onStateChanged(){this.isEnabled()?this.showCampaignStartDate():this.hideCampaignStartDate()}showCampaignStartDate(){try{if(!this.isBattlefieldPage())return void v(`[${this.getTitle()}] Not on a battlefield page, skipping`);if(this.container)return;const t=document.getElementById("battle_countdown");if(!t)return void w(`[${this.getTitle()}] Battle countdown element not found`);this.container=document.createElement("div"),this.container.id="ptnpnh-campaign-start-date",this.container.innerHTML='<div class="ptnpnh-campaign-start-date-container">\n  <div class="ptnpnh-campaign-start-date-body">\n    <p class="ptnpnh-campaign-start-date-content"></p>\n  </div>\n</div>',t.parentNode?.insertBefore(this.container,t),this.displayCampaignStartDate(),v(`[${this.getTitle()}] Campaign start date display initialized`)}catch(t){w(`[${this.getTitle()}] Error showing campaign start date: ${t}`)}}displayCampaignStartDate(){try{const t=E();if(!t)return void w(`[${this.getTitle()}] SERVER_DATA not found on window object`);if(!t.rounds||0===Object.keys(t.rounds).length)return void w(`[${this.getTitle()}] Rounds data not found in SERVER_DATA`);const e=Object.values(t.rounds)[0]?.created_at;if(!e)return void w(`[${this.getTitle()}] Created_at timestamp not found in first round`);const n=new Date(1e3*e),i=this.formatDate(n),a=this.container?.querySelector(".ptnpnh-campaign-start-date-content");a?(a.textContent=`Campaign started: ${i}`,v(`[${this.getTitle()}] Displayed campaign start date: ${i}`)):w(`[${this.getTitle()}] Content element not found in container`)}catch(t){w(`[${this.getTitle()}] Error displaying campaign start date: ${t}`)}}formatDate(t){const e=t=>t.toString().padStart(2,"0");return`${e(t.getDate())}-${e(t.getMonth()+1)}-${t.getFullYear()} ${e(t.getHours())}:${e(t.getMinutes())}:${e(t.getSeconds())}`}hideCampaignStartDate(){try{this.container&&(this.container.remove(),this.container=null,v(`[${this.getTitle()}] Campaign start date display removed`))}catch(t){w(`[${this.getTitle()}] Error hiding campaign start date: ${t}`)}}}var rt=n(247),lt={};lt.styleTagTransform=g(),lt.setAttributes=c(),lt.insert=l().bind(null,"head"),lt.domAPI=o(),lt.insertStyleElement=p();a()(rt.A,lt);rt.A&&rt.A.locals&&rt.A.locals;class dt extends T{constructor(t,e){super("daily-tasks","Daily Tasks",t,!0),this.taskContainer=null,this.runningTasks=!1,this.selectedTasks={work:!0,overtime:!0,train:!0,buyFood:!0,buyGold:!0,vip:!0},this.eClient=e,this.loadSelectedTasks(),this.isEnabled()&&this.showDailyTasks()}onStateChanged(){this.isEnabled()?this.showDailyTasks():this.hideDailyTasks()}showDailyTasks(){try{const t=D();if(!t)return;this.taskContainer||(this.taskContainer=document.createElement("div"),this.taskContainer.id="ptnpnh-daily-tasks-container",this.taskContainer.className="ptnpnh-daily-tasks-container collapsed",this.taskContainer.innerHTML='<div class="ptnpnh-daily-tasks-container">\n  <div class="ptnpnh-daily-tasks-header">Daily Tasks <span class="ptnpnh-daily-tasks-toggle-icon">▼</span></div>\n  <div class="ptnpnh-daily-tasks-content">\n    <div class="ptnpnh-daily-tasks-status">\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-work">\n        <span class="ptnpnh-daily-tasks-icon">💼</span>\n        <span class="ptnpnh-daily-tasks-label">Work</span>\n        <input type="checkbox" id="ptnpnh-daily-task-work-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-work-status">⏳</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-overtime">\n        <span class="ptnpnh-daily-tasks-icon">⏱️</span>\n        <span class="ptnpnh-daily-tasks-label">Overtime</span>\n        <input type="checkbox" id="ptnpnh-daily-task-overtime-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-overtime-status">⏳</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-train">\n        <span class="ptnpnh-daily-tasks-icon">💪</span>\n        <span class="ptnpnh-daily-tasks-label">Train</span>\n        <input type="checkbox" id="ptnpnh-daily-task-train-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-train-status">⏳</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-buy-food">\n        <span class="ptnpnh-daily-tasks-icon">🍔</span>\n        <span class="ptnpnh-daily-tasks-label">Buy Food</span>\n        <input type="checkbox" id="ptnpnh-daily-task-buy-food-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-buy-food-status">⏳</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-buy-gold">\n        <span class="ptnpnh-daily-tasks-icon">🪙</span>\n        <span class="ptnpnh-daily-tasks-label">Buy Gold</span>\n        <input type="checkbox" id="ptnpnh-daily-task-buy-gold-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-buy-gold-status">⏳</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-vip">\n        <span class="ptnpnh-daily-tasks-icon">🌟</span>\n        <span class="ptnpnh-daily-tasks-label">VIP Points</span>\n        <input type="checkbox" id="ptnpnh-daily-task-vip-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-vip-status">⏳</span>\n      </div>\n    </div>\n    <div class="ptnpnh-daily-tasks-actions">\n      <button class="ptnpnh-daily-tasks-button" id="ptnpnh-daily-tasks-run-all">Run Tasks</button>\n    </div>\n  </div>\n</div>\n'),document.getElementById("ptnpnh-daily-tasks-container")||t.appendChild(this.taskContainer)}catch(t){return void w("Error showing daily tasks",t)}const t=document.querySelector(".ptnpnh-daily-tasks-header");t&&t.addEventListener("click",(()=>{this.taskContainer?.classList.toggle("collapsed")}));const e=document.getElementById("ptnpnh-daily-tasks-run-all");e&&e.addEventListener("click",(()=>this.runAllTasks())),this.setupCheckboxListeners()}hideDailyTasks(){this.taskContainer&&(this.taskContainer.remove(),this.taskContainer=null)}loadSelectedTasks(){const t=this.settingsStorage.configFor(this.getId());t&&t.selectedTasks&&(this.selectedTasks=t.selectedTasks)}saveSelectedTasks(){const t=this.settingsStorage.configFor(this.getId())||{};t.selectedTasks=this.selectedTasks,this.settingsStorage.save(this.getId(),t)}setupCheckboxListeners(){Object.entries({"ptnpnh-daily-task-work-checkbox":"work","ptnpnh-daily-task-overtime-checkbox":"overtime","ptnpnh-daily-task-train-checkbox":"train","ptnpnh-daily-task-buy-food-checkbox":"buyFood","ptnpnh-daily-task-buy-gold-checkbox":"buyGold","ptnpnh-daily-task-vip-checkbox":"vip"}).forEach((([t,e])=>{const n=document.getElementById(t);n&&(n.checked=this.selectedTasks[e],n.addEventListener("change",(()=>{this.selectedTasks[e]=n.checked,this.saveSelectedTasks()})))}))}async runAllTasks(){if(this.runningTasks)this.showNotification("Tasks are already running","error");else{this.runningTasks=!0,Object.entries(this.selectedTasks).forEach((([t,e])=>{if(e){const e="buyFood"===t?"buy-food":"buyGold"===t?"buy-gold":t;this.updateTaskStatus(e,"⏳")}}));try{this.selectedTasks.work&&(await this.work(),await this.delay(2e3)),this.selectedTasks.overtime&&(await this.workOvertime(),await this.delay(2e3)),this.selectedTasks.train&&(await this.train(),await this.delay(2e3)),this.selectedTasks.buyFood&&(await this.buyFood(),await this.delay(2e3)),this.selectedTasks.buyGold&&(await this.buyGold(),await this.delay(2e3)),this.selectedTasks.vip&&await this.claimVIPPoints(),this.showNotification("Selected daily tasks completed!","success")}catch(t){w("Error running daily tasks",t),this.showNotification("Error running daily tasks","error")}finally{this.runningTasks=!1}}}async work(){this.updateTaskStatus("work","⏳");try{const t=await this.eClient.fetchJobData();if(!t.isEmployee)return this.updateTaskStatus("work","❌"),void this.showNotification("You don't have a job","error");if(t.alreadyWorked)return this.updateTaskStatus("work","✅"),void this.showNotification("You already worked today","success");const e=await this.eClient.performWork();e.status?(this.updateTaskStatus("work","✅"),this.showNotification(`Worked for ${e.result.netSalary} ${e.result.currency}`,"success")):(this.updateTaskStatus("work","❌"),this.showNotification("Failed to work","error"))}catch(t){w("Error working",t),this.updateTaskStatus("work","❌"),this.showNotification("Error working","error")}}async workOvertime(){this.updateTaskStatus("overtime","⏳");try{const t=await this.eClient.fetchJobData();if(!t.isEmployee)return this.updateTaskStatus("overtime","❌"),void this.showNotification("You don't have a job","error");if(0!==t.overTime.nextOverTime)return this.updateTaskStatus("overtime","✅"),void this.showNotification("You already worked overtime today","success");const e=await this.eClient.performWorkOvertime();e.status?(this.updateTaskStatus("overtime","✅"),this.showNotification(`Worked overtime for ${e.result.netSalary} ${e.result.currency}`,"success")):(this.updateTaskStatus("overtime","❌"),this.showNotification("Failed to work overtime","error"))}catch(t){w("Error working overtime",t),this.updateTaskStatus("overtime","❌"),this.showNotification("Error working overtime","error")}}async train(){this.updateTaskStatus("train","⏳");try{const t=await this.eClient.fetchTrainingData();if(!t.can_train)return this.updateTaskStatus("train","❌"),void this.showNotification("You can't train right now","error");const e=t.grounds.map((t=>t.id)),n=await this.eClient.performTraining(e);n.status?(this.updateTaskStatus("train","✅"),this.showNotification(`Trained for ${n.result.strength_bonus} strength points`,"success")):(this.updateTaskStatus("train","❌"),this.showNotification("Failed to train","error"))}catch(t){w("Error training",t),this.updateTaskStatus("train","❌"),this.showNotification("Error training","error")}}async buyFood(){this.updateTaskStatus("buy-food","⏳");try{const t=this.getCitizenshipCountryId();if(!t)return this.updateTaskStatus("buy-food","❌"),void this.showNotification("Failed to get citizenship country ID","error");const e=await this.eClient.fetchFoodOffers(t);if(!e.can_buy||0===e.offers.length)return this.updateTaskStatus("buy-food","❌"),void this.showNotification("No food offers available","error");const n=e.offers[0],i=await this.eClient.buyFoodItem(n.id);i.error?(this.updateTaskStatus("buy-food","❌"),this.showNotification("Failed to buy food","error")):(this.updateTaskStatus("buy-food","✅"),this.showNotification(i.message,"success"))}catch(t){w("Error buying food",t),this.updateTaskStatus("buy-food","❌"),this.showNotification("Error buying food","error")}}async buyGold(){this.updateTaskStatus("buy-gold","⏳");let t=0,e=!1;for(;t<5&&!e;){t++;try{const n=await this.eClient.fetchGoldOffersHtml(),i=this.parseGoldOfferIdFromHtml(n);if(!i){5===t?(this.updateTaskStatus("buy-gold","❌"),this.showNotification("No gold offers available after multiple attempts","error")):(this.showNotification(`No gold offers available, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3));continue}const a=await this.eClient.buyGoldOffer(i);if(a.error){if(a.message&&a.message.includes("You already reached the maximum limit"))return this.updateTaskStatus("buy-gold","✅"),void this.showNotification(a.message,"warning");if(!a.message||!a.message.includes("You cannot buy more than the offered amount")&&!a.message.includes("This exchange offer does not exist"))return this.updateTaskStatus("buy-gold","❌"),void this.showNotification(`Failed to buy gold: ${a.message}`,"error");5===t?(this.updateTaskStatus("buy-gold","❌"),this.showNotification(`Failed to buy gold after 5 attempts: ${a.message}`,"error")):(this.showNotification(`${a.message}, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3))}else e=!0,this.updateTaskStatus("buy-gold","✅"),this.showNotification(a.message,"success")}catch(e){w(`Error buying gold (attempt ${t}/5)`,e),5===t?(this.updateTaskStatus("buy-gold","❌"),this.showNotification("Error buying gold after multiple attempts","error")):(this.showNotification(`Error buying gold, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3))}}}async claimVIPPoints(){this.updateTaskStatus("vip","⏳");try{const t=await this.eClient.claimVIP();!1===t.can_claim&&t.today_points>0?(this.updateTaskStatus("vip","✅"),this.showNotification(`Already claimed ${t.today_points} VIP points today`,"success")):!1===t.can_claim?(this.updateTaskStatus("vip","❌"),this.showNotification("No VIP points to claim","error")):(this.updateTaskStatus("vip","✅"),this.showNotification(`Claimed ${t.today_points} VIP points`,"success"))}catch(t){w("Error claiming VIP points",t),this.updateTaskStatus("vip","❌"),this.showNotification("Error claiming VIP points","error")}}getCitizenshipCountryId(){try{return erepublik.citizen.citizenshipCountryId||null}catch(t){return w("Failed to get citizenship country ID",t),null}}parseGoldOfferIdFromHtml(t){try{const e=new DOMParser,n=e.parseFromString(t,"text/html").querySelectorAll(".exchange_offers tr");for(const t of n){const e=t.querySelector(".ex_amount strong span");if(e){if(parseFloat(e.textContent||"0")>=10){const e=t.querySelector('button[id^="purchase_"]');if(e){const t=e.getAttribute("id"),n=t?.match(/^purchase_(\d+)$/);if(n&&n[1])return n[1]}}}}return null}catch(t){return w("Error parsing gold offers HTML",t),null}}updateTaskStatus(t,e){const n=document.getElementById(`ptnpnh-daily-task-${t}-status`);n&&(n.textContent=e,n.classList.remove("ptnpnh-daily-tasks-success","ptnpnh-daily-tasks-error","ptnpnh-daily-tasks-pending"),"✅"===e?n.classList.add("ptnpnh-daily-tasks-success"):"❌"===e?n.classList.add("ptnpnh-daily-tasks-error"):n.classList.add("ptnpnh-daily-tasks-pending"))}updateAllTaskStatus(t){this.selectedTasks.work&&this.updateTaskStatus("work",t),this.selectedTasks.overtime&&this.updateTaskStatus("overtime",t),this.selectedTasks.train&&this.updateTaskStatus("train",t),this.selectedTasks.buyFood&&this.updateTaskStatus("buy-food",t),this.selectedTasks.buyGold&&this.updateTaskStatus("buy-gold",t),this.selectedTasks.vip&&this.updateTaskStatus("vip",t)}showNotification(t,e="info"){let n=document.getElementById("ptnpnh-notification-container");n||(n=document.createElement("div"),n.id="ptnpnh-notification-container",document.body.appendChild(n));const i=document.createElement("div");i.className=`ptnpnh-notification ptnpnh-notification-${e}`,i.textContent=t,n.appendChild(i),setTimeout((()=>{i.remove(),n&&0===n.children.length&&n.remove()}),15e3),"error"===e?w(t):v("warning"===e?`WARNING: ${t}`:t)}delay(t){return new Promise((e=>setTimeout(e,t)))}}var ct=n(517),ht={};ht.styleTagTransform=g(),ht.setAttributes=c(),ht.insert=l().bind(null,"head"),ht.domAPI=o(),ht.insertStyleElement=p();a()(ct.A,ht);ct.A&&ct.A.locals&&ct.A.locals;class pt extends T{constructor(t,e){super("collect-rewards","Collect rewards",t,!0),this.container=null,this.collectButton=null,this.eClient=e,this.isEnabled()&&(this.showCollectRewards(),this.collectRewards())}onStateChanged(){this.isEnabled()?this.showCollectRewards():this.hideCollectRewards()}showCollectRewards(){try{const t=D();if(!t)return;const e=document.getElementById("ptnpnh-collect-rewards-container");e&&!this.container&&e.remove(),document.getElementById("ptnpnh-collect-rewards-container")?this.collectButton||(this.collectButton=document.getElementById("ptnpnh-collect-rewards-collect-rewards"),this.collectButton&&this.collectButton.addEventListener("click",(()=>{this.collectRewards()}))):(this.container=document.createElement("div"),this.container.id="ptnpnh-collect-rewards-container",this.container.innerHTML='<button class="ptnpnh-collect-rewards-button" id="ptnpnh-collect-rewards-collect-rewards">Collect Rewards</button>\n',t.appendChild(this.container),this.collectButton=document.getElementById("ptnpnh-collect-rewards-collect-rewards"),this.collectButton&&this.collectButton.addEventListener("click",(()=>{this.collectRewards()})))}catch(t){w("Failed to show collect rewards",t)}}hideCollectRewards(){const t=document.getElementById("ptnpnh-collect-rewards-container");t&&t.remove(),this.container=null,this.collectButton=null}async collectRewards(){if(this.collectButton)try{this.collectButton.setAttribute("disabled","true"),this.updateMessage("Checking daily missions...","pending"),await this.processDailyRewards(),await this.processWeeklyRewards()}catch(t){w("Error collecting rewards",t),this.updateMessage("Error collecting rewards","error")}finally{this.collectButton.removeAttribute("disabled")}}async processDailyRewards(){if(!this.collectButton)return;const t=await this.eClient.fetchDailyMissionsData();if(!t||!t.missions||!Array.isArray(t.missions))return this.updateMessage("Failed to fetch daily missions data.","error"),void this.collectButton.removeAttribute("disabled");const e=t.missions.filter((t=>t.progress&&t.progress.length>0&&t.progress[0].completed));if(0===e.length)return this.updateMessage("No completed missions found.","info"),void this.collectButton.removeAttribute("disabled");this.updateMessage(`Found ${e.length} completed missions. Collecting...`,"pending");for(const t of e)await this.eClient.solveMission(t.id),await this.delay(pt.SOLVE_MISSIONS_DELAY_MS);this.updateMessage("Checking for extra rewards...","pending");const n=await this.eClient.fetchObjectiveStatus();if(!n||!n.status||!n.data)return this.updateMessage("Failed to fetch objective status.","error"),void this.collectButton.removeAttribute("disabled");const{progress:i,claimedObjectives:a}=n.status,s=Object.entries(n.data).filter((([t])=>parseInt(t,10)<=i&&(!a||!a[t]))).map((([t])=>parseInt(t,10)));if(0===s.length)return this.updateMessage("All rewards collected!","success"),void this.collectButton.removeAttribute("disabled");this.updateMessage(`Found ${s.length} extra rewards. Claiming...`,"pending");for(const t of s)await this.eClient.claimObjectiveReward(t),await this.delay(pt.COLLECT_REWARDS_DELAY_MS)}async processWeeklyRewards(){if(!this.collectButton)return;this.updateMessage("Checking weekly rewards...","pending");const t=await this.eClient.fetchWeeklyChallengeData();if(!t||t.error||!t.rewards||!t.rewards.normal)return this.updateMessage("Failed to fetch weekly rewards data.","error"),void this.collectButton.removeAttribute("disabled");const e=t.rewards.normal.filter((t=>"completed"===t.status));if(0===e.length)return this.updateMessage("No completed weekly rewards found. All rewards collected!","success"),this.delay(pt.SOLVE_MISSIONS_DELAY_MS),this.updateMessage("Collect Rewards","success"),void this.collectButton.removeAttribute("disabled");const n=Math.max(...e.map((t=>t.id)));this.updateMessage(`Found ${e.length} weekly rewards. Collecting...`,"pending");await this.eClient.collectWeeklyRewards(n)?this.updateMessage("All rewards collected!","success"):this.updateMessage("Daily rewards collected, but weekly rewards collection failed.","error")}updateMessage(t,e="info"){this.collectButton&&(this.collectButton.hasAttribute("data-original-text")||this.collectButton.setAttribute("data-original-text","Collect Rewards"),this.collectButton.textContent="info"===e?this.collectButton.getAttribute("data-original-text")||"Collect Rewards":t,this.collectButton.style.backgroundColor="success"===e?"#a5d1e5":"error"===e?"#ffcccc":"pending"===e?"#ffffcc":"#c8e3ef",v(`Collect rewards: ${t}`))}delay(t){return new Promise((e=>setTimeout(e,t)))}}pt.COLLECT_REWARDS_DELAY_MS=400,pt.SOLVE_MISSIONS_DELAY_MS=400;var ut=n(970),gt={};gt.styleTagTransform=g(),gt.setAttributes=c(),gt.insert=l().bind(null,"head"),gt.domAPI=o(),gt.insertStyleElement=p();a()(ut.A,gt);ut.A&&ut.A.locals&&ut.A.locals;class ft extends T{constructor(t){super("display-division-switcher","Display Division Switcher",t,!0),this.container=null,this.isEnabled()&&this.init()}isBattlefieldPage(){return/\/([a-z]{2})\/military\/battlefield\/(\d{1,7})(?:\/|$)/i.test(window.location.pathname)}onStateChanged(){this.isEnabled()?this.init():this.destroy()}init(){try{if(!this.isBattlefieldPage())return void v(`[${this.getTitle()}] Not on a battlefield page, skipping`);if(this.container)return;const t=document.getElementById("pvp");if(!t)return void w(`[${this.getTitle()}] #pvp element not found`);this.container=document.createElement("div"),this.container.id="ptnpnh-division-switcher",this.container.innerHTML='<div class="ptnpnh-division-switcher-container">\n  <div class="ptnpnh-division-switcher-body">\n    <div class="ptnpnh-division-switcher-buttons"></div>\n  </div>\n</div>\n',t.appendChild(this.container),this.renderButtons(),v(`[${this.getTitle()}] Division switcher initialized`)}catch(t){w(`[${this.getTitle()}] Error initializing: ${t}`)}}destroy(){this.container&&this.container.parentElement&&this.container.parentElement.removeChild(this.container),this.container=null}getLangAndBattleId(){const t=window.location.pathname.match(/\/([a-z]{2})\/military\/battlefield\/(\d{1,7})(?:\/|$)/i);return t?{lang:t[1],battleId:t[2]}:null}toRoman(t){switch(t){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV";case 11:return"XI";default:return String(t)}}renderButtons(){try{if(!this.container)return;const t=this.container.querySelector(".ptnpnh-division-switcher-buttons");if(!t)return void w(`[${this.getTitle()}] Buttons wrapper not found in template`);t.textContent="";const e=E(),n=e?.activeBattleZones;if(!n||"object"!=typeof n)return void w(`[${this.getTitle()}] activeBattleZones not found in SERVER_DATA`);const i=this.getLangAndBattleId();if(!i)return void w(`[${this.getTitle()}] Failed to parse language and battle ID from URL`);const a=Object.keys(n);if(0===a.length)return void w(`[${this.getTitle()}] No battle zones found`);a.forEach((a=>{const s=n[a];if(!s||"number"!=typeof s.battleZoneId||"number"!=typeof s.division)return;const o=document.createElement("button");o.className="ptnpnh-division-switcher-button";e.battleZoneId===s.battleZoneId&&o.classList.add("ptnpnh-division-switcher-button-current"),o.type="button",o.textContent=this.toRoman(s.division),o.addEventListener("click",(()=>{const t=`https://www.erepublik.com/${i.lang}/military/battlefield/${i.battleId}/${s.battleZoneId}`;window.location.href=t})),t.appendChild(o)}))}catch(t){w(`[${this.getTitle()}] Error rendering buttons: ${t}`)}}}var mt=n(308),bt={};bt.styleTagTransform=g(),bt.setAttributes=c(),bt.insert=l().bind(null,"head"),bt.domAPI=o(),bt.insertStyleElement=p();a()(mt.A,bt);mt.A&&mt.A.locals&&mt.A.locals;class yt extends T{constructor(t,e){super("auto-farmer","Auto Farmer",t,!0),this.container=null,this.weaponSelect=null,this.startButton=null,this.statusElement=null,this.isRunning=!1,this.selectedWeapon=-1,this.eClient=e,this.loadWeaponPreference(),this.isEnabled()&&this.showAutoFarmer()}onStateChanged(){this.isEnabled()?this.showAutoFarmer():this.hideAutoFarmer()}isBattlefieldPage(){return/\/military\/battlefield\/\d+/i.test(window.location.pathname)}loadWeaponPreference(){const t=this.settingsStorage.configFor(this.getId());t&&"number"==typeof t.weapon&&(this.selectedWeapon=t.weapon)}saveWeaponPreference(){this.settingsStorage.save(this.getId(),{weapon:this.selectedWeapon})}showAutoFarmer(){try{if(!this.isBattlefieldPage())return void v(`[${this.getTitle()}] Not on a battlefield page, skipping`);if(this.container)return;if(this.container=document.createElement("div"),this.container.id="ptnpnh-auto-farmer",this.container.innerHTML='<div class="ptnpnh-auto-farmer-container">\n  <div class="ptnpnh-auto-farmer-controls">\n    <select class="ptnpnh-auto-farmer-weapon-select" id="ptnpnh-auto-farmer-weapon-select">\n      <option value="-1" selected>No Weapon</option>\n      <option value="1">Q1 Weapon</option>\n      <option value="7">Q7 Weapon</option>\n      <option value="10">Bazooka</option>\n      <option value="212">Small Bomb</option>\n      <option value="22">Big Bomb</option>\n    </select>\n    <button class="ptnpnh-auto-farmer-button" id="ptnpnh-auto-farmer-start-button">Farm</button>\n  </div>\n  <div class="ptnpnh-auto-farmer-status" id="ptnpnh-auto-farmer-status"></div>\n</div>\n',this.weaponSelect=this.container.querySelector("#ptnpnh-auto-farmer-weapon-select"),this.startButton=this.container.querySelector("#ptnpnh-auto-farmer-start-button"),this.statusElement=this.container.querySelector("#ptnpnh-auto-farmer-status"),!this.weaponSelect||!this.startButton||!this.statusElement)return void w(`[${this.getTitle()}] Failed to find UI elements`);this.weaponSelect.value=this.selectedWeapon.toString(),this.weaponSelect.addEventListener("change",(()=>{this.selectedWeapon=parseInt(this.weaponSelect.value,10),this.saveWeaponPreference()})),this.startButton.addEventListener("click",(()=>{this.startAutoFarm()}));const t=document.getElementById("pvp");t?(t.appendChild(this.container),v(`[${this.getTitle()}] Auto farmer initialized`)):w(`[${this.getTitle()}] PVP container not found`)}catch(t){w(`[${this.getTitle()}] Error showing auto farmer: ${t}`)}}hideAutoFarmer(){this.container&&(this.container.remove(),this.container=null,this.weaponSelect=null,this.startButton=null,this.statusElement=null,v(`[${this.getTitle()}] Auto farmer removed`))}updateStatus(t,e="info"){this.statusElement&&(this.statusElement.textContent=t,this.statusElement.className=`ptnpnh-auto-farmer-status ${e}`),v(`[${this.getTitle()}] ${t}`)}async startAutoFarm(){if(!this.isRunning){this.isRunning=!0,this.startButton&&(this.startButton.disabled=!0);try{const t=E();if(!t)throw new Error("Cannot access battle data");this.updateStatus("Starting auto farm...","info");const e=t.travel?.travelData;if(!e)throw new Error("Travel data not found");if(!1===e.travelRequired&&null!==e.sideCountryId&&void 0!==e.sideCountryId){this.updateStatus("Deploying on current side...","info");const n=await this.getActiveSkinId(t,e.sideCountryId);await this.delay(1e3),await this.deploy(t,n);const i=t.mySideCountryId===t.realInvaderId,a=i?t.realDefenderId:t.realInvaderId,s=i?e.defender:e.invader;if(!a||!s?.toCountryId||!s?.inRegionId)throw new Error("Target travel data not found");await this.delay(2e3),this.updateStatus("Traveling to opposite side...","info"),await this.travel(t,a,s.toCountryId,s.inRegionId),await this.delay(1e3);const o=await this.getActiveSkinId(t,a);await this.delay(1e3),this.updateStatus("Deploying on opposite side...","info"),await this.deploy(t,o)}else if(!0===e.travelRequired&&null===e.sideCountryId){if(!t.realDefenderId||!t.realInvaderId)throw new Error("Defender or invader ID not found");if(!e.defender?.toCountryId||!e.defender?.inRegionId)throw new Error("Defender travel data not found");if(!e.invader?.toCountryId||!e.invader?.inRegionId)throw new Error("Invader travel data not found");this.updateStatus("Traveling to defender side...","info"),await this.travel(t,t.realDefenderId,e.defender.toCountryId,e.defender.inRegionId),await this.delay(1e3);const n=await this.getActiveSkinId(t,t.realDefenderId);await this.delay(1e3),this.updateStatus("Deploying on defender side...","info"),await this.deploy(t,n),await this.delay(2e3),this.updateStatus("Traveling to invader side...","info"),await this.travel(t,t.realInvaderId,e.invader.toCountryId,e.invader.inRegionId),await this.delay(1e3);const i=await this.getActiveSkinId(t,t.realInvaderId);await this.delay(2e3),this.updateStatus("Deploying on invader side...","info"),await this.deploy(t,i)}this.updateStatus("Auto farm completed successfully!","success")}catch(t){w(`[${this.getTitle()}] Auto farm failed: ${t}`),this.updateStatus(`Error: ${t instanceof Error?t.message:String(t)}`,"error")}finally{this.isRunning=!1,this.startButton&&(this.startButton.disabled=!1)}}}async getActiveSkinId(t,e){v(`[${this.getTitle()}] Getting active vehicle...`);const n=C();if(!n)throw new Error("CSRF token not found");const i=new URLSearchParams;i.append("_token",n),i.append("battleId",t.battleId.toString()),i.append("battleZoneId",t.battleZoneId.toString()),i.append("sideCountryId",e.toString());const a=await fetch("https://www.erepublik.com/en/military/fightDeploy-getInventory",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/plain, */*","X-Requested-With":"XMLHttpRequest"},body:i.toString(),credentials:"include"});if(!a.ok)throw new Error(`Failed to get inventory with status: ${a.status}`);const s=await a.json(),o=s.vehicles?.find((t=>t.isActive));if(!o)throw new Error("No active vehicle found");return v(`[${this.getTitle()}] Active vehicle ID: ${o.id}`),o.id}async deploy(t,e){v(`[${this.getTitle()}] Deploying with weapon: ${this.selectedWeapon}`);if(!C())throw new Error("CSRF token not found");const n=t.travel?.travelData;if(!n)throw new Error("Travel data not found");const i=this.selectedWeapon,a=n.sideCountryId||t.mySideCountryId;if(!a)throw new Error("Side country ID not found");if(22===i||212===i){const e=await this.eClient.deployBomb(t.battleId,t.battleZoneId,a,a,i);if(e.error)throw new Error(e.message||"Bomb deploy failed");v(`[${this.getTitle()}] Bomb deployed: ${e.message}`)}else{const n=10===i?11:44,s=10,o=300;for(let r=1;r<=s;r++)try{const s=await this.eClient.deployGroundWeapon(t.battleId,t.battleZoneId,a,i,n,e);if(s.error)throw new Error(s.message||"Deploy failed");return void v(`[${this.getTitle()}] Deploy successful: ${s.message}`)}catch(t){if(w(`[${this.getTitle()}] Deploy attempt ${r}/${s} failed: ${t}`),r===s)throw new Error(`Deploy failed after ${s} attempts`);await this.delay(o)}}}async travel(t,e,n,i){const a=e===t.realDefenderId;v(`[${this.getTitle()}] Traveling to ${a?"defender":"invader"} side...`);const s=C();if(!s)throw new Error("CSRF token not found");const o=new URLSearchParams;o.append("_token",s),o.append("battleId",t.battleId.toString()),o.append("battleZoneId",t.battleZoneId.toString()),o.append("sideCountryId",e.toString()),o.append("toCountryId",n.toString()),o.append("toRegionId",i.toString());const r=await fetch("https://www.erepublik.com/en/main/battlefieldTravel",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json, text/plain, */*","X-Requested-With":"XMLHttpRequest"},body:o.toString(),credentials:"include"});if(!r.ok)throw new Error(`Travel failed with status: ${r.status}`);const l=await r.json();if(l.error)throw new Error(`Travel error: ${l.message||"Unknown error"}`);v(`[${this.getTitle()}] Travel successful!`),t.travel?.travelData&&(t.travel.travelData.sideCountryId=e)}delay(t){return new Promise((e=>setTimeout(e,t)))}}var vt=n(457),wt={};wt.styleTagTransform=g(),wt.setAttributes=c(),wt.insert=l().bind(null,"head"),wt.domAPI=o(),wt.insertStyleElement=p();a()(vt.A,wt);vt.A&&vt.A.locals&&vt.A.locals;class xt extends T{constructor(t){super("container-max-height","Container Max Height",t,!1);const e=this.settingsStorage.configFor(this.getId());this.currentMaxHeight=e?.maxHeightPx??xt.DEFAULT_MAX_HEIGHT,this.isEnabled()&&this.applyMaxHeight()}hasConfigurationUI(){return!0}createConfigurationUI(t){const e=document.createElement("div");e.className="ptnpnh-config-container ptnpnh-config-container-horizontal";const n=document.createElement("label");n.className="ptnpnh-config-label",n.htmlFor=`ptnpnh-max-height-input-${this.getId()}`,n.textContent="Container max-height (px):";const i=document.createElement("input");return i.type="number",i.id=`ptnpnh-max-height-input-${this.getId()}`,i.className="ptnpnh-config-input",i.min="100",i.max="4000",i.step="10",i.value=this.currentMaxHeight.toString(),i.addEventListener("change",(()=>{const t=parseInt(i.value,10);if(!isNaN(t)){const e=Math.max(100,Math.min(4e3,t));i.value=e.toString(),this.setMaxHeight(e)}})),e.appendChild(n),e.appendChild(i),t.appendChild(e),!0}execute(){this.isEnabled()&&this.applyMaxHeight()}onStateChanged(){this.isEnabled()?this.applyMaxHeight():this.clearMaxHeight()}setMaxHeight(t){this.currentMaxHeight=t,this.settingsStorage.save(this.getId(),{maxHeightPx:this.currentMaxHeight}),this.isEnabled()&&this.applyMaxHeight()}applyMaxHeight(){try{const t=D();if(!t)return;t.style.maxHeight=`${this.currentMaxHeight}px`,v(`Applied container max-height: ${this.currentMaxHeight}px`)}catch(t){w("Failed to apply container max-height",t)}}clearMaxHeight(){try{const t=document.getElementById("erepa_container");if(!t)return;t.style.maxHeight="",v("Cleared container max-height override")}catch(t){w("Failed to clear container max-height",t)}}}xt.DEFAULT_MAX_HEIGHT=350;var Et=n(823),Ct={};Ct.styleTagTransform=g(),Ct.setAttributes=c(),Ct.insert=l().bind(null,"head"),Ct.domAPI=o(),Ct.insertStyleElement=p();a()(Et.A,Ct);Et.A&&Et.A.locals&&Et.A.locals;class kt extends T{constructor(t,e){super("return-home-button","Return Home Button",t,!0),this.buttonEl=null,this.checkIntervalId=null,this.ABROAD_TIMESTAMP_KEY="ptnpnh-abroad-timestamp",this.CHECK_INTERVAL_MS=6e4,this.AUTO_RETURN_DELAY_MS=18e5,this.eClient=e,this.isEnabled()&&(this.addButton(),this.startLocationCheck())}onStateChanged(){this.isEnabled()?(this.addButton(),this.startLocationCheck()):(this.removeButton(),this.stopLocationCheck())}cleanup(){this.removeButton(),this.stopLocationCheck()}addButton(){try{const t=document.querySelector("article.profileDetails");if(!t)return;if(document.getElementById("ptnpnh-return-home-btn"))return;const e=document.createElement("a");e.id="ptnpnh-return-home-btn",e.className="ptnpnh-return-home-btn",e.href="#",e.title="Return Home",e.addEventListener("click",(t=>{t.preventDefault(),this.travelHome()})),t.appendChild(e),this.buttonEl=e}catch(t){w("return-home-button-add",t)}}removeButton(){try{const t=document.getElementById("ptnpnh-return-home-btn");t&&t.parentElement&&t.parentElement.removeChild(t),this.buttonEl=null}catch(t){w("return-home-button-remove",t)}}async travelHome(){try{const t=window.erepublik,e=t?.citizen?.residence;if(!e)return;const n=new URLSearchParams;n.append("check","moveAction"),n.append("_token",C()),n.append("travelMethod","preferCurrency"),n.append("inRegionId",String(e.regionId)),n.append("toCountryId",String(e.countryId));const i=window.location.pathname.startsWith("/en")?window.location.pathname.substring(3):window.location.pathname,a=`${k.HOST}${i||"/economy/myCompanies"}`;await this.eClient.post("/main/travel",n,{referer:a}),localStorage.removeItem(this.ABROAD_TIMESTAMP_KEY),v("return-home-button-success"),window.location.reload()}catch(t){w("return-home-button-failed",t)}}startLocationCheck(){this.stopLocationCheck(),this.checkLocation(),this.checkIntervalId=window.setInterval((()=>{this.checkLocation()}),this.CHECK_INTERVAL_MS)}stopLocationCheck(){null!==this.checkIntervalId&&(clearInterval(this.checkIntervalId),this.checkIntervalId=null)}checkLocation(){try{const t=window.erepublik,e=t?.citizen;if(!e||!e.residence)return;if(this.isAbroad(e.regionLocationId,e.residence.regionId)){const t=localStorage.getItem(this.ABROAD_TIMESTAMP_KEY);if(t){const e=parseInt(t,10);Date.now()-e>=this.AUTO_RETURN_DELAY_MS&&(v("auto-return-home-triggered"),this.travelHome())}else localStorage.setItem(this.ABROAD_TIMESTAMP_KEY,String(Date.now()))}else localStorage.removeItem(this.ABROAD_TIMESTAMP_KEY)}catch(t){w("return-home-check-location",t)}}isAbroad(t,e){return void 0!==t&&void 0!==e&&t!==e}}class St{constructor(t,e){this.features=new Map,this.featureCategories=new Map,this.settingsStorage=t,this.eClient=e,this.initializeFeatures()}static getInstance(t,e){if(!St.instance){if(!t)throw new Error("SettingsStorage must be provided when creating FeatureManager for the first time");if(!e)throw new Error("eClient must be provided when creating FeatureManager for the first time");St.instance=new St(t,e)}return St.instance}initializeFeatures(){this.registerFeature(new I(this.settingsStorage),"general"),this.registerFeature(new A(this.settingsStorage),"general"),this.registerFeature(new L(this.settingsStorage),"general"),this.registerFeature(new P(this.settingsStorage),"general"),this.registerFeature(new N(this.settingsStorage),"general"),this.registerFeature(new H(this.settingsStorage),"general"),this.registerFeature(new U(this.settingsStorage),"general"),this.registerFeature(new xt(this.settingsStorage),"general"),this.registerFeature(new kt(this.settingsStorage,this.eClient),"general"),this.registerFeature(new G(this.settingsStorage),"social"),this.registerFeature(new V(this.settingsStorage),"social"),this.registerFeature(new X(this.settingsStorage),"social"),this.registerFeature(new tt(this.settingsStorage,this.eClient),"military"),this.registerFeature(new it(this.settingsStorage),"military"),this.registerFeature(new ot(this.settingsStorage),"military"),this.registerFeature(new ft(this.settingsStorage),"military"),this.registerFeature(new yt(this.settingsStorage,this.eClient),"military"),this.registerFeature(new dt(this.settingsStorage,this.eClient),"economy"),this.registerFeature(new pt(this.settingsStorage,this.eClient),"economy")}registerFeature(t,e="general"){this.features.set(t.getId(),t),this.featureCategories.has(e)||this.featureCategories.set(e,[]),this.featureCategories.get(e).push(t.getId())}getFeature(t){return this.features.get(t)}getAllFeatures(){return Array.from(this.features.values())}getFeaturesByCategory(t){return(this.featureCategories.get(t)||[]).map((t=>this.features.get(t))).filter((t=>void 0!==t))}}class Tt{constructor(t){this.tabs=new Map,this.tabButtons=new Map,this.activeTabId=null,this.container=t,this.tabsContainer=document.createElement("div"),this.tabsContainer.className="ptnpnh-tabs-container",this.contentContainer=document.createElement("div"),this.contentContainer.className="ptnpnh-tab-content-container",this.container.appendChild(this.tabsContainer),this.container.appendChild(this.contentContainer)}addTab(t){const e=t.getId(),n=t.getLabel(),i=document.createElement("div");i.textContent=n,i.dataset.tabId=e,i.className="ptnpnh-tab-button",i.addEventListener("click",(()=>{this.activateTab(e)})),this.tabs.set(e,t),this.tabButtons.set(e,i),this.tabsContainer.appendChild(i),this.contentContainer.appendChild(t.getContent()),1===this.tabs.size&&this.activateTab(e)}activateTab(t){if(!this.tabs.has(t))return;if(this.activeTabId){const t=this.tabButtons.get(this.activeTabId),e=this.tabs.get(this.activeTabId);t&&t.classList.remove("ptnpnh-tab-button-active"),e&&e.hide()}const e=this.tabButtons.get(t),n=this.tabs.get(t);e&&e.classList.add("ptnpnh-tab-button-active"),n&&n.show(),this.activeTabId=t}getTab(t){return this.tabs.get(t)}getTabIds(){return Array.from(this.tabs.keys())}}const It="1.9.2";class At{constructor(t,e,n){this.id=t,this.label=e,this.settingsStorage=n,this.content=document.createElement("div"),this.content.className="ptnpnh-tab-content",this.initialize()}getId(){return this.id}getLabel(){return this.label}getContent(){return this.content}show(){this.content.classList.add("ptnpnh-tab-content-active")}hide(){this.content.classList.remove("ptnpnh-tab-content-active")}}class Lt{constructor(){this.element=document.createElement("div"),this.element.className="ptnpnh-feature-row"}getElement(){return this.element}}class Ft extends Lt{constructor(t){super(),this.configSection=null,this.isExpanded=!1,this.feature=t;const e=document.createElement("div");e.className="ptnpnh-feature-title",e.textContent=this.feature.getTitle();const n=document.createElement("div");n.className="ptnpnh-toggle-container",this.toggle=document.createElement("input"),this.toggle.type="checkbox",this.toggle.id=`toggle-${this.feature.getId()}`,this.toggle.checked=this.feature.isEnabled(),this.toggle.className="ptnpnh-toggle-input",this.toggleLabel=document.createElement("label"),this.toggleLabel.htmlFor=this.toggle.id,this.toggleLabel.className="ptnpnh-toggle-label",this.feature.isEnabled()&&this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider=document.createElement("span"),this.toggleSlider.className="ptnpnh-toggle-slider",this.feature.isEnabled()&&this.toggleSlider.classList.add("ptnpnh-toggle-slider-active"),this.toggle.addEventListener("change",(()=>{this.feature.setEnabled(this.toggle.checked),this.toggle.checked?(this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider.classList.add("ptnpnh-toggle-slider-active")):(this.toggleLabel.classList.remove("ptnpnh-toggle-label-active"),this.toggleSlider.classList.remove("ptnpnh-toggle-slider-active"))})),this.toggleLabel.appendChild(this.toggleSlider),n.appendChild(this.toggle),n.appendChild(this.toggleLabel),this.element.appendChild(e),this.element.appendChild(n),this.hasAdditionalConfig()&&(this.element.classList.add("ptnpnh-feature-row-expandable"),this.element.addEventListener("click",(t=>{t.target!==this.toggle&&t.target!==this.toggleLabel&&t.target!==this.toggleSlider&&this.toggleConfigSection()})))}getToggle(){return this.toggle}getFeature(){return this.feature}updateToggleState(){this.toggle.checked=this.feature.isEnabled(),this.feature.isEnabled()?(this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider.classList.add("ptnpnh-toggle-slider-active")):(this.toggleLabel.classList.remove("ptnpnh-toggle-label-active"),this.toggleSlider.classList.remove("ptnpnh-toggle-slider-active"))}hasAdditionalConfig(){return this.feature.hasConfigurationUI()}toggleConfigSection(){this.isExpanded?this.hideConfigSection():this.showConfigSection()}showConfigSection(){this.configSection||this.createConfigSection(),this.configSection&&(this.configSection.style.display="block",this.element.classList.add("ptnpnh-feature-row-expanded"),this.isExpanded=!0)}hideConfigSection(){this.configSection&&(this.configSection.style.display="none",this.element.classList.remove("ptnpnh-feature-row-expanded"),this.isExpanded=!1)}createConfigSection(){this.configSection=document.createElement("div"),this.configSection.className="ptnpnh-config-section",this.feature.createConfigurationUI(this.configSection),this.element.parentNode?.insertBefore(this.configSection,this.element.nextSibling)}}class Rt extends At{constructor(t){super("general","General",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";St.getInstance().getFeaturesByCategory("general").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new Ft(t);e.appendChild(n.getElement())}}class Dt extends At{constructor(t){super("military","Military",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";St.getInstance().getFeaturesByCategory("military").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new Ft(t);e.appendChild(n.getElement())}}class Pt extends At{constructor(t){super("economy","Economy",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";St.getInstance().getFeaturesByCategory("economy").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new Ft(t);e.appendChild(n.getElement())}}class $t extends At{constructor(t){super("social","Social",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";St.getInstance().getFeaturesByCategory("social").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new Ft(t);e.appendChild(n.getElement())}}const Bt=JSON.parse('[{"version":"1.9.2","date":"2025-10-23","changes":["fixed a bug preventing displaying the \'active battles\' list in some scenarios."]},{"version":"1.9.1","date":"2025-10-22","changes":["added auto reward collection and auto return home"]},{"version":"1.9.0","date":"2025-10-22","changes":["added the \'return home\' button"]},{"version":"1.8.0","date":"2025-10-17","changes":["added setting to configure the erepa container max-height (General tab)"]},{"version":"1.7.0","date":"2025-10-02","changes":["added auto-farmer feature"]},{"version":"1.6.4","date":"2025-10-02","changes":["build process fix"]},{"version":"1.6.3","date":"2025-10-01","changes":["memory leaks fix"]},{"version":"1.6.2","date":"2025-09-29","changes":["Highlighted active division and sorted active battles"]},{"version":"1.6.1","date":"2025-09-26","changes":["minor update"]},{"version":"1.6.0","date":"2025-09-25","changes":["added display of players not in the friends list with simple addition"]},{"version":"1.5.1","date":"2025-09-24","changes":["added version synchronization (internal change only)."]},{"version":"1.5.0","date":"2025-09-23","changes":["made the travel distance travelable."]},{"version":"1.4.0","date":"2025-09-23","changes":["added a division switcher"]},{"version":"1.3.0","date":"2025-09-10","changes":["added a campaign start date and time on the battlefield page.","enabled some features by default (level progress, energy countdown, IP address and country, list of active battles)."]},{"version":"1.2.2","date":"2025-09-04","changes":["fixed a bug causing the travel distance and cost not to be displayed in certain scenarios."]},{"version":"1.2.1","date":"2025-09-04","changes":["refactoring"]},{"version":"1.2.0","date":"2025-09-04","changes":["display a travel distance in km and cost on the battlefield page."]},{"version":"1.1.3","date":"2025-08-31","changes":["the time for solving missions and collecting rewards has been decreased to 400 ms."]},{"version":"1.1.2","date":"2025-08-31","changes":["fixed an issue preventing opening the settings menu in some circumstances."]},{"version":"1.1.1","date":"2025-08-07","changes":["added a profile switcher (Social tab, disabled by default)"]},{"version":"1.0.2","date":"2025-08-01","changes":["moved checkboxes in the Daily Tasks section to the appropriate place rows.","narrowed the list of medals in progress.","fixed touch events for mobile devices."]},{"version":"1.0.1","date":"2025-06-14","changes":["cosmetic changes to the code."]},{"version":"1.0.0","date":"2025-06-14","changes":["initial release of the project.","added auto refresh functionality (configurable, disabled by default).","added printing debug information to the console (disabled by default).","added functionality to hide financial data (disabled by default).","added displaying the level progress (disabled by default)","added displaying the energy countdown (disabled by default)","added displaying the IP address and country (blurred for privacy, (disabled by default)).","removed annoying popups.","added list of active battles (disabled by default).","added automation for daily challenges (disabled by default)","added collecting rewards from daily and weekly challenges (disabled by default).","added functionality for filtering annoying posts in the feed (disabled by default)."]}]');class Nt extends At{constructor(t){super("about","About",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";const e=document.createElement("div");e.className="ptnpnh-about-row",function(t){const e=document.createElement("div");e.className="ptnpnh-author-info";const n=document.createElement("span");n.textContent="Author: ",e.appendChild(n);const i=document.createElement("img");i.className="ptnpnh-author-avatar",i.src="https://cdnt.erepublik.net/L1A8B9IjCBi-ZE0FXZtsBbLAHPY=/142x142/smart/avatars/Citizens/2011/04/12/1907aee62f42c11beba21159840cdc16.png?fa70b874e2f337186b979af9404828eb",i.alt="driver sti avatar",e.appendChild(i);const a=document.createElement("a");a.className="ptnpnh-author-name",a.href="https://www.erepublik.com/en/citizen/profile/4690052",a.textContent="driver sti",a.target="_blank",e.appendChild(a);const s=document.createElement("div");s.className="ptnpnh-author-buttons";const o=document.createElement("a");o.className="ptnpnh-pm-button",o.href="https://www.erepublik.com/en/main/messages-compose/4690052",o.textContent="PM",o.target="_blank",s.appendChild(o);const r=document.createElement("a");r.className="ptnpnh-donate-button",r.href="https://www.erepublik.com/en/economy/donate-money/4690052",r.textContent="Donate",r.target="_blank",s.appendChild(r);const l=document.createElement("a");l.className="ptnpnh-telegram-button",l.href="https://t.me/driversti",l.innerHTML='\n<svg width="800px" height="800px" viewBox="0 0 240 240" id="svg2" xmlns="http://www.w3.org/2000/svg">\n  <style>.st0{fill:url(#path2995-1-0_1_)}.st1{fill:#c8daea}.st2{fill:#a9c9dd}.st3{fill:url(#path2991_1_)}</style>\n  <linearGradient id="path2995-1-0_1_" gradientUnits="userSpaceOnUse" x1="-683.305" y1="534.845" x2="-693.305" y2="511.512" gradientTransform="matrix(6 0 0 -6 4255 3247)">\n    <stop offset="0" stop-color="#37aee2"/>\n    <stop offset="1" stop-color="#1e96c8"/>\n  </linearGradient>\n  <path id="path2995-1-0" class="st0" d="M240 120c0 66.3-53.7 120-120 120S0 186.3 0 120 53.7 0 120 0s120 53.7 120 120z"/>\n  <path id="path2993" class="st1" d="M98 175c-3.9 0-3.2-1.5-4.6-5.2L82 132.2 152.8 88l8.3 2.2-6.9 18.8L98 175z"/>\n  <path id="path2989" class="st2" d="M98 175c3 0 4.3-1.4 6-3 2.6-2.5 36-35 36-35l-20.5-5-19 12-2.5 30v1z"/>\n  <linearGradient id="path2991_1_" gradientUnits="userSpaceOnUse" x1="128.991" y1="118.245" x2="153.991" y2="78.245" gradientTransform="matrix(1 0 0 -1 0 242)">\n    <stop offset="0" stop-color="#eff7fc"/>\n    <stop offset="1" stop-color="#ffffff"/>\n  </linearGradient>\n  <path id="path2991" class="st3" d="M100 144.4l48.4 35.7c5.5 3 9.5 1.5 10.9-5.1L179 82.2c2-8.1-3.1-11.7-8.4-9.3L55 117.5c-7.9 3.2-7.8 7.6-1.4 9.5l29.7 9.3L152 93c3.2-2 6.2-.9 3.8 1.3L100 144.4z"/>\n</svg>\n',l.target="_blank",s.appendChild(l),t.appendChild(e),t.appendChild(s)}(e);const n=document.createElement("div");n.className="ptnpnh-about-row",function(t){const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.width="100%";const n=document.createElement("h2");n.textContent="Changelog",n.style.marginBottom="10px",e.appendChild(n);const i=document.createElement("div");i.style.overflow="auto",i.style.maxHeight="200px",i.style.backgroundColor="aliceblue",i.style.padding="8px",e.appendChild(i),Bt.forEach((t=>{const e=document.createElement("div");e.style.marginBottom="8px";const n=document.createElement("h4");n.textContent=t.version+(t.date?` (${t.date})`:""),n.style.marginBottom="8px",e.appendChild(n),t.changes.forEach((t=>{const n=document.createElement("p");n.textContent="- "+t,n.style.marginLeft="20px",e.appendChild(n)})),i.appendChild(e)})),t.appendChild(e)}(n),t.appendChild(e),t.appendChild(n),this.content.appendChild(t)}}class Ot{constructor(t){this.isVisible=!1,this.settingsStorage=t,this.overlay=this.createOverlayElement(),this.dialog=this.createDialogElement(),this.setupEventListeners()}createOverlayElement(){const t=document.createElement("div");return t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.zIndex="2001",t}show(){this.isVisible||(document.body.appendChild(this.overlay),document.body.appendChild(this.dialog),this.isVisible=!0,v("Settings dialog opened"))}hide(){this.isVisible&&(document.body.removeChild(this.dialog),document.body.removeChild(this.overlay),this.isVisible=!1,v("Settings dialog closed"))}createDialogElement(){const t=document.createElement("div");t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="500px",t.style.height="400px",t.style.backgroundColor="#ffffff",t.style.borderRadius="10px",t.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",t.style.display="flex",t.style.flexDirection="column",t.style.zIndex="2002",t.style.overflow="hidden";const e=this.createHeaderElement(),n=this.createTitleElement(),i=this.createCloseBtn(),a=this.createContentElement();return e.appendChild(n),e.appendChild(i),t.appendChild(e),t.appendChild(a),this.tabController=new Tt(a),this.tabController.addTab(new Rt(this.settingsStorage)),this.tabController.addTab(new Dt(this.settingsStorage)),this.tabController.addTab(new Pt(this.settingsStorage)),this.tabController.addTab(new $t(this.settingsStorage)),this.tabController.addTab(new Nt(this.settingsStorage)),t}createHeaderElement(){const t=document.createElement("div");return t.style.display="flex",t.style.justifyContent="space-between",t.style.alignItems="center",t.style.padding="5px 16px",t.style.height="40px",t.style.boxSizing="border-box",t.style.borderBottom="1px solid #e8e8e8",t.style.backgroundColor="#f5f5f5",t}createTitleElement(){const t=document.createElement("h3");return t.textContent="erepa Settings"+(It?` (v${It})`:""),t.style.margin="0",t.style.fontSize="16px",t.style.fontWeight="500",t.style.borderBottom="none",t.style.paddingBottom="0",t}createCloseBtn(){const t=document.createElement("button");return t.textContent="×",t.style.background="none",t.style.border="none",t.style.fontSize="20px",t.style.cursor="pointer",t.style.padding="0",t.style.lineHeight="1",t.style.color="#999",t.style.fontWeight="bold",t}createContentElement(){const t=document.createElement("div");return t.style.flex="1",t.style.display="flex",t.style.flexDirection="column",t.style.overflow="hidden",t}setupEventListeners(){const t=this.dialog.querySelector("button");t&&t.addEventListener("click",(()=>{this.hide()})),this.overlay.addEventListener("click",(()=>{this.hide()})),this.dialog.addEventListener("mousedown",(t=>{t.stopPropagation()}))}}class Mt{constructor(t){this.settingsDialog=null,this.settingsStorage=t,this.button=this.createButtonElement(),this.setupEventListeners()}render(t){t.appendChild(this.button)}createButtonElement(){const t=document.createElement("button");return t.id="ptnpnh-open-settings-btn",t.style.width="24px",t.style.height="24px",t.style.borderRadius="50%",t.style.border="none",t.style.backgroundColor="#c8e3ef",t.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.2)",t.style.cursor="pointer",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.padding="0",t.style.margin="0 0 0 5px",t.style.zIndex="1000",t.innerHTML='\n<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17.6527 10.3496L19.7085 10.6856C19.8769 10.713 20.0003 10.8584 20 11.0289V12.9419C20 13.1106 19.8789 13.2553 19.7123 13.2845L17.6537 13.6459C17.5344 14.0584 17.3706 14.4557 17.1643 14.8313L18.3811 16.5207C18.4809 16.6591 18.4653 16.8494 18.3449 16.9701L16.9924 18.3235C16.8728 18.4428 16.6849 18.4598 16.5465 18.3621L14.8402 17.1652C14.4639 17.3746 14.0642 17.5416 13.6471 17.6643L13.2836 19.713C13.2544 19.879 13.11 20 12.9413 20H11.0281C10.858 20 10.7129 19.8772 10.6855 19.7099L10.3459 17.6713C9.92956 17.551 9.52778 17.385 9.14758 17.176L7.45352 18.3624C7.31542 18.4595 7.12723 18.4428 7.00791 18.3235L5.65545 16.9701C5.53544 16.8494 5.51978 16.6598 5.61858 16.5217L6.81555 14.8477C6.6044 14.4657 6.43673 14.0626 6.31533 13.6442L4.28698 13.2845C4.12105 13.255 4 13.1106 4 12.9419V11.0289C4 10.8591 4.12314 10.7137 4.29081 10.6859L6.31916 10.3482C6.44126 9.9287 6.60892 9.52557 6.81938 9.1447L5.63701 7.45322C5.53996 7.31513 5.55666 7.1273 5.67597 7.008L7.02809 5.656C7.1488 5.536 7.33768 5.52 7.47648 5.61913L9.15662 6.81913C9.53405 6.61252 9.93478 6.448 10.3522 6.328L10.6848 4.29183C10.7122 4.12348 10.8576 4 11.0281 4H12.9413C13.1104 4 13.2547 4.12174 13.2839 4.288L13.6426 6.3353C14.0576 6.456 14.4576 6.62226 14.8364 6.83165L16.5211 5.62087C16.6595 5.52104 16.8495 5.5367 16.9702 5.65704L18.323 7.00904C18.4423 7.1287 18.459 7.31687 18.3619 7.45496L17.1618 9.16522C17.3678 9.54052 17.5323 9.93704 17.6527 10.3496ZM9.56501 12C9.56501 13.3447 10.6552 14.4348 12 14.4348C13.3448 14.4348 14.435 13.3447 14.435 12C14.435 10.6553 13.3448 9.56522 12 9.56522C10.6552 9.56522 9.56501 10.6553 9.56501 12Z" fill="#000000"/>\n</svg>\n',t}setupEventListeners(){this.button.addEventListener("click",(()=>{v("Settings button clicked!"),this.settingsDialog||(this.settingsDialog=new Ot(this.settingsStorage)),this.settingsDialog.show()}))}}var _t;!function(t){t.INITIALIZING="initializing",t.DOM_READY="dom_ready",t.INTERACTIVE="interactive",t.FULLY_LOADED="fully_loaded"}(_t||(_t={}));class zt{constructor(t,e){this.loadState=_t.INITIALIZING,this.contentObserver=null,this.executedFeatures=new Set,this.failedFeatures=new Set,this.settingsStorage=t,this.eClient=e,this.featureManager=St.getInstance(t,e)}static getInstance(t,e){if(!zt.instance){if(!t||!e)throw new Error("SettingsStorage and eClient required for first initialization");zt.instance=new zt(t,e)}return zt.instance}initialize(){try{this.setupImmediateFeatures(),this.setupDomReadyFeatures(),this.setupFullyLoadedFeatures(),v("ScriptLoader initialized successfully")}catch(t){w("Failed to initialize ScriptLoader",t)}}setupImmediateFeatures(){this.loadState=_t.INITIALIZING,v("Stage 1: Initializing immediate features...");try{b.initialize(this.settingsStorage,"[erepa]");const t=this.featureManager.getAllFeatures().filter((t=>t.isEnabled()&&t.canRunImmediately()&&t.shouldExecuteOnCurrentPage())).sort(((t,e)=>t.getPriority()-e.getPriority()));t.forEach((t=>{this.executeFeature(t,"immediate")})),v(`Executed ${t.length} immediate features`)}catch(t){w("Error in immediate feature setup",t)}}setupDomReadyFeatures(){const t=()=>{this.loadState=_t.DOM_READY,v("Stage 2: DOM ready, initializing DOM-dependent features...");try{this.initializeUIFeatures(),this.setupMutationObservers(),this.initializeDomFeatures()}catch(t){w("Error in DOM ready feature setup",t)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}setupFullyLoadedFeatures(){const t=()=>{this.loadState=_t.FULLY_LOADED,v("Stage 3: Page fully loaded, initializing remaining features...");try{this.initializeFullLoadFeatures()}catch(t){w("Error in full load feature setup",t)}};"complete"===document.readyState?t():window.addEventListener("load",t)}initializeUIFeatures(){v("Initializing UI components...");try{!function(t){try{const e=document.querySelector("div.right_part");if(!e)throw new Error("Right part div not found");new Mt(t).render(e)}catch(t){w("Could not find right_part div",t)}}(this.settingsStorage)}catch(t){w("Failed to render settings button",t)}const t=this.featureManager.getAllFeatures().filter((t=>t.isEnabled()&&t.requiresDom()&&!t.requiresFullLoad()&&t.shouldExecuteOnCurrentPage()&&!this.executedFeatures.has(t.getId()))).sort(((t,e)=>t.getPriority()-e.getPriority()));t.forEach((t=>{this.executeFeature(t,"dom_ready")})),v(`Initialized ${t.length} DOM-dependent features`)}setupMutationObservers(){if(!this.contentObserver)try{this.contentObserver=S.createContentObserver((t=>{this.handleDomChanges(t)})),v("Mutation observer setup complete")}catch(t){w("Failed to setup mutation observer",t)}}handleDomChanges(t){t.forEach((t=>{"childList"===t.type&&this.handleAddedNodes(t.addedNodes)}))}handleAddedNodes(t){t.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){const e=t;this.featureManager.getAllFeatures().filter((t=>t.isEnabled()&&t.handleNewContent&&t.shouldExecuteOnCurrentPage())).forEach((t=>{try{t.handleNewContent?.(e)}catch(e){w(`Feature ${t.getId()} failed to handle new content`,e)}}))}}))}initializeDomFeatures(){const t=S.getCurrentPage();this.featureManager.getAllFeatures().filter((t=>t.isEnabled()&&t.requiresDom()&&t.shouldExecuteOnCurrentPage()&&!this.executedFeatures.has(t.getId())&&!this.failedFeatures.has(t.getId()))).forEach((e=>{this.waitForFeatureRequirements(e,t)}))}waitForFeatureRequirements(t,e){const n=this.getRequiredSelectors(t,e);0!==n.length?Promise.all(n.map((t=>S.waitForElement(t,1e4).catch((()=>null))))).then((e=>{e.every((t=>null!==t))?this.executeFeature(t,"dom_ready"):(w(`Feature ${t.getId()} requirements not met`,{requiredSelectors:n}),this.failedFeatures.add(t.getId()))})).catch((e=>{w(`Error waiting for feature ${t.getId()} requirements`,e),this.failedFeatures.add(t.getId())})):this.executeFeature(t,"dom_ready")}getRequiredSelectors(t,e){const n=[],i=t.getId(),a={activeBattles:{campaigns:["#campaigns_list"],battlefield:["#battlefield"],military:["#campaigns_list, #battlefield"]},collectRewards:{main:[".daily_tasks","#dailyOrdersContainer"],economy:[".daily_tasks","#dailyOrdersContainer"]},dailyTasks:{main:[".daily_tasks"],economy:[".daily_tasks"]},autoFarmer:{battlefield:["#battlefield"]}}[i]?.[e];return a&&n.push(...a),n}initializeFullLoadFeatures(){const t=this.featureManager.getAllFeatures().filter((t=>t.isEnabled()&&t.requiresFullLoad()&&t.shouldExecuteOnCurrentPage()&&!this.executedFeatures.has(t.getId()))).sort(((t,e)=>t.getPriority()-e.getPriority()));t.forEach((t=>{this.executeFeature(t,"full_load")})),v(`Initialized ${t.length} full-load features`)}executeFeature(t,e){const n=t.getId();if(this.executedFeatures.has(n))y(`Feature ${n} already executed`);else try{y(`Executing feature ${n} at stage ${e}`),t.beforeExecute?.(),t.execute(),t.afterExecute?.(),this.executedFeatures.add(n),v(`Feature ${n} executed successfully at stage ${e}`)}catch(t){w(`Failed to execute feature ${n} at stage ${e}`,t),this.failedFeatures.add(n)}}getLoadState(){return this.loadState}getExecutionStats(){const t=this.featureManager.getAllFeatures().filter((t=>t.isEnabled())),e={immediate:0,dom_ready:0,full_load:0};return t.forEach((t=>{t.canRunImmediately()?e.immediate++:t.requiresFullLoad()?e.full_load++:e.dom_ready++})),{total:t.length,executed:this.executedFeatures.size,failed:this.failedFeatures.size,byStage:e}}cleanup(){this.contentObserver&&(this.contentObserver.disconnect(),this.contentObserver=null),this.executedFeatures.forEach((t=>{const e=this.featureManager.getFeature(t);if(e)try{e.cleanup?.()}catch(e){w(`Failed to cleanup feature ${t}`,e)}})),this.executedFeatures.clear(),this.failedFeatures.clear()}}try{!function(){try{const t=new x,e=new k;v("eRepa script starting initialization...");const n=zt.getInstance(t,e);n.initialize(),setTimeout((()=>{const t=n.getExecutionStats();v(`Script loading complete: ${t.executed}/${t.total} features executed (${t.failed} failed)`)}),5e3)}catch(t){w("Failed to initialize eRepa script",t)}}()}catch(t){w("Critical error during script initialization",t)}})();