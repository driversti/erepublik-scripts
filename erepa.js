(()=>{"use strict";var t={11:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#ptnpnh-level-progress-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-level-progress-bar {\n  background-color: #e0e0e0;\n  border-radius: 10px;\n  width: 100%;\n  height: 20px;\n  position: relative;\n  overflow: hidden;\n}\n\n.ptnpnh-level-progress-fill {\n  background-color: #c8e3ef;\n  height: 100%;\n  transition: width 0.3s;\n}\n\n.ptnpnh-level-progress-text {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #000;\n  font-size: 12px;\n}",""]);const r=o},16:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-feature-row {\n  width: 100%;\n  min-height: 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 5px 0;\n  border-bottom: 1px solid #eee;\n}\n\n.ptnpnh-feature-title {\n  font-weight: bold;\n}\n\n.ptnpnh-toggle-container {\n  position: relative;\n  display: inline-block;\n}\n\n.ptnpnh-toggle-input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n  position: absolute;\n}\n\n.ptnpnh-toggle-label {\n  position: relative;\n  display: inline-block;\n  width: 40px;\n  height: 20px;\n  background-color: #ccc;\n  border-radius: 20px;\n  transition: background-color 0.3s;\n  cursor: pointer;\n}\n\n.ptnpnh-toggle-label-active {\n  background-color: #4896C6;\n}\n\n.ptnpnh-toggle-slider {\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 16px;\n  height: 16px;\n  background-color: white;\n  border-radius: 50%;\n  transition: left 0.3s;\n}\n\n.ptnpnh-toggle-slider-active {\n  left: 22px;\n}\n\n/* Expandable row styles */\n.ptnpnh-feature-row-expandable {\n  cursor: pointer;\n  position: relative;\n}\n\n.ptnpnh-feature-row-expandable:hover {\n  background-color: #f9f9f9;\n}\n\n.ptnpnh-feature-row-expanded {\n  border-bottom: none;\n}\n\n/* Configuration section styles */\n.ptnpnh-config-section {\n  width: 100%;\n  padding: 0 5px;\n  background-color: #f5f5f5;\n  border-bottom: 1px solid #eee;\n  box-sizing: border-box;\n  display: none;\n}\n\n.ptnpnh-config-container {\n  margin: 5px 0;\n  width: 100%;\n}\n\n/* Horizontal layout (label to the left of input) */\n.ptnpnh-config-container-horizontal {\n  display: flex;\n  align-items: center;\n}\n\n.ptnpnh-config-container-horizontal .ptnpnh-config-label {\n  margin-right: 10px;\n}\n\n/* Vertical layout (label above input/textarea) */\n.ptnpnh-config-container-vertical {\n  display: flex;\n  flex-direction: column;\n}\n\n.ptnpnh-config-container-vertical .ptnpnh-config-label {\n  margin-bottom: 5px;\n}\n\n.ptnpnh-config-label {\n  font-size: 14px;\n}\n\n.ptnpnh-config-input {\n  padding: 5px;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  width: 80px;\n}\n",""]);const r=o},35:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-placeholder {\n  color: #666;\n}\n\n.ptnpnh-rows-container {\n  width: 100%;\n}",""]);const r=o},54:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-hidden-post {\n  display: none !important;\n}\n\n.ptnpnh-config-textarea {\n  padding: 5px;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  background-color: #fff;\n  color: #333;\n  font-family: inherit;\n  resize: vertical;\n}\n\n.ptnpnh-config-textarea:focus {\n  border-color: #c8e3ef;\n  outline: none;\n  box-shadow: 0 0 3px rgba(200, 227, 239, 0.5);\n}\n",""]);const r=o},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var a={},o=[],r=0;r<t.length;r++){var l=t[r],c=i.base?l[0]+i.base:l[0],d=a[c]||0,h="".concat(c," ").concat(d);a[c]=d+1;var p=n(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var g=s(u,i);i.byIndex=r,e.splice(r,0,{identifier:h,updater:g,references:1})}o.push(h)}return o}function s(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var a=i(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<a.length;o++){var r=n(a[o]);e[r].references--}for(var l=i(t,s),c=0;c<a.length;c++){var d=n(a[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}a=l}}},98:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#ptnpnh-active-battles-dialog {\n  position: fixed;\n  min-width: 350px;\n  min-height: 100px;\n  background-color: #fff;\n  border: 1px solid #c8e3ef;\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  z-index: 1000;\n  top: 100px;\n  left: 100px;\n  user-select: none;\n}\n\n.ptnpnh-active-battles-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.ptnpnh-active-battles-header {\n  background-color: #c8e3ef;\n  padding: 8px 10px;\n  font-weight: bold;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  cursor: move;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.ptnpnh-active-battles-refresh {\n  display: inline-block;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.ptnpnh-active-battles-body {\n  padding: 5px;\n  flex-grow: 1;\n  min-height: 60px;\n  overflow-y: auto;\n  cursor: default;\n}\n\n.ptnpnh-active-battles-body a {\n  display: block;\n  text-decoration: none;\n  cursor: pointer;\n  color: #000;\n  margin: 5px;\n  text-align: center;\n}\n\n.ptnpnh-active-battles-body a:hover {\n  background-color: #f0f0f0;\n  border-radius: 3px;\n  font-weight: bold;\n}\n\n.ptnpnh-active-battles-last-update {\n  font-size: 12px;\n  color: #555;\n  margin-left: 5px;\n  font-weight: normal;\n}\n",""]);const r=o},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},133:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#ptnpnh-daily-challenge-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-daily-challenge-button {\n  background-color: #c8e3ef;\n  border: none;\n  border-radius: 10px;\n  color: #333;\n  cursor: pointer;\n  font-weight: bold;\n  padding: 4px 15px;\n  transition: background-color 0.2s;\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n}\n\n.ptnpnh-daily-challenge-button:hover {\n  background-color: #a5d1e5;\n}\n\n.ptnpnh-daily-challenge-button:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n",""]);const r=o},208:(t,e,n)=>{n.d(e,{A:()=>g});var i=n(601),s=n.n(i),a=n(314),o=n.n(a),r=n(353),l=n(16),c=n(934),d=n(594),h=n(998),p=n(35),u=o()(s());u.i(r.A),u.i(l.A),u.i(c.A),u.i(d.A),u.i(h.A),u.i(p.A),u.push([t.id,"/* Import all CSS files */\n",""]);const g=u},247:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-daily-tasks-container {\n  background-color: #fff;\n  border: 1px solid #c8e3ef;\n  border-radius: 10px;\n  overflow: hidden;\n}\n\n.ptnpnh-daily-tasks-header {\n  background-color: #c8e3ef;\n  color: #333;\n  font-weight: bold;\n  padding: 4px 10px;\n  text-align: center;\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.ptnpnh-daily-tasks-toggle-icon {\n  font-size: 12px;\n  margin-left: 5px;\n  transition: transform 0.3s ease;\n}\n\n.ptnpnh-daily-tasks-container.collapsed .ptnpnh-daily-tasks-toggle-icon {\n  transform: rotate(-90deg);\n}\n\n.ptnpnh-daily-tasks-content {\n  padding: 10px;\n  max-height: 500px;\n  overflow: hidden;\n  transition: max-height 0.3s ease-out;\n}\n\n.ptnpnh-daily-tasks-container.collapsed .ptnpnh-daily-tasks-content {\n  max-height: 0;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n\n.ptnpnh-daily-tasks-status {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  margin-bottom: 10px;\n}\n\n.ptnpnh-daily-tasks-item {\n  display: flex;\n  align-items: center;\n  padding: 0;\n  border-radius: 3px;\n  background-color: #f5f5f5;\n}\n\n.ptnpnh-daily-tasks-icon {\n  margin-right: 8px;\n  font-size: 14px;\n}\n\n.ptnpnh-daily-tasks-label {\n  flex-grow: 1;\n  font-size: 12px;\n}\n\n.ptnpnh-daily-tasks-status-icon {\n  margin-left: 8px;\n  font-size: 14px;\n}\n\n.ptnpnh-daily-tasks-selection {\n  margin-top: 10px;\n  border-top: 1px solid #e5e5e5;\n  padding-top: 10px;\n}\n\n.ptnpnh-daily-tasks-selection-header {\n  font-size: 12px;\n  font-weight: bold;\n  margin-bottom: 5px;\n  color: #333;\n}\n\n.ptnpnh-daily-tasks-selection-items {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 5px;\n}\n\n.ptnpnh-daily-tasks-selection-item {\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n}\n\n.ptnpnh-daily-tasks-checkbox {\n  margin-right: 5px;\n  cursor: pointer;\n}\n\n.ptnpnh-daily-tasks-actions {\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n}\n\n.ptnpnh-daily-tasks-button {\n  background-color: #c8e3ef;\n  border: none;\n  border-radius: 3px;\n  color: #333;\n  cursor: pointer;\n  font-weight: bold;\n  padding: 5px 15px;\n  transition: background-color 0.2s;\n}\n\n.ptnpnh-daily-tasks-button:hover {\n  background-color: #a5d1e5;\n}\n\n.ptnpnh-daily-tasks-success {\n  color: #28a745;\n}\n\n.ptnpnh-daily-tasks-error {\n  color: #dc3545;\n}\n\n.ptnpnh-daily-tasks-pending {\n  color: #ffc107;\n}\n\n/* Notification styles */\n/* Container for all notifications - fixed at bottom right */\n/* Uses column-reverse to display newest notifications at the bottom */\n/* and automatically push older ones upward */\n#ptnpnh-notification-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  display: flex;\n  flex-direction: column-reverse; /* Newest at bottom, oldest at top */\n  gap: 10px; /* Space between notifications */\n  z-index: 9999;\n  max-height: 80vh; /* Limit height to 80% of viewport */\n  overflow-y: auto; /* Add scrollbar if too many notifications */\n  padding-right: 5px;\n}\n\n.ptnpnh-notification {\n  padding: 10px 15px;\n  border-radius: 5px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  font-size: 14px;\n  max-width: 300px;\n  animation: ptnpnh-notification-slide-in 0.3s ease-out;\n}\n\n.ptnpnh-notification-success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n.ptnpnh-notification-error {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.ptnpnh-notification-info {\n  background-color: #d1ecf1;\n  color: #0c5460;\n  border: 1px solid #bee5eb;\n}\n\n.ptnpnh-notification-warning {\n  background-color: #fff3cd;\n  color: #856404;\n  border: 1px solid #ffeeba;\n}\n\n@keyframes ptnpnh-notification-slide-in {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n",""]);const r=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,a){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);i&&o[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},353:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#erepa_container {\n  max-height: 300px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  display: block;\n  padding: 5px;\n}\n",""]);const r=o},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},577:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#ptnpnh-ip-location-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-ip-location-info {\n  display: flex;\n  gap: 10px;\n  filter: blur(4px);\n  transition: filter 0.3s ease;\n  min-height: 16px;\n}\n\n.ptnpnh-ip-location-info:hover {\n  filter: blur(0);\n}\n",""]);const r=o},594:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 2001;\n}\n\n.ptnpnh-dialog {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 500px;\n  height: 400px;\n  background-color: #ffffff;\n  border-radius: 10px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  display: flex;\n  flex-direction: column;\n  z-index: 2002;\n  overflow: hidden;\n}\n\n.ptnpnh-dialog-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 5px 16px;\n  height: 40px;\n  box-sizing: border-box;\n  border-bottom: 1px solid #e8e8e8;\n  background-color: #f5f5f5;\n}\n\n.ptnpnh-dialog-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  border-bottom: none;\n  padding-bottom: 0;\n}\n\n.ptnpnh-dialog-close-button {\n  background: none;\n  border: none;\n  font-size: 20px;\n  cursor: pointer;\n  padding: 0;\n  line-height: 1;\n  color: #999;\n  font-weight: bold;\n}\n\n.ptnpnh-dialog-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}",""]);const r=o},601:t=>{t.exports=function(t){return t[1]}},655:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,"#ptnpnh-energy-countdown-container {\n  padding: 1px;\n  margin: 5px 0;\n  background-color: #f5f5f5;\n  border-radius: 10px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ptnpnh-energy-countdown-container {\n  display: flex;\n  /*align-items: center;*/\n  /*justify-content: center;*/\n}\n\n.ptnpnh-energy-countdown-text {\n  color: #000;\n  font-size: 12px;\n}\n\n.ptnpnh-energy-countdown-time {\n  color: #4a90e2;\n}",""]);const r=o},659:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},934:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-tabs-container {\n  display: flex;\n  border-bottom: 1px solid #e8e8e8;\n  background-color: #fafafa;\n}\n\n.ptnpnh-tab-content-container {\n  flex: 1;\n  overflow: auto;\n  padding: 10px;\n}\n\n.ptnpnh-tab-button {\n  padding: 8px 16px;\n  cursor: pointer;\n  border-bottom: 2px solid transparent;\n  transition: all 0.3s;\n}\n\n.ptnpnh-tab-button-active {\n  border-bottom: 2px solid #1890ff;\n  background-color: #f0f0f0;\n}\n\n.ptnpnh-tab-content {\n  display: none;\n}\n\n.ptnpnh-tab-content-active {\n  display: block;\n}",""]);const r=o},998:(t,e,n)=>{n.d(e,{A:()=>r});var i=n(601),s=n.n(i),a=n(314),o=n.n(a)()(s());o.push([t.id,".ptnpnh-settings-button {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  border: none;\n  background-color: #ffffff;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n  cursor: pointer;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0;\n  z-index: 2001;\n}\n\n.ptnpnh-settings-button-grabbing {\n  cursor: grabbing;\n}",""]);const r=o}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={id:i,exports:{}};return t[i](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var i=n(72),s=n.n(i),a=n(825),o=n.n(a),r=n(659),l=n.n(r),c=n(56),d=n.n(c),h=n(540),p=n.n(h),u=n(113),g=n.n(u),f=n(208),m={};m.styleTagTransform=g(),m.setAttributes=d(),m.insert=l().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=p();s()(f.A,m);f.A&&f.A.locals&&f.A.locals;class b{static initialize(t,e){const n=t.configFor(this.STORAGE_KEY);if(n)this.PREFIX=n.prefix,this.debugEnabled=n.debugEnabled;else{this.PREFIX=e,this.debugEnabled=!1;const n={prefix:this.PREFIX,debugEnabled:this.debugEnabled};t.save(this.STORAGE_KEY,n)}}static setDebugEnabled(t){this.debugEnabled=t}static isDebugEnabled(){return this.debugEnabled}static logInfo(t,...e){}static logDebug(t,...e){this.debugEnabled}static logWarn(t,...e){}static logError(t,...e){}}b.PREFIX="[placeholder]",b.debugEnabled=!1,b.STORAGE_KEY="logger";b.logDebug.bind(b);const y=b.logInfo.bind(b),w=(b.logWarn.bind(b),b.logError.bind(b));class v{constructor(t){this.tabs=new Map,this.tabButtons=new Map,this.activeTabId=null,this.container=t,this.tabsContainer=document.createElement("div"),this.tabsContainer.className="ptnpnh-tabs-container",this.contentContainer=document.createElement("div"),this.contentContainer.className="ptnpnh-tab-content-container",this.container.appendChild(this.tabsContainer),this.container.appendChild(this.contentContainer)}addTab(t){const e=t.getId(),n=t.getLabel(),i=document.createElement("div");i.textContent=n,i.dataset.tabId=e,i.className="ptnpnh-tab-button",i.addEventListener("click",(()=>{this.activateTab(e)})),this.tabs.set(e,t),this.tabButtons.set(e,i),this.tabsContainer.appendChild(i),this.contentContainer.appendChild(t.getContent()),1===this.tabs.size&&this.activateTab(e)}activateTab(t){if(!this.tabs.has(t))return;if(this.activeTabId){const t=this.tabButtons.get(this.activeTabId),e=this.tabs.get(this.activeTabId);t&&t.classList.remove("ptnpnh-tab-button-active"),e&&e.hide()}const e=this.tabButtons.get(t),n=this.tabs.get(t);e&&e.classList.add("ptnpnh-tab-button-active"),n&&n.show(),this.activeTabId=t}getTab(t){return this.tabs.get(t)}getTabIds(){return Array.from(this.tabs.keys())}}class k{constructor(t,e,n){this.id=t,this.label=e,this.settingsStorage=n,this.content=document.createElement("div"),this.content.className="ptnpnh-tab-content",this.initialize()}getId(){return this.id}getLabel(){return this.label}getContent(){return this.content}show(){this.content.classList.add("ptnpnh-tab-content-active")}hide(){this.content.classList.remove("ptnpnh-tab-content-active")}}class x{constructor(t){this.configSection=null,this.isExpanded=!1,this.feature=t,this.element=document.createElement("div"),this.element.className="ptnpnh-feature-row";const e=document.createElement("div");e.className="ptnpnh-feature-title",e.textContent=this.feature.getTitle();const n=document.createElement("div");n.className="ptnpnh-toggle-container",this.toggle=document.createElement("input"),this.toggle.type="checkbox",this.toggle.id=`toggle-${this.feature.getId()}`,this.toggle.checked=this.feature.isEnabled(),this.toggle.className="ptnpnh-toggle-input",this.toggleLabel=document.createElement("label"),this.toggleLabel.htmlFor=this.toggle.id,this.toggleLabel.className="ptnpnh-toggle-label",this.feature.isEnabled()&&this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider=document.createElement("span"),this.toggleSlider.className="ptnpnh-toggle-slider",this.feature.isEnabled()&&this.toggleSlider.classList.add("ptnpnh-toggle-slider-active"),this.toggle.addEventListener("change",(()=>{this.feature.setEnabled(this.toggle.checked),this.toggle.checked?(this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider.classList.add("ptnpnh-toggle-slider-active")):(this.toggleLabel.classList.remove("ptnpnh-toggle-label-active"),this.toggleSlider.classList.remove("ptnpnh-toggle-slider-active"))})),this.toggleLabel.appendChild(this.toggleSlider),n.appendChild(this.toggle),n.appendChild(this.toggleLabel),this.element.appendChild(e),this.element.appendChild(n),this.hasAdditionalConfig()&&(this.element.classList.add("ptnpnh-feature-row-expandable"),this.element.addEventListener("click",(t=>{t.target!==this.toggle&&t.target!==this.toggleLabel&&t.target!==this.toggleSlider&&this.toggleConfigSection()})))}getElement(){return this.element}getToggle(){return this.toggle}getFeature(){return this.feature}updateToggleState(){this.toggle.checked=this.feature.isEnabled(),this.feature.isEnabled()?(this.toggleLabel.classList.add("ptnpnh-toggle-label-active"),this.toggleSlider.classList.add("ptnpnh-toggle-slider-active")):(this.toggleLabel.classList.remove("ptnpnh-toggle-label-active"),this.toggleSlider.classList.remove("ptnpnh-toggle-slider-active"))}hasAdditionalConfig(){return this.feature.hasConfigurationUI()}toggleConfigSection(){this.isExpanded?this.hideConfigSection():this.showConfigSection()}showConfigSection(){this.configSection||this.createConfigSection(),this.configSection&&(this.configSection.style.display="block",this.element.classList.add("ptnpnh-feature-row-expanded"),this.isExpanded=!0)}hideConfigSection(){this.configSection&&(this.configSection.style.display="none",this.element.classList.remove("ptnpnh-feature-row-expanded"),this.isExpanded=!1)}createConfigSection(){this.configSection=document.createElement("div"),this.configSection.className="ptnpnh-config-section",this.feature.createConfigurationUI(this.configSection),this.element.parentNode?.insertBefore(this.configSection,this.element.nextSibling)}}class C{constructor(t,e,n,i=!1){this.id=t,this.title=e,this.settingsStorage=n,this.enabled=this.loadState(i)}getId(){return this.id}getTitle(){return this.title}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t,this.saveState(),this.onStateChanged()}loadState(t){const e=this.settingsStorage.configFor(this.id);return e?e.enabled:t}saveState(){this.settingsStorage.save(this.id,{enabled:this.enabled})}hasConfigurationUI(){return!1}createConfigurationUI(t){return!1}}class E extends C{constructor(t){if(super("auto-page-refresh","Auto Page Refresh",t,!1),this.refreshIntervalId=null,t.hasConfig(this.getId())||this.saveState(),this.refreshInterval=this.loadRefreshInterval(),this.isEnabled()){const t=this.settingsStorage.configFor(this.getId());t&&t.autoRefreshActive&&this.settingsStorage.save(this.getId(),{autoRefreshActive:!1}),this.startRefreshTimer()}}getRefreshInterval(){return this.refreshInterval/1e3}setRefreshInterval(t){this.refreshInterval=1e3*t,this.settingsStorage.save(this.getId(),{refreshInterval:this.refreshInterval}),this.isEnabled()&&this.startRefreshTimer()}loadRefreshInterval(){const t=this.settingsStorage.configFor(this.getId());return t&&t.refreshInterval?t.refreshInterval:E.DEFAULT_INTERVAL}onStateChanged(){this.isEnabled()?this.startRefreshTimer():this.stopRefreshTimer()}startRefreshTimer(){this.stopRefreshTimer(),this.refreshIntervalId=window.setInterval((()=>{this.checkCurrentEnabledStatus()?(this.settingsStorage.save(this.getId(),{autoRefreshActive:!0}),window.location.reload()):this.stopRefreshTimer()}),this.refreshInterval)}checkCurrentEnabledStatus(){return this.loadState(!1)}stopRefreshTimer(){null!==this.refreshIntervalId&&(window.clearInterval(this.refreshIntervalId),this.refreshIntervalId=null)}hasConfigurationUI(){return!0}createConfigurationUI(t){const e=document.createElement("div");e.className="ptnpnh-config-container ptnpnh-config-container-horizontal";const n=document.createElement("label");n.textContent="Refresh interval in seconds:",n.htmlFor=`interval-${this.getId()}`,n.className="ptnpnh-config-label";const i=document.createElement("input");return i.type="number",i.id=`interval-${this.getId()}`,i.className="ptnpnh-config-input",i.min="1",i.value=this.getRefreshInterval().toString(),i.addEventListener("change",(()=>{const t=parseInt(i.value,10);t>0&&this.setRefreshInterval(t)})),e.appendChild(n),e.appendChild(i),t.appendChild(e),!0}}E.DEFAULT_INTERVAL=3e5;class S extends C{constructor(t){super("debug-logging","Enable Debug Logging",t,!1),t.hasConfig(this.getId())||this.saveState(),b.setDebugEnabled(this.isEnabled())}onStateChanged(){b.setDebugEnabled(this.isEnabled())}}class T extends C{constructor(t){super("hide-finances","Hide Finances",t,!1),this.isEnabled()&&this.hideFinances()}onStateChanged(){this.isEnabled()?this.hideFinances():this.showFinances()}hideFinances(){const t=document.getElementById("side_bar_gold_account_value"),e=document.getElementById("side_bar_currency_account_value");t&&(t.textContent="0"),e&&(e.textContent="0")}showFinances(){const t=document.getElementById("side_bar_gold_account_value"),e=document.getElementById("side_bar_currency_account_value");if(t){const e=t.getAttribute("data-amount")||window.erepublik?.citizen?.gold?.toString()||"0";t.textContent=this.formatNumber(e)}if(e){const t=e.getAttribute("data-amount")||window.erepublik?.citizen?.currencyAmount?.toString()||"0";e.textContent=this.formatNumber(t)}}formatNumber(t){return parseInt(t,10).toLocaleString()}}var L=n(11),I={};I.styleTagTransform=g(),I.setAttributes=d(),I.insert=l().bind(null,"head"),I.domAPI=o(),I.insertStyleElement=p();s()(L.A,I);L.A&&L.A.locals&&L.A.locals;function A(){let t=document.getElementById("erepa_container");if(!t){const e=document.getElementById("large_sidebar");if(!e)throw new Error("Large sidebar not found");t=document.createElement("div"),t.id="erepa_container",e.appendChild(t)}return t}class B extends C{constructor(t){super("level-progress","Level Progress",t,!1),this.progressBarContainer=null,this.isEnabled()&&this.showLevelProgress()}onStateChanged(){this.isEnabled()?this.showLevelProgress():this.hideLevelProgress()}showLevelProgress(){try{const t=A();this.progressBarContainer||(this.progressBarContainer=document.createElement("div"),this.progressBarContainer.id="ptnpnh-level-progress-container",this.progressBarContainer.innerHTML='<div class="ptnpnh-level-progress-bar">\n  <div class="ptnpnh-level-progress-fill"></div>\n  <div class="ptnpnh-level-progress-text"></div>\n</div>'),this.updateProgressBar(),document.getElementById("ptnpnh-level-progress-container")||t.appendChild(this.progressBarContainer)}catch(t){return void w("Error showing level progress",t)}}updateProgressBar(){if(!this.progressBarContainer)return;const t=document.querySelector(".actualXp"),e=document.getElementById("experienceTooltip");if(!t||!e)return void w("Experience elements not found");const n=t.getAttribute("style"),i=n?n.match(/width:(\d+\.\d+)%/):null,s=i?parseFloat(i[1]):0,a=e.textContent||"",o=a.match(/Experience points: .*?(\d+(?:,\d+)*)/),r=a.match(/Next level at: .*?(\d+(?:,\d+)*)/);if(!o||!r)return void w("Could not extract experience points information");const l=parseInt(o[1].replace(/,/g,""),10),c=parseInt(r[1].replace(/,/g,""),10)-l,d=this.progressBarContainer.querySelector(".ptnpnh-level-progress-fill");d&&(d.style.width=`${s}%`);const h=this.progressBarContainer.querySelector(".ptnpnh-level-progress-text");h&&(h.textContent=`${c.toLocaleString()} XP to next level`)}hideLevelProgress(){this.progressBarContainer&&(this.progressBarContainer.remove(),this.progressBarContainer=null)}}var R=n(655),F={};F.styleTagTransform=g(),F.setAttributes=d(),F.insert=l().bind(null,"head"),F.domAPI=o(),F.insertStyleElement=p();s()(R.A,F);R.A&&R.A.locals&&R.A.locals;class M extends C{constructor(t){super("energy-countdown","Energy Countdown",t,!1),this.countdownContainer=null,this.updateInterval=null,this.isEnabled()&&this.showEnergyCountdown()}onStateChanged(){this.isEnabled()?this.showEnergyCountdown():this.hideEnergyCountdown()}showEnergyCountdown(){try{const t=A();this.countdownContainer||(this.countdownContainer=document.createElement("div"),this.countdownContainer.id="ptnpnh-energy-countdown-container",this.countdownContainer.innerHTML='<div class="ptnpnh-energy-countdown-container">\n  <div class="ptnpnh-energy-countdown-text">Full energy in: <span class="ptnpnh-energy-countdown-time"></span></div>\n</div>'),this.updateCountdown(),this.updateInterval||(this.updateInterval=window.setInterval((()=>this.updateCountdown()),1e3)),document.getElementById("ptnpnh-energy-countdown-container")||t.appendChild(this.countdownContainer)}catch(t){return void w("Error showing energy countdown",t)}}updateCountdown(){if(!this.countdownContainer)return;const t=document.getElementById("secondsToFullEnergy");if(!t)return;if(!t.getAttribute("data-seconds"))return void w("Seconds to full energy data attribute not found");const e=t.querySelector(".countdown_amount")?.textContent||"",n=this.countdownContainer.querySelector(".ptnpnh-energy-countdown-time");n&&(n.textContent=e)}hideEnergyCountdown(){this.countdownContainer&&(this.countdownContainer.remove(),this.countdownContainer=null),this.updateInterval&&(window.clearInterval(this.updateInterval),this.updateInterval=null)}}var P=n(577),D={};D.styleTagTransform=g(),D.setAttributes=d(),D.insert=l().bind(null,"head"),D.domAPI=o(),D.insertStyleElement=p();s()(P.A,D);P.A&&P.A.locals&&P.A.locals;class N{constructor(t,e,n,i,s){this.id=t,this.name=e,this.code2=n,this.code3=i,this.emoji=s}}const O={1:new N(1,"Romania","RO","ROU","ğŸ‡·ğŸ‡´"),9:new N(9,"Brazil","BR","BRA","ğŸ‡§ğŸ‡·"),10:new N(10,"Italy","IT","ITA","ğŸ‡®ğŸ‡¹"),11:new N(11,"France","FR","FRA","ğŸ‡«ğŸ‡·"),12:new N(12,"Germany","DE","DEU","ğŸ‡©ğŸ‡ª"),13:new N(13,"Hungary","HU","HUN","ğŸ‡­ğŸ‡º"),14:new N(14,"China","CN","CHN","ğŸ‡¨ğŸ‡³"),15:new N(15,"Spain","ES","ESP","ğŸ‡ªğŸ‡¸"),23:new N(23,"Canada","CA","CAN","ğŸ‡¨ğŸ‡¦"),24:new N(24,"USA","US","USA","ğŸ‡ºğŸ‡¸"),26:new N(26,"Mexico","MX","MEX","ğŸ‡²ğŸ‡½"),27:new N(27,"Argentina","AR","ARG","ğŸ‡¦ğŸ‡·"),28:new N(28,"Venezuela","VE","VEN","ğŸ‡»ğŸ‡ª"),29:new N(29,"United Kingdom","GB","GBR","ğŸ‡¬ğŸ‡§"),30:new N(30,"Switzerland","CH","CHE","ğŸ‡¨ğŸ‡­"),31:new N(31,"Netherlands","NL","NLD","ğŸ‡³ğŸ‡±"),32:new N(32,"Belgium","BE","BEL","ğŸ‡§ğŸ‡ª"),33:new N(33,"Austria","AT","AUT","ğŸ‡¦ğŸ‡¹"),34:new N(34,"Czech Republic","CZ","CZE","ğŸ‡¨ğŸ‡¿"),35:new N(35,"Poland","PL","POL","ğŸ‡µğŸ‡±"),36:new N(36,"Slovakia","SK","SVK","ğŸ‡¸ğŸ‡°"),37:new N(37,"Norway","NO","NOR","ğŸ‡³ğŸ‡´"),38:new N(38,"Sweden","SE","SWE","ğŸ‡¸ğŸ‡ª"),39:new N(39,"Finland","FI","FIN","ğŸ‡«ğŸ‡®"),40:new N(40,"Ukraine","UA","UKR","ğŸ‡ºğŸ‡¦"),41:new N(41,"Russia","RU","RUS","ğŸ‡·ğŸ‡º"),42:new N(42,"Bulgaria","BG","BGR","ğŸ‡§ğŸ‡¬"),43:new N(43,"Turkey","TR","TUR","ğŸ‡¹ğŸ‡·"),44:new N(44,"Greece","GR","GRC","ğŸ‡¬ğŸ‡·"),45:new N(45,"Japan","JP","JPN","ğŸ‡¯ğŸ‡µ"),47:new N(47,"South Korea","KR","KOR","ğŸ‡°ğŸ‡·"),48:new N(48,"India","IN","IND","ğŸ‡®ğŸ‡³"),49:new N(49,"Indonesia","ID","IDN","ğŸ‡®ğŸ‡©"),50:new N(50,"Australia","AU","AUS","ğŸ‡¦ğŸ‡º"),51:new N(51,"South Africa","ZA","ZAF","ğŸ‡¿ğŸ‡¦"),52:new N(52,"Republic of Moldova","MD","MDA","ğŸ‡²ğŸ‡©"),53:new N(53,"Portugal","PT","PRT","ğŸ‡µğŸ‡¹"),54:new N(54,"Ireland","IE","IRL","ğŸ‡®ğŸ‡ª"),55:new N(55,"Denmark","DK","DNK","ğŸ‡©ğŸ‡°"),56:new N(56,"Iran","IR","IRN","ğŸ‡®ğŸ‡·"),57:new N(57,"Pakistan","PK","PAK","ğŸ‡µğŸ‡°"),58:new N(58,"Israel","IL","ISR","ğŸ‡®ğŸ‡±"),59:new N(59,"Thailand","TH","THA","ğŸ‡¹ğŸ‡­"),61:new N(61,"Slovenia","SI","SVN","ğŸ‡¸ğŸ‡®"),63:new N(63,"Croatia","HR","HRV","ğŸ‡­ğŸ‡·"),64:new N(64,"Chile","CL","CHL","ğŸ‡¨ğŸ‡±"),65:new N(65,"Serbia","RS","SRB","ğŸ‡·ğŸ‡¸"),66:new N(66,"Malaysia","MY","MYS","ğŸ‡²ğŸ‡¾"),67:new N(67,"Philippines","PH","PHL","ğŸ‡µğŸ‡­"),68:new N(68,"Singapore","SG","SGP","ğŸ‡¸ğŸ‡¬"),69:new N(69,"Bosnia and Herzegovina","BA","BIH","ğŸ‡§ğŸ‡¦"),70:new N(70,"Estonia","EE","EST","ğŸ‡ªğŸ‡ª"),71:new N(71,"Latvia","LV","LVA","ğŸ‡±ğŸ‡»"),72:new N(72,"Lithuania","LT","LTU","ğŸ‡±ğŸ‡¹"),73:new N(73,"North Korea","KP","PRK","ğŸ‡°ğŸ‡µ"),74:new N(74,"Uruguay","UY","URY","ğŸ‡ºğŸ‡¾"),75:new N(75,"Paraguay","PY","PRY","ğŸ‡µğŸ‡¾"),76:new N(76,"Bolivia","BO","BOL","ğŸ‡§ğŸ‡´"),77:new N(77,"Peru","PE","PER","ğŸ‡µğŸ‡ª"),78:new N(78,"Colombia","CO","COL","ğŸ‡¨ğŸ‡´"),79:new N(79,"North Macedonia","MK","MKD","ğŸ‡²ğŸ‡°"),80:new N(80,"Montenegro","ME","MNE","ğŸ‡²ğŸ‡ª"),81:new N(81,"Republic of China (Taiwan)","TW","TWN","ğŸ‡¹ğŸ‡¼"),82:new N(82,"Cyprus","CY","CYP","ğŸ‡¨ğŸ‡¾"),83:new N(83,"Belarus","BY","BLR","ğŸ‡§ğŸ‡¾"),84:new N(84,"New Zealand","NZ","NZL","ğŸ‡³ğŸ‡¿"),164:new N(164,"Saudi Arabia","SA","SAU","ğŸ‡¸ğŸ‡¦"),165:new N(165,"Egypt","EG","EGY","ğŸ‡ªğŸ‡¬"),166:new N(166,"United Arab Emirates","AE","ARE","ğŸ‡¦ğŸ‡ª"),167:new N(167,"Albania","AL","ALB","ğŸ‡¦ğŸ‡±"),168:new N(168,"Georgia","GE","GEO","ğŸ‡¬ğŸ‡ª"),169:new N(169,"Armenia","AM","ARM","ğŸ‡¦ğŸ‡²"),170:new N(170,"Nigeria","NG","NGA","ğŸ‡³ğŸ‡¬"),171:new N(171,"Cuba","CU","CUB","ğŸ‡¨ğŸ‡º")};class j extends C{constructor(t){super("ip-location","IP Location",t,!1),this.ipLocationContainer=null,this.isEnabled()&&this.showIpLocation()}onStateChanged(){this.isEnabled()?this.showIpLocation():this.hideIpLocation()}async showIpLocation(){try{const t=A();this.ipLocationContainer||(this.ipLocationContainer=document.createElement("div"),this.ipLocationContainer.id="ptnpnh-ip-location-container",this.ipLocationContainer.innerHTML='<div class="ptnpnh-ip-location-container">\n  <span class="ptnpnh-ip-location-info"></span>\n</div>'),document.getElementById("ptnpnh-ip-location-container")||t.appendChild(this.ipLocationContainer)}catch(t){return void w("Error showing IP location",t)}try{const t=await this.fetchIpInfo();this.updateIpLocationInfo(t)}catch(t){w("Failed to fetch IP info",t)}}async fetchIpInfo(){const t=await fetch("https://ipinfo.io/json");if(!t.ok)throw new Error(`Failed to fetch IP info: ${t.statusText}`);return await t.json()}updateIpLocationInfo(t){if(!this.ipLocationContainer||!t)return;const e=this.ipLocationContainer.querySelector(".ptnpnh-ip-location-info");if(e){const n=function(t){const e=t.toUpperCase();return Object.values(O).find((t=>t.code2===e))}(t.country);e.textContent=`${t.ip} ${n?.emoji||"ğŸŒ"}`}}hideIpLocation(){this.ipLocationContainer&&(this.ipLocationContainer.remove(),this.ipLocationContainer=null)}}class U extends C{constructor(t){super("remove-annoying-popups","Remove Annoying Popups",t,!0),this.annoyingElements=[{type:"id",value:"ErpkPopupPromosControllerPopup"},{type:"selector",value:".lb_overlay.js_lb_overlay"},{type:"selector",value:"div[class='blockUI blockOverlay']"},{type:"selector",value:"div[class='blockUI blockMsg blockElement']"}],this.isEnabled()&&this.removeAnnoyingPopups()}onStateChanged(){this.isEnabled()&&this.removeAnnoyingPopups()}removeAnnoyingPopups(){const t=()=>{for(const t of this.annoyingElements){let e=[];if("id"===t.type){const n=document.getElementById(t.value);n&&e.push(n)}else if("class"===t.type){const n=document.getElementsByClassName(t.value);e=Array.from(n)}else if("selector"===t.type){const n=document.querySelectorAll(t.value);e=Array.from(n)}for(const t of e)t.remove()}};t();const e=new MutationObserver((e=>{for(const n of e)if("childList"===n.type&&n.addedNodes.length>0){let e=!1;for(const t of this.annoyingElements){if("id"===t.type&&document.getElementById(t.value)){e=!0;break}if("class"===t.type&&document.getElementsByClassName(t.value).length>0){e=!0;break}if("selector"===t.type&&document.querySelectorAll(t.value).length>0){e=!0;break}}if(e){t();break}}}));try{e.observe(document.body,{childList:!0,subtree:!0})}catch(t){w("Failed to set up observer for annoying elements removal",t)}}}var $=n(54),_={};_.styleTagTransform=g(),_.setAttributes=d(),_.insert=l().bind(null,"head"),_.domAPI=o(),_.insertStyleElement=p();s()($.A,_);$.A&&$.A.locals&&$.A.locals;class H extends C{constructor(t){super("filter-posts","Filter Posts",t,!1),this.keywords=[],this.observer=null,t.hasConfig(this.getId())||this.saveState(),this.keywords=this.loadKeywords(),this.isEnabled()&&this.applyFilters()}loadKeywords(){const t=this.settingsStorage.configFor(this.getId());return t&&t.keywords?t.keywords:[]}getKeywords(){return this.keywords.join("\n")}setKeywords(t){this.keywords=t.split("\n").filter((t=>""!==t.trim())),this.settingsStorage.save(this.getId(),{keywords:this.keywords}),this.isEnabled()&&this.applyFilters()}onStateChanged(){this.isEnabled()?this.applyFilters():this.removeFilters()}applyFilters(){this.filterPosts(),this.setupObserver()}removeFilters(){this.observer&&(this.observer.disconnect(),this.observer=null);document.querySelectorAll(".postContainer.ptnpnh-hidden-post").forEach((t=>{t.classList.remove("ptnpnh-hidden-post")}))}filterPosts(){if(0===this.keywords.length)return;document.querySelectorAll(".postContainer").forEach((t=>{this.checkAndFilterPost(t)}))}checkAndFilterPost(t){const e=t.querySelector("h6"),n=t.querySelector("p.contentMessage");if(!e||!n)return;const i=e.textContent||"",s=n.textContent||"";this.keywords.some((t=>i.toLowerCase().includes(t.toLowerCase())||s.toLowerCase().includes(t.toLowerCase())))?t.classList.add("ptnpnh-hidden-post"):t.classList.remove("ptnpnh-hidden-post")}setupObserver(){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver((t=>{let e=!1;t.forEach((t=>{"childList"===t.type&&t.addedNodes.length>0&&(e=!0)})),e&&this.filterPosts()}));const t=document.querySelector(".postsWrapper");t?(y("FilterPostsFeature: Observing postsWrapper for changes"),this.observer.observe(t,{childList:!0,subtree:!0})):y("FilterPostsFeature: No postsWrapper found to observe")}hasConfigurationUI(){return!0}createConfigurationUI(t){const e=document.createElement("div");e.innerHTML='<div class="ptnpnh-config-container ptnpnh-config-container-vertical">\n  <label for="keywords-filter-posts" class="ptnpnh-config-label">Enter keywords to filter posts (one per line):</label>\n  <textarea id="keywords-filter-posts" class="ptnpnh-config-textarea" rows="5"></textarea>\n</div>\n';const n=e.firstChild,i=n.querySelector("textarea");return i&&(i.value=this.getKeywords(),i.addEventListener("change",(()=>{this.setKeywords(i.value)}))),t.appendChild(n),!0}}var q=n(98),z={};z.styleTagTransform=g(),z.setAttributes=d(),z.insert=l().bind(null,"head"),z.domAPI=o(),z.insertStyleElement=p();s()(q.A,z);q.A&&q.A.locals&&q.A.locals;class X extends C{constructor(t){super("active-battles","Active Battles",t,!1),this.dialogContainer=null,this.isDragging=!1,this.dragOffsetX=0,this.dragOffsetY=0,this.lastUpdateTime=0,this.updateTimer=null,this.isManualRefresh=!1,this.activeBattles={},this.battleListData=null,this.isEnabled()&&this.showActiveBattles()}onStateChanged(){this.isEnabled()?this.showActiveBattles():this.hideActiveBattles()}startUpdateTimer(){this.clearUpdateTimer(),this.updateTimer=window.setInterval((()=>{this.updateElapsedTimeDisplay()}),6e4),this.updateElapsedTimeDisplay()}clearUpdateTimer(){null!==this.updateTimer&&(clearInterval(this.updateTimer),this.updateTimer=null)}updateElapsedTimeDisplay(){if(!this.dialogContainer||0===this.lastUpdateTime)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-last-update");if(!t)return;const e=Math.floor(Date.now()/1e3),n=e-this.lastUpdateTime;if(this.isManualRefresh)t.textContent=" (now)",n>=60&&(this.isManualRefresh=!1);else if(n>=60){const e=Math.floor(n/60);t.textContent=` (${e}m ago)`}else t.textContent=" (now)";if(this.activeBattles&&this.battleListData&&Object.keys(this.activeBattles).length>0&&this.battleListData){const t=this.battleListData.time;this.battleListData.time=e;const n=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(n),this.battleListData.time=t}}showActiveBattles(){if(!this.dialogContainer){this.dialogContainer=document.createElement("div"),this.dialogContainer.id="ptnpnh-active-battles-dialog",this.dialogContainer.innerHTML='<div class="ptnpnh-active-battles-container">\n  <div class="ptnpnh-active-battles-header">\n    <div>\n      Active battles\n      <span class="ptnpnh-active-battles-last-update"></span>\n    </div>\n    <span class="ptnpnh-active-battles-refresh"></span>\n  </div>\n  <div class="ptnpnh-active-battles-body"></div>\n</div>\n',this.setupRefreshIcon(),this.setupDraggable();const t=this.settingsStorage.configFor("active-battles-position");t&&(this.dialogContainer.style.left=`${t.left}px`,this.dialogContainer.style.top=`${t.top}px`,y("Restored active battles position:",t))}if(!document.getElementById("ptnpnh-active-battles-dialog")){try{A(),document.body.appendChild(this.dialogContainer)}catch(t){return void w("Error showing active battles dialog",t)}this.loadBattlesFromStorage(),this.startUpdateTimer()}}setupRefreshIcon(){if(!this.dialogContainer)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-refresh");t?(t.innerHTML='\n<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 32 32">\n<path d="M 15 3 C 12.053086 3 9.3294211 4.0897803 7.2558594 5.8359375 A 1.0001 1.0001 0 1 0 8.5449219 7.3652344 C 10.27136 5.9113916 12.546914 5 15 5 C 20.226608 5 24.456683 8.9136179 24.951172 14 L 22 14 L 26 20 L 30 14 L 26.949219 14 C 26.441216 7.8348596 21.297943 3 15 3 z M 4.3007812 9 L 0.30078125 15 L 3 15 C 3 21.635519 8.3644809 27 15 27 C 17.946914 27 20.670579 25.91022 22.744141 24.164062 A 1.0001 1.0001 0 1 0 21.455078 22.634766 C 19.72864 24.088608 17.453086 25 15 25 C 9.4355191 25 5 20.564481 5 15 L 8.3007812 15 L 4.3007812 9 z"></path>\n</svg>\n',t.addEventListener("click",(t=>{t.stopPropagation(),y("Refresh icon clicked"),this.isManualRefresh=!0,this.fetchActiveBattles()}))):w("Refresh icon element not found")}hideActiveBattles(){this.clearUpdateTimer(),this.dialogContainer&&(this.dialogContainer.remove(),this.dialogContainer=null)}setupDraggable(){if(!this.dialogContainer)return;const t=this.dialogContainer.querySelector(".ptnpnh-active-battles-header");t?(t.addEventListener("mousedown",this.onDragStart.bind(this)),document.addEventListener("mousemove",this.onDragMove.bind(this)),document.addEventListener("mouseup",this.onDragEnd.bind(this)),t.addEventListener("touchstart",this.onTouchStart.bind(this)),document.addEventListener("touchmove",this.onTouchMove.bind(this)),document.addEventListener("touchend",this.onDragEnd.bind(this))):w("Active battles header not found")}onDragStart(t){this.dialogContainer&&(this.isDragging=!0,this.dragOffsetX=t.clientX-this.dialogContainer.offsetLeft,this.dragOffsetY=t.clientY-this.dialogContainer.offsetTop,t.preventDefault())}onTouchStart(t){this.dialogContainer&&0!==t.touches.length&&(this.isDragging=!0,this.dragOffsetX=t.touches[0].clientX-this.dialogContainer.offsetLeft,this.dragOffsetY=t.touches[0].clientY-this.dialogContainer.offsetTop,t.preventDefault())}onDragMove(t){if(!this.isDragging||!this.dialogContainer)return;const e=t.clientX-this.dragOffsetX,n=t.clientY-this.dragOffsetY;this.updatePosition(e,n)}onTouchMove(t){if(!this.isDragging||!this.dialogContainer||0===t.touches.length)return;const e=t.touches[0].clientX-this.dragOffsetX,n=t.touches[0].clientY-this.dragOffsetY;this.updatePosition(e,n),t.preventDefault()}onDragEnd(){if(this.isDragging=!1,this.dialogContainer){const t=parseInt(this.dialogContainer.style.left)||100,e=parseInt(this.dialogContainer.style.top)||100;this.settingsStorage.save("active-battles-position",{left:t,top:e}),y("Saved active battles position:",{left:t,top:e})}}updatePosition(t,e){if(!this.dialogContainer)return;const n=window.innerWidth-this.dialogContainer.offsetWidth,i=window.innerHeight-this.dialogContainer.offsetHeight,s=Math.max(0,Math.min(t,n)),a=Math.max(0,Math.min(e,i));this.dialogContainer.style.left=`${s}px`,this.dialogContainer.style.top=`${a}px`}loadBattlesFromStorage(){const t=this.settingsStorage.configFor("active-battles-data");if(!t)return void this.fetchActiveBattles();this.lastUpdateTime=t.lastUpdateTime,this.activeBattles=t.activeBattles,this.battleListData=t.battleListData;const e=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(e),this.updateElapsedTimeDisplay(),y("Loaded battles from storage, last updated at:",new Date(1e3*this.lastUpdateTime).toLocaleString())}async fetchActiveBattles(){try{this.isManualRefresh=!0,this.updateBattlesList("Loading...");const t=await fetch("https://www.erepublik.com/en/military/campaignsJson/citizen",{headers:{accept:"application/json, text/plain, */*",referer:"https://www.erepublik.com/en/military/campaigns","x-requested-with":"XMLHttpRequest"},credentials:"include"});if(!t.ok)throw new Error(`Failed to fetch citizen battles: ${t.status}`);const e=await t.json();if(y("Citizen battles data:",e),this.activeBattles=this.findActiveBattles(e),y("Active battles:",this.activeBattles),0===Object.keys(this.activeBattles).length)return this.lastUpdateTime=Math.floor(Date.now()/1e3),this.settingsStorage.save("active-battles-data",{activeBattles:{},battleListData:this.battleListData||null,lastUpdateTime:this.lastUpdateTime}),this.updateBattlesList("No active battles found"),this.updateElapsedTimeDisplay(),void this.startUpdateTimer();const n=await fetch("https://www.erepublik.com/en/military/campaignsJson/list",{headers:{accept:"application/json, text/plain, */*",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest"},credentials:"include"});if(!n.ok)throw new Error(`Failed to fetch battle list: ${n.status}`);this.battleListData=await n.json(),y("Battle list data:",this.battleListData),this.lastUpdateTime=Math.floor(Date.now()/1e3),this.settingsStorage.save("active-battles-data",{activeBattles:this.activeBattles,battleListData:this.battleListData,lastUpdateTime:this.lastUpdateTime}),y("Saved battles to storage at:",new Date(1e3*this.lastUpdateTime).toLocaleString());const i=this.generateBattleLinks(this.activeBattles,this.battleListData);this.updateBattlesList(i),this.updateElapsedTimeDisplay(),this.startUpdateTimer()}catch(t){w("Error fetching active battles:",t),this.updateBattlesList("Error loading battles. Please try again.")}}findActiveBattles(t){const e={};for(const n in t.battles){const i=t.battles[n];for(const t in i.citizenStats){const s=i.citizenStats[t];s.activeZones&&s.activeZones.length>0&&(e[n]||(e[n]={}),e[n][t]=s.activeZones)}}return e}generateBattleLinks(t,e){let n="";for(const i in t){const s=e.battles[i];if(!s)continue;const a=s.start,o=e.time-a,r=Math.floor(o/60);if(r>120){y(`Skipping battle ${i} as it's ${r} minutes old (max: 120)`);continue}const l=s.region.name,c=`${r}m`;for(const e in t[i]){const a=parseInt(e,10),o=O[a],r=o?o.emoji:"",d=t[i][e];for(const t of d){const e=t.toString(),a=s.div[e];if(a&&!a.division_end){n+=`<a href="https://www.erepublik.com/en/military/battlefield/${i}/${t}" target="_blank">${l} (${r} D${a.div}, ${c})</a>`}}}}return n||"No active battles found"}updateBattlesList(t){if(!this.dialogContainer)return;const e=this.dialogContainer.querySelector(".ptnpnh-active-battles-body");e&&(e.innerHTML=t)}}var Y=n(247),G={};G.styleTagTransform=g(),G.setAttributes=d(),G.insert=l().bind(null,"head"),G.domAPI=o(),G.insertStyleElement=p();s()(Y.A,G);Y.A&&Y.A.locals&&Y.A.locals;function K(){try{return SERVER_DATA.csrfToken||""}catch(t){return w("Failed to get CSRF token",t),""}}class V extends C{constructor(t){super("daily-tasks","Daily Tasks",t,!1),this.taskContainer=null,this.runningTasks=!1,this.selectedTasks={work:!0,overtime:!0,train:!0,buyFood:!0,buyGold:!0,vip:!0},this.loadSelectedTasks(),this.isEnabled()&&this.showDailyTasks()}onStateChanged(){this.isEnabled()?this.showDailyTasks():this.hideDailyTasks()}showDailyTasks(){try{const t=A();this.taskContainer||(this.taskContainer=document.createElement("div"),this.taskContainer.id="ptnpnh-daily-tasks-container",this.taskContainer.className="ptnpnh-daily-tasks-container collapsed",this.taskContainer.innerHTML='<div class="ptnpnh-daily-tasks-container">\n  <div class="ptnpnh-daily-tasks-header">Daily Tasks <span class="ptnpnh-daily-tasks-toggle-icon">â–¼</span></div>\n  <div class="ptnpnh-daily-tasks-content">\n    <div class="ptnpnh-daily-tasks-status">\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-work">\n        <span class="ptnpnh-daily-tasks-icon">ğŸ’¼</span>\n        <span class="ptnpnh-daily-tasks-label">Work</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-work-status">â³</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-overtime">\n        <span class="ptnpnh-daily-tasks-icon">â±ï¸</span>\n        <span class="ptnpnh-daily-tasks-label">Overtime</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-overtime-status">â³</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-train">\n        <span class="ptnpnh-daily-tasks-icon">ğŸ’ª</span>\n        <span class="ptnpnh-daily-tasks-label">Train</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-train-status">â³</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-buy-food">\n        <span class="ptnpnh-daily-tasks-icon">ğŸ”</span>\n        <span class="ptnpnh-daily-tasks-label">Buy Food</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-buy-food-status">â³</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-buy-gold">\n        <span class="ptnpnh-daily-tasks-icon">ğŸª™</span>\n        <span class="ptnpnh-daily-tasks-label">Buy Gold</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-buy-gold-status">â³</span>\n      </div>\n      <div class="ptnpnh-daily-tasks-item" id="ptnpnh-daily-task-vip">\n        <span class="ptnpnh-daily-tasks-icon">ğŸŒŸ</span>\n        <span class="ptnpnh-daily-tasks-label">VIP Points</span>\n        <span class="ptnpnh-daily-tasks-status-icon" id="ptnpnh-daily-task-vip-status">â³</span>\n      </div>\n    </div>\n    <div class="ptnpnh-daily-tasks-selection">\n      <div class="ptnpnh-daily-tasks-selection-header">Select tasks to run:</div>\n      <div class="ptnpnh-daily-tasks-selection-items">\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-work-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-work-checkbox">Work</label>\n        </div>\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-overtime-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-overtime-checkbox">Overtime</label>\n        </div>\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-train-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-train-checkbox">Train</label>\n        </div>\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-buy-food-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-buy-food-checkbox">Buy Food</label>\n        </div>\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-buy-gold-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-buy-gold-checkbox">Buy Gold</label>\n        </div>\n        <div class="ptnpnh-daily-tasks-selection-item">\n          <input type="checkbox" id="ptnpnh-daily-task-vip-checkbox" class="ptnpnh-daily-tasks-checkbox" checked>\n          <label for="ptnpnh-daily-task-vip-checkbox">VIP Points</label>\n        </div>\n      </div>\n    </div>\n    <div class="ptnpnh-daily-tasks-actions">\n      <button class="ptnpnh-daily-tasks-button" id="ptnpnh-daily-tasks-run-all">Run Selected Tasks</button>\n    </div>\n  </div>\n</div>\n'),document.getElementById("ptnpnh-daily-tasks-container")||t.appendChild(this.taskContainer)}catch(t){return void w("Error showing daily tasks",t)}const t=document.querySelector(".ptnpnh-daily-tasks-header");t&&t.addEventListener("click",(()=>{this.taskContainer?.classList.toggle("collapsed")}));const e=document.getElementById("ptnpnh-daily-tasks-run-all");e&&e.addEventListener("click",(()=>this.runAllTasks()))}hideDailyTasks(){this.taskContainer&&(this.taskContainer.remove(),this.taskContainer=null)}loadSelectedTasks(){const t=this.settingsStorage.configFor(this.getId());t&&t.selectedTasks&&(this.selectedTasks=t.selectedTasks)}saveSelectedTasks(){const t=this.settingsStorage.configFor(this.getId())||{};t.selectedTasks=this.selectedTasks,this.settingsStorage.save(this.getId(),t)}async runAllTasks(){if(this.runningTasks)this.showNotification("Tasks are already running","error");else{this.runningTasks=!0,this.updateAllTaskStatus("â³");try{await this.work(),await this.delay(2e3),await this.workOvertime(),await this.delay(2e3),await this.train(),await this.delay(2e3),await this.buyFood(),await this.delay(2e3),await this.buyGold(),await this.delay(2e3),await this.claimVIPPoints(),this.showNotification("All daily tasks completed!","success")}catch(t){w("Error running daily tasks",t),this.showNotification("Error running daily tasks","error")}finally{this.runningTasks=!1}}}async work(){this.updateTaskStatus("work","â³");try{const t=await this.fetchJobData();if(!t.isEmployee)return this.updateTaskStatus("work","âŒ"),void this.showNotification("You don't have a job","error");if(t.alreadyWorked)return this.updateTaskStatus("work","âœ…"),void this.showNotification("You already worked today","success");const e=await this.performWork();e.status?(this.updateTaskStatus("work","âœ…"),this.showNotification(`Worked for ${e.result.netSalary} ${e.result.currency}`,"success")):(this.updateTaskStatus("work","âŒ"),this.showNotification("Failed to work","error"))}catch(t){w("Error working",t),this.updateTaskStatus("work","âŒ"),this.showNotification("Error working","error")}}async workOvertime(){this.updateTaskStatus("overtime","â³");try{const t=await this.fetchJobData();if(!t.isEmployee)return this.updateTaskStatus("overtime","âŒ"),void this.showNotification("You don't have a job","error");if(0!==t.overTime.nextOverTime)return this.updateTaskStatus("overtime","âœ…"),void this.showNotification("You already worked overtime today","success");const e=await this.performWorkOvertime();e.status?(this.updateTaskStatus("overtime","âœ…"),this.showNotification(`Worked overtime for ${e.result.netSalary} ${e.result.currency}`,"success")):(this.updateTaskStatus("overtime","âŒ"),this.showNotification("Failed to work overtime","error"))}catch(t){w("Error working overtime",t),this.updateTaskStatus("overtime","âŒ"),this.showNotification("Error working overtime","error")}}async train(){this.updateTaskStatus("train","â³");try{const t=await this.fetchTrainingData();if(!t.can_train)return this.updateTaskStatus("train","âŒ"),void this.showNotification("You can't train right now","error");const e=t.grounds.map((t=>t.id)),n=await this.performTraining(e);n.status?(this.updateTaskStatus("train","âœ…"),this.showNotification(`Trained for ${n.result.strength_bonus} strength points`,"success")):(this.updateTaskStatus("train","âŒ"),this.showNotification("Failed to train","error"))}catch(t){w("Error training",t),this.updateTaskStatus("train","âŒ"),this.showNotification("Error training","error")}}async buyFood(){this.updateTaskStatus("buy-food","â³");try{const t=this.getCitizenshipCountryId();if(!t)return this.updateTaskStatus("buy-food","âŒ"),void this.showNotification("Failed to get citizenship country ID","error");const e=await this.fetchFoodOffers(t);if(!e.can_buy||0===e.offers.length)return this.updateTaskStatus("buy-food","âŒ"),void this.showNotification("No food offers available","error");const n=e.offers[0],i=await this.buyFoodItem(n.id);i.error?(this.updateTaskStatus("buy-food","âŒ"),this.showNotification("Failed to buy food","error")):(this.updateTaskStatus("buy-food","âœ…"),this.showNotification(i.message,"success"))}catch(t){w("Error buying food",t),this.updateTaskStatus("buy-food","âŒ"),this.showNotification("Error buying food","error")}}async buyGold(){this.updateTaskStatus("buy-gold","â³");let t=0,e=!1;for(;t<5&&!e;){t++;try{const n=await this.fetchGoldOffersHtml(),i=this.parseGoldOfferIdFromHtml(n);if(!i){5===t?(this.updateTaskStatus("buy-gold","âŒ"),this.showNotification("No gold offers available after multiple attempts","error")):(this.showNotification(`No gold offers available, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3));continue}const s=await this.buyGoldOffer(i);if(s.error){if(s.message&&s.message.includes("You already reached the maximum limit"))return this.updateTaskStatus("buy-gold","âœ…"),void this.showNotification(s.message,"warning");if(!s.message||!s.message.includes("You cannot buy more than the offered amount")&&!s.message.includes("This exchange offer does not exist"))return this.updateTaskStatus("buy-gold","âŒ"),void this.showNotification(`Failed to buy gold: ${s.message}`,"error");5===t?(this.updateTaskStatus("buy-gold","âŒ"),this.showNotification(`Failed to buy gold after 5 attempts: ${s.message}`,"error")):(this.showNotification(`${s.message}, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3))}else e=!0,this.updateTaskStatus("buy-gold","âœ…"),this.showNotification(s.message,"success")}catch(e){w(`Error buying gold (attempt ${t}/5)`,e),5===t?(this.updateTaskStatus("buy-gold","âŒ"),this.showNotification("Error buying gold after multiple attempts","error")):(this.showNotification(`Error buying gold, retrying (attempt ${t}/5)`,"info"),await this.delay(2e3))}}}async claimVIPPoints(){this.updateTaskStatus("vip","â³");try{const t=await this.claimVIP();!1===t.can_claim&&t.today_points>0?(this.updateTaskStatus("vip","âœ…"),this.showNotification(`Already claimed ${t.today_points} VIP points today`,"success")):!1===t.can_claim?(this.updateTaskStatus("vip","âŒ"),this.showNotification("No VIP points to claim","error")):(this.updateTaskStatus("vip","âœ…"),this.showNotification(`Claimed ${t.today_points} VIP points`,"success"))}catch(t){w("Error claiming VIP points",t),this.updateTaskStatus("vip","âŒ"),this.showNotification("Error claiming VIP points","error")}}async fetchJobData(){const t=await fetch("https://www.erepublik.com/en/main/job-data",{headers:{accept:"application/json, text/plain, */*",referer:"https://www.erepublik.com/en/economy/myCompanies","x-requested-with":"XMLHttpRequest"}});return await t.json()}async performWork(){const t=new URLSearchParams;t.append("_token",K()),t.append("action_type","work");const e=await fetch("https://www.erepublik.com/en/economy/work",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en/economy/myCompanies","x-requested-with":"XMLHttpRequest"},body:t});return await e.json()}async performWorkOvertime(){const t=new URLSearchParams;t.append("_token",K()),t.append("action_type","workOvertime");const e=await fetch("https://www.erepublik.com/en/economy/workOvertime",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en/economy/myCompanies","x-requested-with":"XMLHttpRequest"},body:t});return await e.json()}async fetchTrainingData(){const t=await fetch("https://www.erepublik.com/en/main/training-grounds-json",{headers:{accept:"application/json, text/plain, */*",referer:"https://www.erepublik.com/en/economy/training-grounds","x-requested-with":"XMLHttpRequest"}});return await t.json()}async performTraining(t){const e=new URLSearchParams;t.forEach(((t,n)=>{e.append(`grounds[${n}][id]`,t.toString()),e.append(`grounds[${n}][train]`,"1")})),e.append("_token",K());const n=await fetch("https://www.erepublik.com/en/economy/train",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en/economy/training-grounds","x-requested-with":"XMLHttpRequest"},body:e});return await n.json()}getCitizenshipCountryId(){try{return erepublik.citizen.citizenshipCountryId||null}catch(t){return w("Failed to get citizenship country ID",t),null}}async fetchFoodOffers(t){const e=new URLSearchParams;e.append("countryId",t.toString()),e.append("industryId","1"),e.append("quality","1"),e.append("orderBy","price_asc"),e.append("currentPage","1"),e.append("ajaxMarket","1"),e.append("_token",K());const n=await fetch("https://www.erepublik.com/en/economy/marketplaceAjax",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en/economy/marketplace","x-requested-with":"XMLHttpRequest"},body:e});return await n.json()}async buyFoodItem(t){const e=new URLSearchParams;e.append("offerId",t.toString()),e.append("amount","1"),e.append("orderBy","price_asc"),e.append("currentPage","1"),e.append("buyAction","1"),e.append("_token",K());const n=await fetch("https://www.erepublik.com/en/economy/marketplaceActions",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en/economy/marketplace","x-requested-with":"XMLHttpRequest"},body:e});return await n.json()}async fetchGoldOffersHtml(){const t=await fetch("https://www.erepublik.com/en/economy/exchange-market/",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",referer:"https://www.erepublik.com/en/economy/marketplace","x-requested-with":"XMLHttpRequest"}});return await t.text()}parseGoldOfferIdFromHtml(t){try{const e=new DOMParser,n=e.parseFromString(t,"text/html").querySelectorAll(".exchange_offers tr");for(const t of n){const e=t.querySelector(".ex_amount strong span");if(e){if(parseFloat(e.textContent||"0")>=10){const e=t.querySelector('button[id^="purchase_"]');if(e){const t=e.getAttribute("id"),n=t?.match(/^purchase_(\d+)$/);if(n&&n[1])return n[1]}}}}return null}catch(t){return w("Error parsing gold offers HTML",t),null}}async buyGoldOffer(t){const e=new URLSearchParams;e.append("_token",K()),e.append("offerId",t),e.append("amount","10"),e.append("page","0"),e.append("currencyId","62");const n=await fetch("https://www.erepublik.com/en/economy/exchange/purchase/",{method:"POST",headers:{accept:"application/json, text/javascript, */*; q=0.01","content-type":"application/x-www-form-urlencoded; charset=UTF-8",referer:"https://www.erepublik.com/en/economy/exchange-market/","x-requested-with":"XMLHttpRequest"},body:e});return await n.json()}async claimVIP(){const t=new URLSearchParams;t.append("_token",K());const e=await fetch("https://www.erepublik.com/en/main/vip-claim",{method:"POST",headers:{accept:"*/*","content-type":"application/x-www-form-urlencoded; charset=UTF-8",referer:"https://www.erepublik.com/en/main/vip-shop","x-requested-with":"XMLHttpRequest"},body:t});return await e.json()}updateTaskStatus(t,e){const n=document.getElementById(`ptnpnh-daily-task-${t}-status`);n&&(n.textContent=e,n.classList.remove("ptnpnh-daily-tasks-success","ptnpnh-daily-tasks-error","ptnpnh-daily-tasks-pending"),"âœ…"===e?n.classList.add("ptnpnh-daily-tasks-success"):"âŒ"===e?n.classList.add("ptnpnh-daily-tasks-error"):n.classList.add("ptnpnh-daily-tasks-pending"))}updateAllTaskStatus(t){this.updateTaskStatus("work",t),this.updateTaskStatus("overtime",t),this.updateTaskStatus("train",t),this.updateTaskStatus("buy-food",t),this.updateTaskStatus("buy-gold",t),this.updateTaskStatus("vip",t)}showNotification(t,e="info"){let n=document.getElementById("ptnpnh-notification-container");n||(n=document.createElement("div"),n.id="ptnpnh-notification-container",document.body.appendChild(n));const i=document.createElement("div");i.className=`ptnpnh-notification ptnpnh-notification-${e}`,i.textContent=t,n.appendChild(i),setTimeout((()=>{i.remove(),n&&0===n.children.length&&n.remove()}),15e3),"error"===e?w(t):y("warning"===e?`WARNING: ${t}`:t)}delay(t){return new Promise((e=>setTimeout(e,t)))}}var W=n(133),J={};J.styleTagTransform=g(),J.setAttributes=d(),J.insert=l().bind(null,"head"),J.domAPI=o(),J.insertStyleElement=p();s()(W.A,J);W.A&&W.A.locals&&W.A.locals;class Z extends C{constructor(t){super("daily-challenge","Daily Challenge",t,!0),this.container=null,this.collectButton=null,this.isEnabled()&&this.showDailyChallenge()}onStateChanged(){this.isEnabled()?this.showDailyChallenge():this.hideDailyChallenge()}showDailyChallenge(){try{const t=A(),e=document.getElementById("ptnpnh-daily-challenge-container");e&&!this.container&&e.remove(),document.getElementById("ptnpnh-daily-challenge-container")?this.collectButton||(this.collectButton=document.getElementById("ptnpnh-daily-challenge-collect-rewards"),this.collectButton&&this.collectButton.addEventListener("click",(()=>{this.collectRewards()}))):(this.container=document.createElement("div"),this.container.id="ptnpnh-daily-challenge-container",this.container.innerHTML='<button class="ptnpnh-daily-challenge-button" id="ptnpnh-daily-challenge-collect-rewards">Collect Rewards</button>\n',t.appendChild(this.container),this.collectButton=document.getElementById("ptnpnh-daily-challenge-collect-rewards"),this.collectButton&&this.collectButton.addEventListener("click",(()=>{this.collectRewards()})))}catch(t){w("Failed to show daily challenge",t)}}hideDailyChallenge(){const t=document.getElementById("ptnpnh-daily-challenge-container");t&&t.remove(),this.container=null,this.collectButton=null}async collectRewards(){if(this.collectButton)try{this.collectButton.setAttribute("disabled","true"),this.updateMessage("Checking daily missions...","pending"),await this.processDailyRewards(),await this.processWeeklyRewards()}catch(t){w("Error collecting rewards",t),this.updateMessage("Error collecting rewards","error")}finally{this.collectButton.removeAttribute("disabled")}}async processDailyRewards(){if(!this.collectButton)return;const t=await this.fetchDailyMissionsData();if(!t||!t.missions||!Array.isArray(t.missions))return this.updateMessage("Failed to fetch daily missions data.","error"),void this.collectButton.removeAttribute("disabled");const e=t.missions.filter((t=>t.progress&&t.progress.length>0&&t.progress[0].completed));if(0===e.length)return this.updateMessage("No completed missions found.","info"),void this.collectButton.removeAttribute("disabled");this.updateMessage(`Found ${e.length} completed missions. Collecting...`,"pending");for(const t of e)await this.solveMission(t.id),await this.delay(700);this.updateMessage("Checking for extra rewards...","pending");const n=await this.fetchObjectiveStatus();if(!n||!n.status||!n.data)return this.updateMessage("Failed to fetch objective status.","error"),void this.collectButton.removeAttribute("disabled");const{progress:i,claimedObjectives:s}=n.status,a=Object.entries(n.data).filter((([t])=>parseInt(t,10)<=i&&(!s||!s[t]))).map((([t])=>parseInt(t,10)));if(0===a.length)return this.updateMessage("All rewards collected!","success"),void this.collectButton.removeAttribute("disabled");this.updateMessage(`Found ${a.length} extra rewards. Claiming...`,"pending");for(const t of a)await this.claimObjectiveReward(t),await this.delay(800)}async processWeeklyRewards(){if(!this.collectButton)return;this.updateMessage("Checking weekly rewards...","pending");const t=await this.fetchWeeklyChallengeData();if(!t||t.error||!t.rewards||!t.rewards.normal)return this.updateMessage("Failed to fetch weekly rewards data.","error"),void this.collectButton.removeAttribute("disabled");const e=t.rewards.normal.filter((t=>"completed"===t.status));if(0===e.length)return this.updateMessage("No completed weekly rewards found. All rewards collected!","success"),void this.collectButton.removeAttribute("disabled");const n=Math.max(...e.map((t=>t.id)));this.updateMessage(`Found ${e.length} weekly rewards. Collecting...`,"pending");await this.collectWeeklyRewards(n)?this.updateMessage("All rewards collected!","success"):this.updateMessage("Daily rewards collected, but weekly rewards collection failed.","error")}async fetchDailyMissionsData(){try{const t=K(),e=await fetch("https://www.erepublik.com/en/main/daily-missions-data",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest",origin:"https://www.erepublik.com","sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty","user-agent":navigator.userAgent,"accept-language":navigator.language},body:`_token=${t}`,credentials:"include"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(t){return w("Failed to fetch daily missions data",t),{missions:[]}}}async solveMission(t){try{const e=K(),n=await fetch("https://www.erepublik.com/en/main/mission-solve",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest",origin:"https://www.erepublik.com","sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty","user-agent":navigator.userAgent,"accept-language":navigator.language},body:`_token=${e}&missionId=${t}`,credentials:"include"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);await n.json();return!0}catch(e){return w(`Failed to solve mission ${t}`,e),!1}}async fetchObjectiveStatus(){try{const t=K(),e=await fetch("https://www.erepublik.com/en/main/objective-status",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest",origin:"https://www.erepublik.com","sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty","user-agent":navigator.userAgent,"accept-language":navigator.language},body:`_token=${t}`,credentials:"include"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(t){return w("Failed to fetch objective status",t),null}}async claimObjectiveReward(t){try{const e=K(),n=await fetch("https://www.erepublik.com/en/main/objective-claim-reward",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest",origin:"https://www.erepublik.com","sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty","user-agent":navigator.userAgent,"accept-language":navigator.language},body:`_token=${e}&objectiveCost=${t}`,credentials:"include"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);await n.json();return!0}catch(e){return w(`Failed to claim objective reward ${t}`,e),!1}}updateMessage(t,e="info"){this.collectButton&&(this.collectButton.hasAttribute("data-original-text")||this.collectButton.setAttribute("data-original-text","Collect Rewards"),this.collectButton.textContent="info"===e?this.collectButton.getAttribute("data-original-text")||"Collect Rewards":t,this.collectButton.style.backgroundColor="success"===e?"#a5d1e5":"error"===e?"#ffcccc":"pending"===e?"#ffffcc":"#c8e3ef",y(`Daily Challenge: ${t}`))}delay(t){return new Promise((e=>setTimeout(e,t)))}async fetchWeeklyChallengeData(){try{const t=await fetch("https://www.erepublik.com/en/main/weekly-challenge-data",{method:"GET",headers:{accept:"application/json, text/plain, */*",referer:"https://www.erepublik.com/en","user-agent":navigator.userAgent,"accept-language":navigator.language},credentials:"include"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){return w("Failed to fetch weekly challenge data",t),null}}async collectWeeklyRewards(t){try{const e=K(),n=await fetch("https://www.erepublik.com/en/main/weekly-challenge-collect-all",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded",referer:"https://www.erepublik.com/en","x-requested-with":"XMLHttpRequest",origin:"https://www.erepublik.com","user-agent":navigator.userAgent,"accept-language":navigator.language},body:`maxRewardId=${t}&_token=${e}`,credentials:"include"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return!(await n.json()).error}catch(e){return w(`Failed to collect weekly rewards with maxRewardId ${t}`,e),!1}}}class Q{constructor(t){this.features=new Map,this.featureCategories=new Map,this.settingsStorage=t,this.initializeFeatures()}static getInstance(t){if(!Q.instance){if(!t)throw new Error("SettingsStorage must be provided when creating FeatureManager for the first time");Q.instance=new Q(t)}return Q.instance}initializeFeatures(){this.registerFeature(new E(this.settingsStorage),"general"),this.registerFeature(new S(this.settingsStorage),"general"),this.registerFeature(new T(this.settingsStorage),"general"),this.registerFeature(new B(this.settingsStorage),"general"),this.registerFeature(new M(this.settingsStorage),"general"),this.registerFeature(new j(this.settingsStorage),"general"),this.registerFeature(new U(this.settingsStorage),"general"),this.registerFeature(new H(this.settingsStorage),"social"),this.registerFeature(new X(this.settingsStorage),"military"),this.registerFeature(new V(this.settingsStorage),"economy"),this.registerFeature(new Z(this.settingsStorage),"economy")}registerFeature(t,e="general"){this.features.set(t.getId(),t),this.featureCategories.has(e)||this.featureCategories.set(e,[]),this.featureCategories.get(e).push(t.getId())}getFeature(t){return this.features.get(t)}getAllFeatures(){return Array.from(this.features.values())}getFeaturesByCategory(t){return(this.featureCategories.get(t)||[]).map((t=>this.features.get(t))).filter((t=>void 0!==t))}}class tt extends k{constructor(t){super("general","General",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";Q.getInstance().getFeaturesByCategory("general").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new x(t);e.appendChild(n.getElement())}}class et extends k{constructor(t){super("military","Military",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";Q.getInstance().getFeaturesByCategory("military").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new x(t);e.appendChild(n.getElement())}}class nt extends k{constructor(t){super("economy","Economy",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";Q.getInstance().getFeaturesByCategory("economy").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new x(t);e.appendChild(n.getElement())}}class it extends k{constructor(t){super("social","Social",t)}initialize(){const t=document.createElement("div");t.className="rows-container",t.style.width="100%";Q.getInstance().getFeaturesByCategory("social").forEach((e=>{this.addFeatureRow(e,t)})),this.content.appendChild(t)}addFeatureRow(t,e){let n=new x(t);e.appendChild(n.getElement())}}class st{constructor(t){this.isVisible=!1,this.settingsStorage=t,this.overlay=this.createOverlayElement(),this.dialog=this.createDialogElement(),this.setupEventListeners()}createOverlayElement(){const t=document.createElement("div");return t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.zIndex="2001",t}show(){this.isVisible||(document.body.appendChild(this.overlay),document.body.appendChild(this.dialog),this.isVisible=!0,y("Settings dialog opened"))}hide(){this.isVisible&&(document.body.removeChild(this.dialog),document.body.removeChild(this.overlay),this.isVisible=!1,y("Settings dialog closed"))}createDialogElement(){const t=document.createElement("div");t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="500px",t.style.height="400px",t.style.backgroundColor="#ffffff",t.style.borderRadius="10px",t.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",t.style.display="flex",t.style.flexDirection="column",t.style.zIndex="2002",t.style.overflow="hidden";const e=this.createHeaderElement(),n=this.createTitleElement(),i=this.createCloseBtn(),s=this.createContentElement();return e.appendChild(n),e.appendChild(i),t.appendChild(e),t.appendChild(s),this.tabController=new v(s),this.tabController.addTab(new tt(this.settingsStorage)),this.tabController.addTab(new et(this.settingsStorage)),this.tabController.addTab(new nt(this.settingsStorage)),this.tabController.addTab(new it(this.settingsStorage)),t}createHeaderElement(){const t=document.createElement("div");return t.style.display="flex",t.style.justifyContent="space-between",t.style.alignItems="center",t.style.padding="5px 16px",t.style.height="40px",t.style.boxSizing="border-box",t.style.borderBottom="1px solid #e8e8e8",t.style.backgroundColor="#f5f5f5",t}createTitleElement(){const t=document.createElement("h3");return t.textContent="erepa Settings",t.style.margin="0",t.style.fontSize="16px",t.style.fontWeight="500",t.style.borderBottom="none",t.style.paddingBottom="0",t}createCloseBtn(){const t=document.createElement("button");return t.textContent="Ã—",t.style.background="none",t.style.border="none",t.style.fontSize="20px",t.style.cursor="pointer",t.style.padding="0",t.style.lineHeight="1",t.style.color="#999",t.style.fontWeight="bold",t}createContentElement(){const t=document.createElement("div");return t.style.flex="1",t.style.display="flex",t.style.flexDirection="column",t.style.overflow="hidden",t}setupEventListeners(){const t=this.dialog.querySelector("button");t&&t.addEventListener("click",(()=>{this.hide()})),this.overlay.addEventListener("click",(()=>{this.hide()})),this.dialog.addEventListener("mousedown",(t=>{t.stopPropagation()}))}}class at{constructor(t){this.isDragging=!1,this.hasMoved=!1,this.offsetX=0,this.offsetY=0,this.STORAGE_KEY="openSettingsBtnPosition",this.settingsStorage=t,this.button=this.createButtonElement(),this.setupEventListeners()}render(t){const e=t.getBoundingClientRect(),n=this.settingsStorage.configFor(this.STORAGE_KEY);n?this.setPosition(n.left,n.top):this.setPosition(e.left+130,e.top+30),document.body.appendChild(this.button)}createButtonElement(){const t=document.createElement("button");return t.id="openSettingsBtn",t.style.width="24px",t.style.height="24px",t.style.borderRadius="50%",t.style.border="none",t.style.backgroundColor="#ffffff",t.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.2)",t.style.cursor="pointer",t.style.position="absolute",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.padding="0",t.style.zIndex="2001",t.innerHTML='\n<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17.6527 10.3496L19.7085 10.6856C19.8769 10.713 20.0003 10.8584 20 11.0289V12.9419C20 13.1106 19.8789 13.2553 19.7123 13.2845L17.6537 13.6459C17.5344 14.0584 17.3706 14.4557 17.1643 14.8313L18.3811 16.5207C18.4809 16.6591 18.4653 16.8494 18.3449 16.9701L16.9924 18.3235C16.8728 18.4428 16.6849 18.4598 16.5465 18.3621L14.8402 17.1652C14.4639 17.3746 14.0642 17.5416 13.6471 17.6643L13.2836 19.713C13.2544 19.879 13.11 20 12.9413 20H11.0281C10.858 20 10.7129 19.8772 10.6855 19.7099L10.3459 17.6713C9.92956 17.551 9.52778 17.385 9.14758 17.176L7.45352 18.3624C7.31542 18.4595 7.12723 18.4428 7.00791 18.3235L5.65545 16.9701C5.53544 16.8494 5.51978 16.6598 5.61858 16.5217L6.81555 14.8477C6.6044 14.4657 6.43673 14.0626 6.31533 13.6442L4.28698 13.2845C4.12105 13.255 4 13.1106 4 12.9419V11.0289C4 10.8591 4.12314 10.7137 4.29081 10.6859L6.31916 10.3482C6.44126 9.9287 6.60892 9.52557 6.81938 9.1447L5.63701 7.45322C5.53996 7.31513 5.55666 7.1273 5.67597 7.008L7.02809 5.656C7.1488 5.536 7.33768 5.52 7.47648 5.61913L9.15662 6.81913C9.53405 6.61252 9.93478 6.448 10.3522 6.328L10.6848 4.29183C10.7122 4.12348 10.8576 4 11.0281 4H12.9413C13.1104 4 13.2547 4.12174 13.2839 4.288L13.6426 6.3353C14.0576 6.456 14.4576 6.62226 14.8364 6.83165L16.5211 5.62087C16.6595 5.52104 16.8495 5.5367 16.9702 5.65704L18.323 7.00904C18.4423 7.1287 18.459 7.31687 18.3619 7.45496L17.1618 9.16522C17.3678 9.54052 17.5323 9.93704 17.6527 10.3496ZM9.56501 12C9.56501 13.3447 10.6552 14.4348 12 14.4348C13.3448 14.4348 14.435 13.3447 14.435 12C14.435 10.6553 13.3448 9.56522 12 9.56522C10.6552 9.56522 9.56501 10.6553 9.56501 12Z" fill="#000000"/>\n</svg>\n',t}setupEventListeners(){this.button.addEventListener("click",(()=>{if(!this.hasMoved){y("Settings button clicked!");new st(this.settingsStorage).show()}})),this.button.addEventListener("mousedown",this.handleMouseDown.bind(this)),document.addEventListener("mousemove",this.handleMouseMove.bind(this)),document.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.button.addEventListener("touchstart",this.handleTouchStart.bind(this)),document.addEventListener("touchmove",this.handleTouchMove.bind(this)),document.addEventListener("touchend",this.handleTouchEnd.bind(this))}handleMouseDown(t){this.isDragging=!0,this.hasMoved=!1,this.offsetX=t.clientX-this.button.getBoundingClientRect().left,this.offsetY=t.clientY-this.button.getBoundingClientRect().top,this.button.style.cursor="grabbing"}handleMouseMove(t){if(!this.isDragging)return;const e=t.clientX-this.offsetX,n=t.clientY-this.offsetY;this.setPosition(e,n),this.hasMoved=!0}handleMouseUp(){if(this.isDragging&&(this.isDragging=!1,this.button.style.cursor="pointer",this.hasMoved)){const t={top:parseInt(this.button.style.top),left:parseInt(this.button.style.left)};this.settingsStorage.save(this.STORAGE_KEY,t)}}handleTouchStart(t){t.preventDefault();const e=t.touches[0];this.isDragging=!0,this.hasMoved=!1,this.offsetX=e.clientX-this.button.getBoundingClientRect().left,this.offsetY=e.clientY-this.button.getBoundingClientRect().top}handleTouchMove(t){if(!this.isDragging)return;t.preventDefault();const e=t.touches[0],n=e.clientX-this.offsetX,i=e.clientY-this.offsetY;this.setPosition(n,i),this.hasMoved=!0}handleTouchEnd(t){if(this.isDragging&&(this.isDragging=!1,this.hasMoved)){const t={top:parseInt(this.button.style.top),left:parseInt(this.button.style.left)};this.settingsStorage.save(this.STORAGE_KEY,t)}}setPosition(t,e){this.button.style.left=`${t}px`,this.button.style.top=`${e}px`}}class ot{constructor(t="erepaSettings"){this.settings={},this.storageKey=t,this.loadFromLocalStorage()}loadFromLocalStorage(){try{const t=localStorage.getItem(this.storageKey);t&&(this.settings=JSON.parse(t))}catch(t){w("Failed to load settings from localStorage:",t),this.settings={}}}saveToLocalStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.settings))}catch(t){w("Failed to save settings to localStorage:",t)}}configFor(t){return this.settings[t]}save(t,e){this.hasConfig(t)?this.settings[t]={...this.settings[t],...e}:this.settings[t]=e,this.saveToLocalStorage()}hasConfig(t){return t in this.settings}exportToJson(){return JSON.stringify(this.settings,null,2)}importFromJson(t){try{const e=JSON.parse(t);return this.settings=e,this.saveToLocalStorage(),!0}catch(t){return w("Failed to import settings from JSON:",t),!1}}clear(){this.settings={},this.saveToLocalStorage()}}function rt(){const t=new ot;b.initialize(t,"[erepa]"),y("eRepublik Enhancer script loaded!"),Q.getInstance(t),function(t){try{const e=A();new at(t).render(e)}catch(t){w("Could not find erepa container",t)}}(t)}"complete"===document.readyState?rt():window.addEventListener("load",rt)})();